<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.97.3"><meta name=description content="CoreRuleSet Documentation"><meta name=author content="CoreRuleSet"><link rel=icon href=/documentation/images/favicon.png type=image/png><title>Extended Install :: Core Rule Set Documentation</title><link href=/documentation/css/nucleus.css?1696972032 rel=stylesheet><link href=/documentation/css/fontawesome-all.min.css?1696972032 rel=stylesheet><link href=/documentation/css/featherlight.min.css?1696972032 rel=stylesheet><link href=/documentation/css/perfect-scrollbar.min.css?1696972032 rel=stylesheet><link href=/documentation/css/auto-complete.css?1696972032 rel=stylesheet><link href=/documentation/css/theme.css?1696972032 rel=stylesheet><link href=/documentation/css/theme-blue.css?1696972032 rel=stylesheet><link href=/documentation/css/variant.css?1696972032 rel=stylesheet><link href=/documentation/css/print.css?1696972032 rel=stylesheet media=print><script src=/documentation/js/jquery.min.js?1696972032></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/documentation/deployment/install/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://coreruleset.github.io/documentation/><img src=https://coreruleset.github.io/documentation//images/logo.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/documentation/js/lunr.min.js?1696972032></script>
<script src=/documentation/js/auto-complete.js?1696972032></script>
<script>var index_url="/documentation/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script><script src=/documentation/js/search.js?1696972032></script></div><div id=homelinks><ul><li><a class=padding href=/documentation/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/documentation/deployment/ title="Getting CRS" class="dd-item parent"><a href=/documentation/deployment/><b>1. </b>Getting CRS<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/deployment/engine_integration_options/ title="Engine and Integration Options" class=dd-item><a href=/documentation/deployment/engine_integration_options/>Engine and Integration Options<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/quick_start/ title="Quick Start Guide" class=dd-item><a href=/documentation/deployment/quick_start/>Quick Start Guide<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/install/ title="Extended Install" class="dd-item active"><a href=/documentation/deployment/install/>Extended Install<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/concepts/ title="How CRS Works" class=dd-item><a href=/documentation/concepts/><b>2. </b>How CRS Works<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/concepts/anomaly_scoring/ title="Anomaly Scoring" class=dd-item><a href=/documentation/concepts/anomaly_scoring/>Anomaly Scoring<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/paranoia_levels/ title="Paranoia Levels" class=dd-item><a href=/documentation/concepts/paranoia_levels/>Paranoia Levels<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/false_positives_tuning/ title="False Positives and Tuning" class=dd-item><a href=/documentation/concepts/false_positives_tuning/>False Positives and Tuning<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/plugins/ title="Plugin Mechanism" class=dd-item><a href=/documentation/concepts/plugins/>Plugin Mechanism<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/sampling_mode/ title="Sampling Mode" class=dd-item><a href=/documentation/concepts/sampling_mode/>Sampling Mode<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/operation/ title=Operation class=dd-item><a href=/documentation/operation/><b>3. </b>Operation<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/operation/known_issues/ title="Known Issues" class=dd-item><a href=/documentation/operation/known_issues/>Known Issues<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/containers/ title="Using Containers" class=dd-item><a href=/documentation/operation/containers/>Using Containers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/kubernetes_ingress/ title="Kubernetes Ingress Controllers" class=dd-item><a href=/documentation/operation/kubernetes_ingress/>Kubernetes Ingress Controllers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/log_handling/ title="Log Handling" class=dd-item><a href=/documentation/operation/log_handling/>Log Handling<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/rules/ title=Rules class=dd-item><a href=/documentation/rules/><b>4. </b>Rules<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/rules/ruleid/ title="Rule IDs" class=dd-item><a href=/documentation/rules/ruleid/>Rule IDs<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/rules/ title=Rules class=dd-item><a href=/documentation/rules/rules/>Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/creating/ title=Making class=dd-item><a href=/documentation/rules/creating/>Making<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/metadata/ title=Metadata class=dd-item><a href=/documentation/rules/metadata/>Metadata<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/development/ title=Development class=dd-item><a href=/documentation/development/><b>5. </b>Development<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/development/contribution_guidelines/ title="Contribution Guidelines" class=dd-item><a href=/documentation/development/contribution_guidelines/>Contribution Guidelines<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/crs_toolchain/ title=crs-toolchain class=dd-item><a href=/documentation/development/crs_toolchain/>crs-toolchain<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/regex_assembly/ title="Assembling Regular Expressions" class=dd-item><a href=/documentation/development/regex_assembly/>Assembling Regular Expressions<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/rule_writing/ title="Writing Rules" class=dd-item><a href=/documentation/development/rule_writing/>Writing Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/useful_tools/ title="Useful Tools" class=dd-item><a href=/documentation/development/useful_tools/>Useful Tools<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/testing/ title="Testing the Rule Set" class=dd-item><a href=/documentation/development/testing/>Testing the Rule Set<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/plugin_writing/ title="Writing Plugins" class=dd-item><a href=/documentation/development/plugin_writing/>Writing Plugins<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/sandbox/ title="Using the CRS Sandbox" class=dd-item><a href=/documentation/development/sandbox/>Using the CRS Sandbox<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/resources/ title="Additional Resources" class=dd-item><a href=/documentation/resources/><b>6. </b>Additional Resources<i class="fas fa-check read-icon"></i></a><ul></ul></li><li data-nav-id=/documentation/miscellaneous/ title=Miscellaneous class=dd-item><a href=/documentation/miscellaneous/><b>7. </b>Miscellaneous<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/miscellaneous/self_contained_mode/ title="Self-Contained Mode" class=dd-item><a href=/documentation/miscellaneous/self_contained_mode/>Self-Contained Mode<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://coreruleset.org/><i class="fas fa-bookmark"></i> Core Rule Set Home</a></li><li><a class=padding href=https://github.com/coreruleset/coreruleset><i class="fab fa-github"></i> Core Rule Set GitHub</a></li></ul></div><div id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/coreruleset/documentation/blob/main/content/deployment/install.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Extended Install</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#contact-us>Contact Us</a></li><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#installing-a-compatible-waf-engine>Installing a Compatible WAF Engine</a><ul><li><a href=#option-1-installing-pre-packaged-modsecurity>Option 1: Installing Pre-Packaged ModSecurity</a></li><li><a href=#option-2-compiling-modsecurity-from-source>Option 2: Compiling ModSecurity From Source</a></li></ul></li><li><a href=#downloading-the-owasp-core-rule-set>Downloading the OWASP Core Rule Set</a><ul><li><a href=#verifying-releases>Verifying Releases</a></li></ul></li><li><a href=#setting-up-owasp-crs>Setting Up OWASP CRS</a></li><li><a href=#proceeding-with-the-installation>Proceeding with the Installation</a><ul><li><a href=#includes-for-apache>Includes for Apache</a></li><li><a href=#includes-for-nginx>Includes for Nginx</a></li></ul></li></ul></nav></div></div></div><div id=head-tags></div><main id=body-inner><h1>Extended Install</h1><blockquote><p>All the information needed to properly install CRS is presented on this page. The installation concepts are expanded upon and presented in more detail than the <a href=/documentation/deployment/quick_start/>quick start guide</a>.</p></blockquote><h2 id=contact-us>Contact Us</h2><p>To contact the CRS project with questions or problems, reach out via the project&rsquo;s <a href=https://groups.google.com/a/owasp.org/forum/#!forum/modsecurity-core-rule-set-project>Google group</a> or <a href=https://owasp.slack.com/archives/CBKGH8A5P>Slack channel</a> (for Slack channel access, <a href=https://owasp.org/slack/invite>use this link</a> to get an invite).</p><h2 id=prerequisites>Prerequisites</h2><p>Installing the CRS isn&rsquo;t very difficult but does have one major requirement: <em>a compatible engine</em>. The reference engine used throughout this page is ModSecurity.</p><div class="notices note"><div class=label>Note</div><p>In order to successfully run CRS <code>3.x</code> using ModSecurity it is recommended to use the latest version available. For Nginx use the <code>3.x</code> branch of ModSecurity, and for Apache use the latest <code>2.x</code> branch.</p></div><h2 id=installing-a-compatible-waf-engine>Installing a Compatible WAF Engine</h2><p>Two different methods to get an engine up and running are presented here:</p><ul><li>using the chosen engine as provided and packaged by the OS distribution</li><li>compiling the chosen engine from source</li></ul><p>A ModSecurity installation is presented in the examples below, however the install documentation for the Coraza engine can be found <a href=https://www.coraza.io>here</a>.</p><h3 id=option-1-installing-pre-packaged-modsecurity>Option 1: Installing Pre-Packaged ModSecurity</h3><p>ModSecurity is frequently pre-packaged and is available from several major Linux distributions.</p><ul><li><strong>Debian:</strong> Friends of the CRS project <a href=https://modsecurity.digitalwave.hu>DigitalWave</a> package and, most importantly, <strong>keep ModSecurity updated</strong> for Debian and derivatives.</li><li><strong>Fedora:</strong> Execute <code>dnf install mod_security</code> for Apache + ModSecurity v2.</li><li><strong>RHEL compatible:</strong> Install EPEL and then execute <code>yum install mod_security</code>.</li></ul><p>For Windows, get the latest MSI package from <a href=https://github.com/SpiderLabs/ModSecurity/releases>https://github.com/SpiderLabs/ModSecurity/releases</a>.</p><div class="notices warning"><div class=label>Warning</div><p><strong>Distributions might not update their ModSecurity releases frequently.</strong></p><p>As a result, it is quite likely that a distribution&rsquo;s version of ModSecurity may be missing important features or <strong>may even contain security vulnerabilities</strong>. Additionally, depending on the package and package manager used, the ModSecurity configuration will be laid out slightly differently.</p></div><p>As the different engines and distributions have different layouts for their configuration, to simplify the documentation presented here the prefix <code>&lt;web server config>/</code> will be used from this point on.</p><p>Examples of <code>&lt;web server config>/</code> include:</p><ul><li><code>/etc/apache2</code> in Debian and derivatives</li><li><code>/etc/httpd</code> in RHEL and derivatives</li><li><code>/usr/local/apache2</code> if Apache was compiled from source using the default prefix</li><li><code>C:\Program Files\ModSecurity IIS\</code> (or Program Files(x86), depending on configuration) on Windows</li><li><code>/etc/nginx</code></li></ul><h3 id=option-2-compiling-modsecurity-from-source>Option 2: Compiling ModSecurity From Source</h3><p>Compiling ModSecurity is easy, but slightly outside the scope of this document. For information on how to compile ModSecurity, refer to:</p><ul><li>the official <a href=https://github.com/SpiderLabs/ModSecurity/wiki>ModSecurity documentation</a> on GitHub</li><li>the compilation recipes for ModSecurity v3 on the <a href=https://github.com/SpiderLabs/ModSecurity/wiki/Compilation-recipes-for-v3.x>ModSecurity wiki</a></li><li>the netnea tutorials for <a href=https://www.netnea.com/cms/apache-tutorial-6_embedding-modsecurity/>Apache</a> or <a href=https://www.netnea.com/cms/nginx-tutorial-6_embedding-modsecurity/>Nginx</a></li></ul><div class="notices warning"><div class=label>Unsupported Configurations</div><p>Note that the following configurations are <strong>not</strong> supported. They do <strong>not</strong> work as expected. The CRS project recommendation is to <em>avoid these setups</em>:</p><ul><li>Nginx with ModSecurity v2</li><li>Apache with ModSecurity v3</li></ul></div><h4 id=testing-the-compiled-module>Testing the Compiled Module</h4><p>Once ModSecurity has been compiled, there is a simple test to see if the installation is working as expected. After compiling from source, use the appropriate directive to <strong>load the newly compiled module</strong> into the web server. For example:</p><ul><li><strong>Apache:</strong> <code>LoadModule security2_module modules/mod_security2.so</code></li><li><strong>Nginx:</strong> <code>load_module modules/ngx_http_modsecurity_module.so;</code></li></ul><p>Now restart the web server. ModSecurity should output that it&rsquo;s being used.</p><p>Nginx should show something like:</p><pre tabindex=0><code>2022/04/21 23:45:52 [notice] 1#1: ModSecurity-nginx v1.0.2 (rules loaded inline/local/remote: 0/6/0)
</code></pre><p>Apache should show something like:</p><pre tabindex=0><code>[Thu Apr 21 23:55:35.142945 2022] [:notice] [pid 2528:tid 140410548673600] ModSecurity for Apache/2.9.3 (http://www.modsecurity.org/) configured.
[Thu Apr 21 23:55:35.142980 2022] [:notice] [pid 2528:tid 140410548673600] ModSecurity: APR compiled version=&#34;1.6.5&#34;; loaded version=&#34;1.6.5&#34;
[Thu Apr 21 23:55:35.142985 2022] [:notice] [pid 2528:tid 140410548673600] ModSecurity: PCRE compiled version=&#34;8.39 &#34;; loaded version=&#34;8.39 2016-06-14&#34;
[Thu Apr 21 23:55:35.142988 2022] [:notice] [pid 2528:tid 140410548673600] ModSecurity: LUA compiled version=&#34;Lua 5.1&#34;
[Thu Apr 21 23:55:35.142991 2022] [:notice] [pid 2528:tid 140410548673600] ModSecurity: YAJL compiled version=&#34;2.1.0&#34;
[Thu Apr 21 23:55:35.142994 2022] [:notice] [pid 2528:tid 140410548673600] ModSecurity: LIBXML compiled version=&#34;2.9.4&#34;
[Thu Apr 21 23:55:35.142997 2022] [:notice] [pid 2528:tid 140410548673600] ModSecurity: Status engine is currently disabled, enable it by set SecStatusEngine to On.
[Thu Apr 21 23:55:35.187082 2022] [mpm_event:notice] [pid 2530:tid 140410548673600] AH00489: Apache/2.4.41 (Ubuntu) configured -- resuming normal operations
[Thu Apr 21 23:55:35.187125 2022] [core:notice] [pid 2530:tid 140410548673600] AH00094: Command line: &#39;/usr/sbin/apache2&#39;
</code></pre><h5 id=microsoft-iis-with-modsecurity-2x>Microsoft IIS with ModSecurity 2.x</h5><p>The initial configuration file is <code>modsecurity_iis.conf</code>. This file will be parsed by ModSecurity for both ModSecurity directives and <code>'Include'</code> directives.</p><p>Additionally, in the Event Viewer, under <code>Windows Logs\Application</code>, it should be possible to see a new log entry showing ModSecurity being successfully loaded.</p><p>At this stage, the ModSecurity on IIS setup is working and new directives can be placed in the configuration file as needed.</p><h2 id=downloading-the-owasp-core-rule-set>Downloading the OWASP Core Rule Set</h2><p>With a compatible WAF engine installed and working, the next step is typically to download and install the OWASP CRS. The CRS project strongly recommends using a <a href=https://github.com/coreruleset/coreruleset/security/policy>supported version</a>.</p><p>Official CRS releases can be found at the following URL: <a href=https://github.com/coreruleset/coreruleset/releases>https://github.com/coreruleset/coreruleset/releases</a>.</p><p>For <em>production</em> environments, it is recommended to use the latest release, which is v3.3.4. For <em>testing</em> the bleeding edge CRS version, nightly releases are also provided.</p><h3 id=verifying-releases>Verifying Releases</h3><div class="notices note"><div class=label>Note</div><p>Releases are signed using the CRS project&rsquo;s <a href=https://coreruleset.org/security.asc>GPG key</a> (fingerprint: 3600 6F0E 0BA1 6783 2158 8211 38EE ACA1 AB8A 6E72). Releases can be verified using GPG/PGP compatible tooling.</p><p>To retrieve the CRS project&rsquo;s public key from public key servers using <code>gpg</code>, execute: <code>gpg --keyserver pgp.mit.edu --recv 0x38EEACA1AB8A6E72</code> (this ID should be equal to the last sixteen hex characters in the fingerprint).</p><p>It is also possible to use <code>gpg --fetch-key https://coreruleset.org/security.asc</code> to retrieve the key directly.</p></div><p>The following steps assume that a *nix operating system is being used. Installation is similar on Windows but likely involves using a zip file from the CRS <a href=https://github.com/coreruleset/coreruleset/releases>releases page</a>.</p><p>To download the release file and the corresponding signature:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://github.com/coreruleset/coreruleset/archive/refs/tags/v3.3.4.tar.gz
</span></span><span style=display:flex><span>wget https://github.com/coreruleset/coreruleset/releases/download/v3.3.4/coreruleset-3.3.4.tar.gz.asc
</span></span></code></pre></div><p>To verify the integrity of the release:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gpg --verify coreruleset-3.3.4.tar.gz.asc v3.3.4.tar.gz
</span></span><span style=display:flex><span>gpg: Signature made Wed Jun <span style=color:#ae81ff>30</span> 10:05:48 <span style=color:#ae81ff>2021</span> -03
</span></span><span style=display:flex><span>gpg:                using RSA key 36006F0E0BA167832158821138EEACA1AB8A6E72
</span></span><span style=display:flex><span>gpg: Good signature from <span style=color:#e6db74>&#34;OWASP Core Rule Set &lt;security@coreruleset.org&gt;&#34;</span> <span style=color:#f92672>[</span>unknown<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>gpg: WARNING: This key is not certified with a trusted signature!
</span></span><span style=display:flex><span>gpg:          There is no indication that the signature belongs to the owner.
</span></span><span style=display:flex><span>Primary key fingerprint: <span style=color:#ae81ff>3600</span> 6F0E 0BA1 <span style=color:#ae81ff>6783</span> <span style=color:#ae81ff>2158</span>  <span style=color:#ae81ff>8211</span> 38EE ACA1 AB8A 6E72
</span></span></code></pre></div><p>If the signature was good then the verification succeeds. If a warning is displayed, like the above, it means the CRS project&rsquo;s public key is <em>known</em> but is not <em>trusted</em>.</p><p>To trust the CRS project&rsquo;s public key:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gpg edit-key 36006F0E0BA167832158821138EEACA1AB8A6E72
</span></span><span style=display:flex><span>gpg&gt; trust
</span></span><span style=display:flex><span>Your decision: <span style=color:#ae81ff>5</span> <span style=color:#f92672>(</span>ultimate trust<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Are you sure: Yes
</span></span><span style=display:flex><span>gpg&gt; quit
</span></span></code></pre></div><p>The result when verifying a release will then look like so:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gpg --verify coreruleset-3.3.2.tar.gz.asc v3.3.2.tar.gz
</span></span><span style=display:flex><span>gpg: Signature made Wed Jun <span style=color:#ae81ff>30</span> 15:05:48 <span style=color:#ae81ff>2021</span> CEST
</span></span><span style=display:flex><span>gpg:                using RSA key 36006F0E0BA167832158821138EEACA1AB8A6E72
</span></span><span style=display:flex><span>gpg: Good signature from <span style=color:#e6db74>&#34;OWASP Core Rule Set &lt;security@coreruleset.org&gt;&#34;</span> <span style=color:#f92672>[</span>ultimate<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>With the CRS release downloaded and verified, the rest of the set up can continue.</p><h2 id=setting-up-owasp-crs>Setting Up OWASP CRS</h2><p>OWASP CRS contains a setup file that should be reviewed prior to completing set up. The setup file is the only configuration file within the root &lsquo;coreruleset-3.3.4&rsquo; folder and is named <code>crs-setup.conf.example</code>. Examining this configuration file and reading what the different options are is <strong>highly</strong> recommended.</p><p>At a minimum, keep in mind the following:</p><ul><li>CRS does not configure features such as the rule engine, audit engine, logging, etc. This task is part of the initial <em>engine</em> setup and is not a job for the rule set. For ModSecurity, if not already done, see the <a href=https://github.com/SpiderLabs/ModSecurity/blob/master/modsecurity.conf-recommended>recommended configuration</a>.</li><li>Decide what ModSecurity should do when it detects malicious activity, e.g., drop the packet, return a <em>403 Forbidden</em> status code, issue a redirect to a custom page, etc.</li><li>Make sure to configure the anomaly scoring thresholds. For more information see <a href=/documentation/concepts/anomaly_scoring/ title=Anomaly>Anomaly</a>.</li><li>By default, the CRS rules will consider many issues with different databases and languages. If running in a specific environment, e.g., without any SQL database services present, it is probably a good idea to limit this behavior for performance reasons.</li><li>Make sure to add any HTTP methods, static resources, content types, or file extensions that are needed, beyond the default ones listed.</li></ul><p>Once reviewed and configured, the CRS configuration file should be renamed by changing the file suffix from <code>.example</code> to <code>.conf</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mv crs-setup.conf.example crs-setup.conf
</span></span></code></pre></div><p>In addition to <code>crs-setup.conf.example</code>, there are two other &ldquo;.example&rdquo; files within the CRS repository. These are:</p><ul><li><code>rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example</code></li><li><code>rules/RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example</code></li></ul><p>These files are designed to provide the rule maintainer with the ability to modify rules (see <a href=/documentation/concepts/false_positives_tuning/#rule-exclusions>false positives and tuning</a>) without breaking forward compatibility with rule set updates. These two files should be renamed by removing the <code>.example</code> suffix. This will mean that installing updates will <em>not</em> overwrite custom rule exclusions. To rename the files in Linux, use a command similar to the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mv rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf
</span></span><span style=display:flex><span>mv rules/RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example rules/RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf
</span></span></code></pre></div><h2 id=proceeding-with-the-installation>Proceeding with the Installation</h2><p>The engine should support the <code>Include</code> directive out of the box. This directive tells the engine to parse <em>additional</em> files for directives. The question is where to put the CRS rules folder in order for it to be included.</p><p>Looking at the CRS files, there are quite a few &ldquo;.conf&rdquo; files. While the names attempt to do a good job at describing what each file does, additional information is available in the <a href=/documentation/rules/>rules</a> section.</p><h3 id=includes-for-apache>Includes for Apache</h3><p>It is recommended to create a folder specifically to contain the CRS rules. In the example presented here, a folder named <code>modsecurity.d</code> has been created and placed within the root <code>&lt;web server config>/</code> directory. When using Apache, wildcard notation can be used to vastly simplify the <code>Include</code> rules. Simply copying the cloned directory into the <code>modsecurity.d</code> folder and specifying the appropriate <code>Include</code> directives will install OWASP CRS. In the example below, the <code>modsecurity.conf</code> file has also been included, which includes recommended configurations for ModSecurity.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-apache data-lang=apache><span style=display:flex><span><span style=color:#f92672>&lt;IfModule</span> <span style=color:#e6db74>security2_module</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>        Include modsecurity.d/modsecurity.conf
</span></span><span style=display:flex><span>        Include modsecurity.d/coreruleset-3.3.4/crs-setup.conf
</span></span><span style=display:flex><span>        Include modsecurity.d/coreruleset-3.3.4/rules/*.conf
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/IfModule&gt;</span>
</span></span></code></pre></div><h3 id=includes-for-nginx>Includes for Nginx</h3><p>Nginx will include files from the Nginx configuration directory (<code>/etc/nginx</code> or <code>/usr/local/nginx/conf/</code>, depending on the environment). Because only one <code>ModSecurityConfig</code> directive can be specified within <code>nginx.conf</code>, it is recommended to name that file <code>modsec_includes.conf</code> and include additional files from there. In the example below, the cloned <code>owasp-modsecurity-crs</code> folder was copied into the Nginx configuration directory. From there, the appropriate include directives are specified which will include OWASP CRS when the server is restarted. In the example below, the <code>modsecurity.conf</code> file has also been included, which includes recommended configurations for ModSecurity.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>include</span> modsecurity.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/crs-setup.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-901-INITIALIZATION.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-903.9001-DRUPAL-EXCLUSION-RULES.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-903.9002-WORDPRESS-EXCLUSION-RULES.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-903.9003-NEXTCLOUD-EXCLUSION-RULES.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-903.9004-DOKUWIKI-EXCLUSION-RULES.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-903.9005-CPANEL-EXCLUSION-RULES.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-903.9006-XENFORO-EXCLUSION-RULES.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-905-COMMON-EXCEPTIONS.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-910-IP-REPUTATION.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-911-METHOD-ENFORCEMENT.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-912-DOS-PROTECTION.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-913-SCANNER-DETECTION.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-921-PROTOCOL-ATTACK.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-930-APPLICATION-ATTACK-LFI.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-931-APPLICATION-ATTACK-RFI.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-933-APPLICATION-ATTACK-PHP.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-934-APPLICATION-ATTACK-NODEJS.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-941-APPLICATION-ATTACK-XSS.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-944-APPLICATION-ATTACK-JAVA.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/REQUEST-949-BLOCKING-EVALUATION.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/RESPONSE-950-DATA-LEAKAGES.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/RESPONSE-951-DATA-LEAKAGES-SQL.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/RESPONSE-952-DATA-LEAKAGES-JAVA.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/RESPONSE-953-DATA-LEAKAGES-PHP.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/RESPONSE-954-DATA-LEAKAGES-IIS.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/RESPONSE-959-BLOCKING-EVALUATION.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/RESPONSE-980-CORRELATION.conf
</span></span><span style=display:flex><span><span style=color:#66d9ef>include</span> coreruleset-3.3.2/rules/RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf
</span></span></code></pre></div><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/documentation/deployment/quick_start/ title="Quick Start Guide"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/documentation/concepts/ title="How CRS Works"><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/documentation/js/clipboard.min.js?1696972032></script>
<script src=/documentation/js/perfect-scrollbar.min.js?1696972032></script>
<script src=/documentation/js/perfect-scrollbar.jquery.min.js?1696972032></script>
<script src=/documentation/js/jquery.svg.pan.zoom.js?1696972032></script>
<script src=/documentation/js/featherlight.min.js?1696972032></script>
<script src=/documentation/js/modernizr.custom-3.6.0.js?1696972032></script>
<script src=/documentation/js/mermaid.min.js?1696972032></script>
<script>typeof mermaid!="undefined"&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script><script src=/documentation/js/relearn.js?1696972032></script>
<script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="https://piwik.netnea.com/matomo/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","4"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><img referrerpolicy=no-referrer-when-downgrade src="https://piwik.netnea.com/matomo/matomo.php?idsite=4&rec=1" style=border:0 alt></body></html>