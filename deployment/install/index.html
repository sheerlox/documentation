<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.85.0"><meta name=description content="CoreRuleSet Documentation"><meta name=author content="CoreRuleSet"><link rel=icon href=/documentation/images/favicon.png type=image/png><title>Installing CoreRuleSet :: Core Rule Set Documentation</title><link href=/documentation/css/nucleus.css?1636993062 rel=stylesheet><link href=/documentation/css/fontawesome-all.min.css?1636993062 rel=stylesheet><link href=/documentation/css/featherlight.min.css?1636993062 rel=stylesheet><link href=/documentation/css/perfect-scrollbar.min.css?1636993062 rel=stylesheet><link href=/documentation/css/auto-complete.css?1636993062 rel=stylesheet><link href=/documentation/css/theme.css?1636993062 rel=stylesheet><link href=/documentation/css/theme-blue.css?1636993062 rel=stylesheet><link href=/documentation/css/variant.css?1636993062 rel=stylesheet><link href=/documentation/css/print.css?1636993062 rel=stylesheet media=print><script src=/documentation/js/jquery.min.js?1636993062></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/documentation/deployment/install/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://coreruleset.github.io/documentation/><img src=https://coreruleset.github.io/documentation//images/logo.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/documentation/js/lunr.min.js?1636993062></script><script src=/documentation/js/auto-complete.js?1636993062></script><script>var index_url="/documentation/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script><script src=/documentation/js/search.js?1636993062></script></div><div id=homelinks><ul><li><a class=padding href=/documentation/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/documentation/deployment/ title="Getting CRS" class="dd-item parent"><a href=/documentation/deployment/><b>1. </b>Getting CRS<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/deployment/engine_integration_options/ title="Engine and Integration Options" class=dd-item><a href=/documentation/deployment/engine_integration_options/>Engine and Integration Options<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/quickstart/ title="OWASP CRS Quickstart" class=dd-item><a href=/documentation/deployment/quickstart/>Quickstart<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/install/ title="Installing CoreRuleSet" class="dd-item active"><a href=/documentation/deployment/install/>Extended Install<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/configuring/ title="How it Works" class=dd-item><a href=/documentation/configuring/><b>2. </b>How it Works<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/configuring/anomaly/ title="Anomaly Scoring Mode" class=dd-item><a href=/documentation/configuring/anomaly/>Anomaly Scoring<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/paranoia_levels/ title="Paranoia Levels" class=dd-item><a href=/documentation/configuring/paranoia_levels/>Paranoia Levels<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/plugins/ title=Plugins class=dd-item><a href=/documentation/configuring/plugins/>Plugins<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/crs/ title=Configuration class=dd-item><a href=/documentation/configuring/crs/>Configuration<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/exceptions/ title="Adding Exceptions and Tuning CRS" class=dd-item><a href=/documentation/configuring/exceptions/>Exceptions<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/operation/ title=Operation class=dd-item><a href=/documentation/operation/>Operation<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/operation/containers/ title="Using Containers" class=dd-item><a href=/documentation/operation/containers/>Using Containers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/log_handling/ title="Log Handling" class=dd-item><a href=/documentation/operation/log_handling/>Log Handling<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/rules/ title="Creating Rules" class=dd-item><a href=/documentation/rules/><b>3. </b>Rules<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/rules/ruleid/ title="Rule IDs" class=dd-item><a href=/documentation/rules/ruleid/><b>1. </b>Rule IDs<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/testing/ title="Testing the Rule Set" class=dd-item><a href=/documentation/rules/testing/><b>2. </b>Testing<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/rules/ title=Rules class=dd-item><a href=/documentation/rules/rules/><b>3. </b>Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/creating/ title=Making class=dd-item><a href=/documentation/rules/creating/><b>9. </b>Making<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/metadata/ title=Metadata class=dd-item><a href=/documentation/rules/metadata/><b>10. </b>Metadata<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/development/ title=Development class=dd-item><a href=/documentation/development/><b>4. </b>Development<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/development/rule_writing/ title="Writing CRS Rules" class=dd-item><a href=/documentation/development/rule_writing/>Writing CRS Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/plugin_writing/ title="Writing Plugins" class=dd-item><a href=/documentation/development/plugin_writing/>Writing Plugins<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/sandbox/ title="Using the CRS Sandbox" class=dd-item><a href=/documentation/development/sandbox/>Using the CRS Sandbox<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/resources/ title="Additional Resources" class=dd-item><a href=/documentation/resources/>Additional Resources<i class="fas fa-check read-icon"></i></a><ul></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://coreruleset.org/><i class="fas fa-bookmark"></i> Core Rule Set Home</a></li><li><a class=padding href=https://github.com/coreruleset/coreruleset><i class="fab fa-github"></i> Core Rule Set GitHub</a></li></ul></div><div id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/coreruleset/documentation/blob/main/content/deployment/install.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Installing CoreRuleSet</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#finding-where-to-edit-in-your-configuration>Finding where to edit in your configuration</a><ul><li><a href=#apache-2x-with-modsecurity-2x-compiled>Apache 2.x with ModSecurity 2.x Compiled</a></li><li><a href=#apache-2x-with-modsecurity-2x-packaged-rhel>Apache 2.x with ModSecurity 2.x Packaged (RHEL)</a></li><li><a href=#nginx-with-modsecurity-2x-compiled>Nginx with ModSecurity 2.x Compiled</a></li><li><a href=#nginx-with-modsecurity-3x-libmodsecurity-compiled>Nginx with ModSecurity 3.x (libmodsecurity) Compiled</a></li><li><a href=#microsoft-iis-with-modsecurity-2x>Microsoft IIS with ModSecurity 2.x</a></li></ul></li><li><a href=#downloading-owasp-crs>Downloading OWASP CRS</a><ul><li><a href=#setup-owasp-crs>Setup OWASP CRS</a></li></ul></li><li><a href=#proceeding-with-the-install>Proceeding with the Install</a><ul><li><a href=#includes-for-apache>Includes for Apache</a></li><li><a href=#includes-for-nginx>Includes for Nginx</a></li></ul></li><li><a href=#setting-up-automated-updated>Setting up automated updated</a><ul><li><a href=#an-update-script>An update script</a></li></ul></li><li><a href=#problems-with-installation>Problems with installation</a><ul><li><a href=#apache-line-continuation>Apache Line Continuation</a></li><li><a href=#anomaly-mode-doesnt-work>Anomaly Mode Doesn&rsquo;t Work</a></li><li><a href=#webserver-returns-error-after-crs-install>Webserver returns error after CRS install</a></li></ul></li></ul></nav></div></div></div><div id=head-tags></div><main id=body-inner><h1>Installing CoreRuleSet</h1><p>If you need mode information than the one in the <a href=/documentation/deployment/quickstart/>quickstart guide</a>, here we extend with additional details so keep reading.</p><p>Below you should find all the information you need to properly install
CRS. If you are having problems feel free to reach out to our <a href=https://groups.google.com/a/owasp.org/forum/#!forum/modsecurity-core-rule-set-project>Google Group</a>, or our <a href=https://owasp.slack.com/archives/CBKGH8A5P>Slack Channel</a>. If you don&rsquo;t have access yet, <a href=https://owasp.org/slack/invite>get your invite here</a>.</p><h2 id=prerequisites>Prerequisites</h2><p>Installing the CRS isn&rsquo;t very hard but it does have one major requirement, ModSecurity. If ModSecurity isn&rsquo;t working properly you will likely run into problems running the CRS.</p><div class="notices warning"><div class=label>Warning</div><p>In order to run the CRS <code>3.x</code> branch you require AT MINIMUM ModSecurity 2.8 or above, preferably version <code>3.x</code> or above.</p></div><h2 id=finding-where-to-edit-in-your-configuration>Finding where to edit in your configuration</h2><p>ModSecurity comes in MANY different version with support for a multitude
of Operating Systems (OS) and Web Servers. The installation locations
may differ greatly between these different options so please be aware
that the following are just some of the more common configurations.</p><h3 id=apache-2x-with-modsecurity-2x-compiled>Apache 2.x with ModSecurity 2.x Compiled</h3><p>Compiling ModSecurity is easy, but slightly outside the scope of this
document. If you are interested in learning how to compile ModSecurity
please go to the ModSecurity documentation. Having compiled ModSecurity
there is a simple test to see if your installation is working. If you
have compiled from source you would have needed to include <code>LoadModule security2_module modules/mod_security2.so</code> either in <code>httpd.conf</code> (<code>apache2.conf</code> on Debian) or in some file included from this file.
Anywhere after you load your module you may add the following
ModSecurity directives.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-apache data-lang=apache>SecRuleEngine <span style=color:#66d9ef>On</span>
SecRule ARGS:testparam <span style=color:#e6db74>&#34;@contains test&#34;</span> <span style=color:#e6db74>&#34;id:1234,deny,status:403,msg:&#39;Our test rule has triggered&#39;&#34;</span>
</code></pre></div><p>If you restart Apache you may now navigate to any page on your web
server passing the parameter <code>'testparam'</code> with the value <code>'test'</code> (via
post or get) and you should receive a 403. This request will typically
appear similar to as follows: <code>http://localhost/?testparam=test</code>.</p><p>If you obtained a 403 status code your ModSecurity instance is
functioning correctly with Apache and you now know where to place
directives.</p><h3 id=apache-2x-with-modsecurity-2x-packaged-rhel>Apache 2.x with ModSecurity 2.x Packaged (RHEL)</h3><p>Many operating systems provide package managers in order to aid in the
install of software packages and their associated dependencies. Even
though ModSecurity is relatively straight forward to install, some
people prefer using package managers due to their ease. It should be
noted here that many package managers do not up date their releases very
frequently, as a result it is quite likely that your distribution may be
missing required features or possibly even have security
vulnerabilities. Additionally, depending on your package/package manager
your ModSecurity configuration will be laid out slightly different.</p><p>On Fedora we will find that when you use <code>dnf install mod_security</code>
you will receive the base ModSecurity package. Apache&rsquo;s configuration
files are split out within this environment such that there are
different folders for the base config (<code>/etc/httpd/config</code>), user
configuration (<code>/etc/httpd/conf.d</code>, and module configuration
(<code>/etc/httpd/conf.modules.d/</code>). The Fedora ModSecurity 2.x package places
the LoadModule and associated &lsquo;Include&rsquo;s within
<code>/etc/httpd/conf.modules.d/10-mod_security.conf</code>. Additionally, it places
some of the reccomended default rules in
<code>/etc/httpd/conf.d/mod_security.conf</code>. It is this secondary configuration
file that will setup the locations where you should add your rules. By
default it reads in all config files from the <code>/etc/httpd/modsecurity.d/</code>
and <code>/etc/httpd/modsecurity.d/activated_rules/</code> folder. To keep order I
would reccomend testing this configuration by placing a <code>rules.conf</code> file
within the <code>activated_rules</code> folder. Within this <code>rules.conf</code> file add the
following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>SecRuleEngine On
SecRule ARGS:testparam <span style=color:#e6db74>&#34;@contains test&#34;</span> <span style=color:#e6db74>&#34;id:1234,deny,status:403,msg:&#39;Our test rule has triggered&#39;&#34;</span>
</code></pre></div><p>Upon saving and restarting Apache (<code>systemctl restart httpd.service</code>) you
should be able to navigate to a your local webserver. Once this is
accomplished try passing the &lsquo;testparam&rsquo; paramater with the value
&lsquo;test&rsquo; such as via the following
URL: <code>http://localhost/?testparam=test</code>. You should receive a 403
Forbidden status. If you do congratulations, ModSecurity is ready for
the OWASP CRS rules.</p><h3 id=nginx-with-modsecurity-2x-compiled>Nginx with ModSecurity 2.x Compiled</h3><p>ModSecurity 2.x currently doesn&rsquo;t support the new Nginx loadable
modules. As a result, it is required that you compile Nginx from source
with ModSecurity. For more information on how to do this see the
ModSecurity documentaiton. Once ModSecurity is compiled in you will have
to specify both &lsquo;ModSecurityEnabled&rsquo; and &lsquo;ModSecurityConfig&rsquo; within
any location block where you want ModSecurity enabled. An example would
look similar to below.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=color:#66d9ef>location</span> <span style=color:#e6db74>/</span> {
    <span style=color:#f92672>ModSecurityEnabled</span> <span style=color:#66d9ef>on</span>;
    <span style=color:#f92672>ModSecurityConfig</span> <span style=color:#e6db74>modsec_includes.conf</span>;
}
</code></pre></div><p>Within this <code>modsec_includes.conf</code> you may use the <code>Include</code> directive to
include other files or any ModSecurity directives. For our testing
purpose we will add the following to our <code>modsec_includes.conf</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Apache data-lang=Apache>SecRuleEngine <span style=color:#66d9ef>On</span>
SecRule ARGS:testparam <span style=color:#e6db74>&#34;@contains test&#34;</span> <span style=color:#e6db74>&#34;id:1234,deny,status:403,msg:&#39;Our test rule has triggered&#39;&#34;</span>
</code></pre></div><p>Upon saving and restarting Nginx (<code>./nginx -s reload</code>) you should be able
to navigate to a your local webserver. Once this is accomplished try
passing the &lsquo;testparam&rsquo; paramater with the value &lsquo;test&rsquo; such as via
the following URL: <code>http://localhost/?testparam=test</code>. You should receive
a 403 Forbidden status. If you do congratulations, ModSecurity is ready
for the OWASP CRS rules ðŸš€.</p><h3 id=nginx-with-modsecurity-3x-libmodsecurity-compiled>Nginx with ModSecurity 3.x (libmodsecurity) Compiled</h3><h3 id=microsoft-iis-with-modsecurity-2x>Microsoft IIS with ModSecurity 2.x</h3><p>The most common deployment of ModSecurity for IIS is via the
pre-packaged MSI installer, available at <a href=https://www.modsecurity.org/download.html>https://www.modsecurity.org/download.html</a>. If you compiled or are looking to compile ModSecurity for IIS this documentation isn&rsquo;t for
you.</p><p>If you used this package to install ModSecurity 2.x on IIS (tested
on IIS 7-10), than your configuration files are located within<code>C:\Program Files\ModSecurity IIS\</code> (or Program Files(x86) depending on your configuration). The inital configuration file, that is the one that the remainder are included from, is <code>modsecurity_iis.conf</code>. This file will be parsed by the ModSecurity for both ModSecurity and <code>'Include'</code> directives.</p><p>By default all installations of ModSecurity without <a href=https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-(v2.x)#SecRuleEngine>SecRuleEngine</a> declared will start in DetectionOnly mode. IIS, by default, explicitly declares <a href=https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-(v2.x)#SecRuleEngine>SecRuleEngine</a> to be DetectionOnly within the included modsecurity.conf file. As a result any rule we make will only show up in the Windows Event Viewer by default. For our example we&rsquo;re going to turn on disruptive actions. To test we should add the following to the end of our <code>modsecurity_iis.conf</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-apache data-lang=apache>SecRuleEngine <span style=color:#66d9ef>On</span>
SecRule ARGS:testparam <span style=color:#e6db74>&#34;@contains test&#34;</span> <span style=color:#e6db74>&#34;id:1234,deny,status:403,msg:&#39;Our test rule has triggered&#39;&#34;</span>
</code></pre></div><p>This rule will be triggered when you go to your web page and pass the testparam (via either GET or POST) with the test value. This typically will looks similar to the following: <code>http://localhost/?testparam=test</code>.</p><p>If all went well you should see an HTTP 403 Forbidden in your browser when you navigate to the site in question. Additionally, in your Event Viewer, under &lsquo;Windows Logs&rsquo;->&lsquo;Application&rsquo;, we should see a new log that looks like the following:</p><p>&lt;Log.png></p><p>If you have gotten to this step ModSecurity is functioning on IIS and you now know where to place new directives.</p><h2 id=downloading-owasp-crs>Downloading OWASP CRS</h2><p>Now that you know where your rules belong typically we&rsquo;ll want to download the OWASP CRS. The best place to get the latest copy of the ruleset will be from <a href=https://github.com/coreruleset/coreruleset>our Github</a>. Be careful to determine if there are any more relevant branches in development that can take advantage of the version of ModSecurity you are using. You can do this by checking the different branches on the site and looking throughout this documentation. To download a repository you can either click the
<a href=https://github.com/coreruleset/coreruleset/archive/master.zip target=_blank class="btn btn-default"><i class="fas fa-download"></i>
Download Zip</a>
button or your can use git clone. For instance,</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git clone https://github.com/coreruleset/coreruleset.git
</code></pre></div><p>Typically you&rsquo;ll end up with a folder named something similar to <code>owasp-modsecurity-crs</code>. From here the process is surprisingly simple.
Because OWASP CRS is, at its core, a set of ModSecurity configuration files (<code>*.conf</code> files) all you have to do is tell ModSecurity where these CRS configuration files reside and it will do MOST of the remaining work. To do this you must use the <code>'Include'</code> directive. This include directive can be used in similar places to where we used our SecRule
earlier. It should be noted that OWASP CRS should be included AFTER the ModSecurity configuration rules which are available via the <a href=https://github.com/SpiderLabs/ModSecurity/blob/master/modsecurity.conf-recommended>ModSecurity repo</a> which should have been configured during your inital installation. These rules will configure ModSecurity options, such as SecRuleEngine that we used earlier. This configuration file should be reviewed and modified as desired.</p><h3 id=setup-owasp-crs>Setup OWASP CRS</h3><p>OWASP CRS contains one setup file that should be reviewed prior to
completing setup. The setup file is the only configuration file within
the root &lsquo;owasp-crs-modsecurity&rsquo; folder and is named
<code>csr-setup.conf.example</code>. Going through the configuration file
(<code>csr-setup.conf.example</code>) and reading what the different options are is
HIGHLY recommended. At minimum you should keep in mind the following.</p><ul><li>CRS does not configure ModSecurity features such as the rule engine,
the audit engine, logging etc. This task is part of the ModSecurity
initial setup.If you haven&rsquo;t done this yet please check out the
<a href=https://github.com/SpiderLabs/ModSecurity/blob/master/modsecurity.conf-recommended>recommended ModSecurity configuration</a></li><li>By default <a href=https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#SecDefaultAction>SecDefaultAction</a> CRS will redirect to your local domain when an alert is triggered.
This may cause redirect loops depending on your configuration. Take
some time to decide what you want ModSecurity it do (drop the
packet, return a status:403, go to a custom page etc.) when it
detects malicious activity.</li><li>Make sure to configure your anomaly scoring thresholds for more
information see <a href=/documentation/configuring/anomaly/ title=Anomaly>Anomaly</a></li><li>By default ModSecurity looks for lots of issues with different
databases and languages, if you are running a specific environment,
you probably want to limit this behaviour for performance reasons.</li><li>ModSecurity supports <a href=https://www.projecthoneypot.org/>Project Honeypot</a> blacklists. This is a
great project and all you need to do to leverage it is sign up for
an <a href=https://www.projecthoneypot.org/httpbl_api.php>API key</a></li><li>Do make sure you have added any methods, static resources, content
types, or file extensions that your site needs beyond the basic ones
listed.</li></ul><p>For more information please see the page on
<a href=/documentation/configuring/crs/ title=configuration>configuration</a>. Once you have reviewed
and configured CRS you should rename the file suffix from <code>.example</code> to
<code>.conf</code>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mv csr-setup.conf.example csr-setup.conf
</code></pre></div><p>In addition to <code>csr-setup.conf.example</code> there are two other .example files
within our repository. These files are:
<code>rules/REQUEST-00-LOCAL-WHITELIST.conf.example</code> and
<code>rules/RESPONSE-99-EXCEPTIONS.conf.example</code>. These files are designed to
provide the rule maintainer the capability to modify rules (see
<a href=exceptions.md>exceptions</a>) without breaking forward
compatability with updates. As such you should rename these two files,
removing the <code>.example</code> suffix. This will make it so that even when
updates are installed they do not overwrite your custom updates. To
rename the files in Linux one would use a command similar to the
following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mv rules/REQUEST-00-LOCAL-WHITELIST.conf.example rules/REQUEST-00-LOCAL-WHITELIST.conf
mv rules/RESPONSE-99-EXCEPTIONS.conf.example rules/RESPONSE-99-EXCEPTIONS.conf
</code></pre></div><h2 id=proceeding-with-the-install>Proceeding with the Install</h2><p>Both ModSecurity 2.x (via APR) and ModSecurity 3.x support the Include
directive and what it tells the ModSecurity core to do is parse the
additional files for ModSecurity directives. But where do you place this
folder for it to be included? If you were to look at the CRS files,
you&rsquo;d note there are quite a few .conf files. While the names attempt
to do a good job at describing what each file does additional
information is available in the <a href=rules.md>rules</a>
section.</p><h3 id=includes-for-apache>Includes for Apache</h3><p>Apache will include from the Apache Root directory (<code>/etc/httpd/</code>,
<code>/etc/apache2/</code>, or <code>/usr/local/apache2/</code> depending on the envirovment).
Typically we reccomend following the Fedora practice of creating a
folder specificlly for ModSecurity rules. In our example we have named
this modsecurity.d and placed in within the root Apache directory. When
using Apache we can use the wildcard notation to vastly simplify our
rules. Simply copying our cloned directory to our modsecurity.d folder
and specifying the appropertie include directives will allow us to
install OWASP CRS. In the example below we have also included our
<code>modsecurity.conf</code> file which includes reccomended configurations for
ModSecurity</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-apache data-lang=apache><span style=color:#f92672>&lt;IfModule</span> <span style=color:#e6db74>security2_module</span><span style=color:#f92672>&gt;</span>
        Include modsecurity.d/modsecurity.conf
        Include modsecurity.d/owasp-modsecurity-crs/csr-setup.conf
        Include modsecurity.d/owsp-modsecurity-crs/rules/*.conf
<span style=color:#f92672>&lt;/IfModule&gt;</span>
</code></pre></div><h3 id=includes-for-nginx>Includes for Nginx</h3><p>Nginx will include from the Nginx conf directory (<code>/usr/local/nginx/conf/</code>
depending on the envirovment). Because only one <code>ModSecurityConfig</code>
directive can be specified within nginx.conf we reccomend naming that
file <code>modsec_includes.conf</code> and including additional files from there. In
the example below we copied our cloned <code>owasp-modsecurity-crs</code> folder into
our Nginx configuration directory. From there we specifying the
appropertie include directives which will include OWASP CRS when the
server is restarted. In the example below we have also included our
<code>modsecurity.conf</code> file which includes reccomended configurations for
ModSecurity</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=color:#66d9ef>include</span> modsecurity.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/csr-setup.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-00-LOCAL-WHITELIST.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-01-COMMON-EXCEPTIONS.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-10-IP-REPUTATION.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-11-METHOD-ENFORCEMENT.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-12-DOS-PROTECTION.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-13-SCANNER-DETECTION.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-21-PROTOCOL-ATTACK.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-30-APPLICATION-ATTACK-LFI.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-31-APPLICATION-ATTACK-RFI.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-32-APPLICATION-ATTACK-RCE.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-33-APPLICATION-ATTACK-PHP.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-41-APPLICATION-ATTACK-XSS.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-42-APPLICATION-ATTACK-SQLI.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-43-APPLICATION-ATTACK-SESSION-FIXATION.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/REQUEST-49-BLOCKING-EVALUATION.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/RESPONSE-50-DATA-LEAKAGES-IIS.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/RESPONSE-50-DATA-LEAKAGES-JAVA.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/RESPONSE-50-DATA-LEAKAGES-PHP.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/RESPONSE-50-DATA-LEAKAGES.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/RESPONSE-51-DATA-LEAKAGES-SQL.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/RESPONSE-59-BLOCKING-EVALUATION.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/RESPONSE-80-CORRELATION.conf
<span style=color:#66d9ef>include</span> owasp-modsecurity-crs/rules/RESPONSE-99-EXCEPTIONS.conf
</code></pre></div><h2 id=setting-up-automated-updated>Setting up automated updated</h2><p>todo: The OWASP Core Rule Set is designed with the capability to be
frequently updated in mind. New threats and techniques and updates are
provided frequently as part of the rule set and as a result, in order to
combat the latest threats effectivly it is imperative that constant
updates should be part of your strategy.</p><h3 id=an-update-script>An update script</h3><p>As part of our continuing effort to provide the most user friendly rule
set available we provide an example script that you can use for updating
your ruleset:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e># -*- coding: utf-8 -*-</span>
<span style=color:#e6db74>&#34;&#34;&#34;
</span><span style=color:#e6db74>This script is designed to allow users to automatically
</span><span style=color:#e6db74>update their ModSecurity OWASP Core Rule Set. It can
</span><span style=color:#e6db74>be called by a cronjob or scheduled task in order to
</span><span style=color:#e6db74>allow for automation. Note that it can either replace
</span><span style=color:#e6db74>the whole CRS directory or just update the rules folder,
</span><span style=color:#e6db74>which is the default.
</span><span style=color:#e6db74>&#34;&#34;&#34;</span>

<span style=color:#f92672>from</span> __future__ <span style=color:#f92672>import</span> print_function
<span style=color:#f92672>import</span> argparse
<span style=color:#f92672>import</span> os
<span style=color:#f92672>import</span> uuid
<span style=color:#f92672>import</span> shutil
<span style=color:#f92672>import</span> logging

<span style=color:#66d9ef>try</span>:
    <span style=color:#f92672>from</span> git <span style=color:#f92672>import</span> Repo
<span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ImportError</span>:
    print(<span style=color:#e6db74>&#34;This script requires the GitPython module (pip install gitpython).&#34;</span>)

__author__ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Chaim Sanders&#34;</span>
__copyright__ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Copyright 2016, Trustwave Inc&#34;</span>
__credits__ <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;Chaim Sanders&#34;</span>]
__license__ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;ASL 2.0&#34;</span>
__version__ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;1.0&#34;</span>
__maintainer__ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Chaim Sanders&#34;</span>
__git__ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;csanders-git&#34;</span>
__status__ <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Production&#34;</span>

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>check_arguments</span>(logger):
    <span style=color:#e6db74>&#34;&#34;&#34;Control arguments and set args variable&#34;&#34;&#34;</span>
    example_string <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Examples: python </span><span style=color:#e6db74>%(prog)s</span><span style=color:#e6db74> --full -p ./owasp-modsecurity-crs/&#34;</span> \
                     <span style=color:#e6db74>&#34; or python </span><span style=color:#e6db74>%(prog)s</span><span style=color:#e6db74> --folder=util/ --path=./owasp-modsecurity-crs/util&#34;</span> \
                     <span style=color:#e6db74>&#34; or python </span><span style=color:#e6db74>%(prog)s</span><span style=color:#e6db74>&#34;</span>
    parser <span style=color:#f92672>=</span> argparse<span style=color:#f92672>.</span>ArgumentParser(description<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Update OWASP CRS rules&#39;</span>,
                                     formatter_class<span style=color:#f92672>=</span>argparse<span style=color:#f92672>.</span>ArgumentDefaultsHelpFormatter,
                                     epilog<span style=color:#f92672>=</span>example_string)
    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;-b&#39;</span>, <span style=color:#e6db74>&#39;--branch&#39;</span>, default<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;v3.0.0-rc1&#34;</span>, type<span style=color:#f92672>=</span>str,
                        required<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;The GitHub branch you want to download.&#39;</span>)
    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;-r&#39;</span>, <span style=color:#e6db74>&#39;--repo&#39;</span>,
                        default<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://github.com/SpiderLabs/owasp-modsecurity-crs&#34;</span>,
                        type<span style=color:#f92672>=</span>str, required<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;The GitHub repository you want to use.&#39;</span>)
    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;-p&#39;</span>, <span style=color:#e6db74>&#39;--path&#39;</span>, default<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;./owasp-modsecurity-crs/rules/&#34;</span>, type<span style=color:#f92672>=</span>str,
                        required<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;The path where the rules files should be placed&#39;</span>)
    group <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span>add_mutually_exclusive_group(required<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
    group<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--full&#39;</span>, action<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;store_true&#39;</span>,
                       required<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>,
                       help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Copy the whole repo to the path specified instead of just the rules&#39;</span>)
    group<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;--folder&#39;</span>, default<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;rules/&#34;</span>, type<span style=color:#f92672>=</span>str,
                       required<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>,
                       help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;The toplevel folder within the repo to copy. Can</span><span style=color:#ae81ff>\&#39;</span><span style=color:#e6db74>t be used with full&#39;</span>)
    parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#39;-d&#39;</span>, <span style=color:#e6db74>&#39;--debug&#39;</span>, action<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;store_true&#39;</span>,
                        required<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Display debug logging.&#39;</span>)
    args <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span>parse_args()
    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>debug:
        logger<span style=color:#f92672>.</span>setLevel(logging<span style=color:#f92672>.</span>DEBUG)
        logger<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#34;Debugging mode has been enabled.&#34;</span>)
    logger<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#34;The following arguments were assigned: &#34;</span> <span style=color:#f92672>+</span> str(args) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.&#34;</span>)
    <span style=color:#66d9ef>return</span> args

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>download_rules</span>(args, logger):
    <span style=color:#e6db74>&#34;&#34;&#34;Download and replace our rules&#34;&#34;&#34;</span>
    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>path[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>] <span style=color:#f92672>!=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>sep:
        dst_dir <span style=color:#f92672>=</span> args<span style=color:#f92672>.</span>path <span style=color:#f92672>+</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>sep
    <span style=color:#66d9ef>else</span>:
        dst_dir <span style=color:#f92672>=</span> args<span style=color:#f92672>.</span>path
    logger<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#34;The final path was set to &#34;</span> <span style=color:#f92672>+</span> str(dst_dir) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.&#34;</span>)
    rand_fold <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;./&#34;</span> <span style=color:#f92672>+</span> str(uuid<span style=color:#f92672>.</span>uuid4())
    logger<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#34;The temporary repo folder was set to &#34;</span> <span style=color:#f92672>+</span> str(rand_fold) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.&#34;</span>)
    <span style=color:#75715e># If the user wants the whole directory set that otherwise just rules/</span>
    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>full:
        copy_fold <span style=color:#f92672>=</span> rand_fold
    <span style=color:#66d9ef>else</span>:
        copy_fold <span style=color:#f92672>=</span> rand_fold <span style=color:#f92672>+</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>sep <span style=color:#f92672>+</span> args<span style=color:#f92672>.</span>folder
    logger<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#34;Set the folder to be copied to &#34;</span> <span style=color:#f92672>+</span> copy_fold <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.&#34;</span>)
    Repo<span style=color:#f92672>.</span>clone_from(args<span style=color:#f92672>.</span>repo, rand_fold, branch<span style=color:#f92672>=</span>(args<span style=color:#f92672>.</span>branch))
    logger<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#34;Cloned the repo successfully.&#34;</span>)
    <span style=color:#66d9ef>for</span> src_dir, _, files <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>walk(copy_fold):
        <span style=color:#66d9ef>for</span> file_ <span style=color:#f92672>in</span> files:
            <span style=color:#66d9ef>if</span> file_[<span style=color:#f92672>-</span><span style=color:#ae81ff>8</span>:] <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;.example&#34;</span>:
                src_file <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(src_dir, file_)
                <span style=color:#75715e># If its the full copy we need the new prefix path</span>
                <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>full:
                    copy_path <span style=color:#f92672>=</span> src_file<span style=color:#f92672>.</span>replace(rand_fold, <span style=color:#e6db74>&#34;&#34;</span>)[<span style=color:#ae81ff>1</span>:]
                <span style=color:#66d9ef>else</span>:
                    <span style=color:#75715e># Remove the overlap in folders</span>
                    copy_path <span style=color:#f92672>=</span> src_file<span style=color:#f92672>.</span>replace(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(rand_fold, args<span style=color:#f92672>.</span>folder), <span style=color:#e6db74>&#34;&#34;</span>)
                dst_file <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(dst_dir, copy_path)
                cwd <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>dirname(dst_file)
                <span style=color:#75715e># Check if the directory structure exists</span>
                <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(cwd):
                    os<span style=color:#f92672>.</span>makedirs(cwd)
                <span style=color:#66d9ef>if</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(dst_file):
                    os<span style=color:#f92672>.</span>remove(dst_file)
                    logger<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#34;Removed existing &#34;</span> <span style=color:#f92672>+</span> dst_file <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.&#34;</span>)
                <span style=color:#66d9ef>try</span>:
                    shutil<span style=color:#f92672>.</span>move(src_file, cwd)
                <span style=color:#66d9ef>except</span> shutil<span style=color:#f92672>.</span>Error <span style=color:#66d9ef>as</span> exc:
                    print(exc)
                logger<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#34;Moved &#34;</span> <span style=color:#f92672>+</span> file_ <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; to &#34;</span> <span style=color:#f92672>+</span> cwd <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;.&#34;</span>)
    logger<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#34;Copying completed successfully&#34;</span>)
    shutil<span style=color:#f92672>.</span>rmtree(rand_fold)
    logger<span style=color:#f92672>.</span>debug(<span style=color:#e6db74>&#34;Deleted the temporary folder.&#34;</span>)

<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
    <span style=color:#e6db74>&#34;&#34;&#34;Initiate logging and run subroutines&#34;&#34;&#34;</span>
    logging<span style=color:#f92672>.</span>basicConfig(level<span style=color:#f92672>=</span>logging<span style=color:#f92672>.</span>INFO)
    logger <span style=color:#f92672>=</span> logging<span style=color:#f92672>.</span>getLogger(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>basename(__file__))
    args <span style=color:#f92672>=</span> check_arguments(logger)
    download_rules(args, logger)

<span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
    main()
</code></pre></div><h2 id=problems-with-installation>Problems with installation</h2><h3 id=apache-line-continuation>Apache Line Continuation</h3><p>In Apache 2.4.x before 2.4.11 there is a bug where the use of line
continuations in a config size may cause the line continuation to be
truncated. This will lead to an error similar to the following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Syntax error on line <span style=color:#ae81ff>24</span> of /etc/httpd/modsecurity.d/activated_rules/RESPONSE-50-DATA-LEAKAGES-PHP.conf:
Error parsing actions: Unknown action: <span style=color:#ae81ff>\
</span></code></pre></div><p>This is not an error with ModSecurity or OWASP CRS. In order to fix this
issue you can simply add a space before the continuation on the
offending line. For more information see <a href="https://bz.apache.org/bugzilla/show_bug.cgi?id=55910">apache bugzilla</a>.</p><h3 id=anomaly-mode-doesnt-work>Anomaly Mode Doesn&rsquo;t Work</h3><p>Sometimes on IIS or Nginx users run into an instance where anamoly mode
doesn&rsquo;t work as expected. In fact upon careful inspection of logs one
would notice that rules don&rsquo;t fire in the order we would expect. In
general this is a result of using the <code>'*'</code> operator within these
environments as it does not act the same way as in Apache. In general
within both Apache and IIS one should expliticly include the various
files present within the OWASP CRS instead of using the <code>'*'</code>.</p><h3 id=webserver-returns-error-after-crs-install>Webserver returns error after CRS install</h3><p>This is likley due to a rule triggering. For instance in some cases a
rule is enabled that prohibits access via an IP address. Depending on
your
<a href=https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-(v2.x)#SecDefaultAction>SecDefaultAction</a>
and
<a href=https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-(v2.x)#SecRuleEngine>SecRuleEngine</a>
configurations, this may result in a redirect loop or a status code. If
this is the problem you are experiencing you should consult your
error.log (or event viewer for IIS). From this location you can
determine the offending rule and add an exception if neccessary see
<a href=exceptions.md>exceptions</a>.</p><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/documentation/deployment/quickstart/ title="OWASP CRS Quickstart"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/documentation/configuring/ title="How it Works"><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/documentation/js/clipboard.min.js?1636993063></script><script src=/documentation/js/perfect-scrollbar.min.js?1636993063></script><script src=/documentation/js/perfect-scrollbar.jquery.min.js?1636993063></script><script src=/documentation/js/jquery.svg.pan.zoom.js?1636993063></script><script src=/documentation/js/featherlight.min.js?1636993063></script><script src=/documentation/js/modernizr.custom-3.6.0.js?1636993063></script><script src=/documentation/js/mermaid.min.js?1636993063></script><script>typeof mermaid!='undefined'&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script><script src=/documentation/js/relearn.js?1636993063></script><script>var _paq=window._paq=window._paq||[];_paq.push(['trackPageView']),_paq.push(['enableLinkTracking']),function(){var b="https://piwik.netnea.com/matomo/",c,a,d;_paq.push(['setTrackerUrl',b+'matomo.php']),_paq.push(['setSiteId','4']),c=document,a=c.createElement('script'),d=c.getElementsByTagName('script')[0],a.async=!0,a.src=b+'matomo.js',d.parentNode.insertBefore(a,d)}()</script><img referrerpolicy=no-referrer-when-downgrade src="https://piwik.netnea.com/matomo/matomo.php?idsite=4&rec=1" style=border:0 alt></body></html>