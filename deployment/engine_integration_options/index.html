<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.97.3"><meta name=description content="CoreRuleSet Documentation"><meta name=author content="CoreRuleSet"><link rel=icon href=/documentation/images/favicon.png type=image/png><title>Engine and Integration Options :: Core Rule Set Documentation</title><link href=/documentation/css/nucleus.css?1664801399 rel=stylesheet><link href=/documentation/css/fontawesome-all.min.css?1664801399 rel=stylesheet><link href=/documentation/css/featherlight.min.css?1664801399 rel=stylesheet><link href=/documentation/css/perfect-scrollbar.min.css?1664801399 rel=stylesheet><link href=/documentation/css/auto-complete.css?1664801399 rel=stylesheet><link href=/documentation/css/theme.css?1664801399 rel=stylesheet><link href=/documentation/css/theme-blue.css?1664801399 rel=stylesheet><link href=/documentation/css/variant.css?1664801399 rel=stylesheet><link href=/documentation/css/print.css?1664801399 rel=stylesheet media=print><script src=/documentation/js/jquery.min.js?1664801399></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/documentation/deployment/engine_integration_options/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://coreruleset.github.io/documentation/><img src=https://coreruleset.github.io/documentation//images/logo.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/documentation/js/lunr.min.js?1664801399></script>
<script src=/documentation/js/auto-complete.js?1664801399></script>
<script>var index_url="/documentation/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script><script src=/documentation/js/search.js?1664801399></script></div><div id=homelinks><ul><li><a class=padding href=/documentation/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/documentation/deployment/ title="Getting CRS" class="dd-item parent"><a href=/documentation/deployment/><b>1. </b>Getting CRS<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/deployment/engine_integration_options/ title="Engine and Integration Options" class="dd-item active"><a href=/documentation/deployment/engine_integration_options/>Engine and Integration Options<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/quick_start/ title="Quick Start Guide" class=dd-item><a href=/documentation/deployment/quick_start/>Quick Start Guide<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/install/ title="Extended Install" class=dd-item><a href=/documentation/deployment/install/>Extended Install<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/concepts/ title="How CRS Works" class=dd-item><a href=/documentation/concepts/><b>2. </b>How CRS Works<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/concepts/anomaly_scoring/ title="Anomaly Scoring" class=dd-item><a href=/documentation/concepts/anomaly_scoring/>Anomaly Scoring<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/paranoia_levels/ title="Paranoia Levels" class=dd-item><a href=/documentation/concepts/paranoia_levels/>Paranoia Levels<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/false_positives_tuning/ title="False Positives and Tuning" class=dd-item><a href=/documentation/concepts/false_positives_tuning/>False Positives and Tuning<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/plugins/ title="Plugin Mechanism" class=dd-item><a href=/documentation/concepts/plugins/>Plugin Mechanism<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/sampling_mode/ title="Sampling Mode" class=dd-item><a href=/documentation/concepts/sampling_mode/>Sampling Mode<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/operation/ title=Operation class=dd-item><a href=/documentation/operation/><b>3. </b>Operation<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/operation/known_issues/ title="Known Issues" class=dd-item><a href=/documentation/operation/known_issues/>Known Issues<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/containers/ title="Using Containers" class=dd-item><a href=/documentation/operation/containers/>Using Containers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/kubernetes_ingress/ title="Kubernetes Ingress Controllers" class=dd-item><a href=/documentation/operation/kubernetes_ingress/>Kubernetes Ingress Controllers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/log_handling/ title="Log Handling" class=dd-item><a href=/documentation/operation/log_handling/>Log Handling<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/rules/ title=Rules class=dd-item><a href=/documentation/rules/><b>4. </b>Rules<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/rules/ruleid/ title="Rule IDs" class=dd-item><a href=/documentation/rules/ruleid/>Rule IDs<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/rules/ title=Rules class=dd-item><a href=/documentation/rules/rules/>Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/creating/ title=Making class=dd-item><a href=/documentation/rules/creating/>Making<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/metadata/ title=Metadata class=dd-item><a href=/documentation/rules/metadata/>Metadata<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/development/ title=Development class=dd-item><a href=/documentation/development/><b>5. </b>Development<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/development/contribution_guidelines/ title="Contribution Guidelines" class=dd-item><a href=/documentation/development/contribution_guidelines/>Contribution Guidelines<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/regexp_assemble/ title=regexp-assemble class=dd-item><a href=/documentation/development/regexp_assemble/>regexp-assemble<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/rule_writing/ title="Writing Rules" class=dd-item><a href=/documentation/development/rule_writing/>Writing Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/useful_tools/ title="Useful Tools" class=dd-item><a href=/documentation/development/useful_tools/>Useful Tools<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/testing/ title="Testing the Rule Set" class=dd-item><a href=/documentation/development/testing/>Testing the Rule Set<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/plugin_writing/ title="Writing Plugins" class=dd-item><a href=/documentation/development/plugin_writing/>Writing Plugins<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/sandbox/ title="Using the CRS Sandbox" class=dd-item><a href=/documentation/development/sandbox/>Using the CRS Sandbox<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/resources/ title="Additional Resources" class=dd-item><a href=/documentation/resources/><b>6. </b>Additional Resources<i class="fas fa-check read-icon"></i></a><ul></ul></li><li data-nav-id=/documentation/miscellaneous/ title=Miscellaneous class=dd-item><a href=/documentation/miscellaneous/><b>7. </b>Miscellaneous<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/miscellaneous/self_contained_mode/ title="Self-Contained Mode" class=dd-item><a href=/documentation/miscellaneous/self_contained_mode/>Self-Contained Mode<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://coreruleset.org/><i class="fas fa-bookmark"></i> Core Rule Set Home</a></li><li><a class=padding href=https://github.com/coreruleset/coreruleset><i class="fab fa-github"></i> Core Rule Set GitHub</a></li></ul></div><div id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/coreruleset/documentation/blob/main/content/deployment/engine_integration_options.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Engine and Integration Options</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#compatible-free-and-open-source-waf-engines>Compatible Free and Open-Source WAF Engines</a><ul><li><a href=#modsecurity-v2>ModSecurity v2</a></li><li><a href=#modsecurity-v3>ModSecurity v3</a></li><li><a href=#coraza>Coraza</a></li></ul></li><li><a href=#commercial-waf-appliances>Commercial WAF Appliances</a><ul><li><a href=#kempprogressive-loadmaster>Kemp/Progressive LoadMaster</a></li><li><a href=#loadbalancerorg>Loadbalancer.org</a></li><li><a href=#avi-networks-vantage>Avi Networks &ldquo;Vantage&rdquo;</a></li></ul></li><li><a href=#existing-crs-integrations-cloud-and-cdn-offerings>Existing CRS Integrations: Cloud and CDN Offerings</a><ul><li><a href=#aws-waf>AWS WAF</a></li><li><a href=#cloudflare-waf>Cloudflare WAF</a></li><li><a href=#edgecast>Edgecast</a></li><li><a href=#fastly>Fastly</a></li><li><a href=#google-cloud-armor>Google Cloud Armor</a></li><li><a href=#microsoft-azure-waf>Microsoft Azure WAF</a></li><li><a href=#oracle-waf>Oracle WAF</a></li></ul></li><li><a href=#alternative-use-cases>Alternative Use Cases</a><ul><li><a href=#sqreendatadog>Sqreen/Datadog</a></li></ul></li></ul></nav></div></div></div><div id=head-tags></div><main id=body-inner><h1>Engine and Integration Options</h1><blockquote><p>The Core Rule Set runs on WAF engines that are compatible with a subset of ModSecurity&rsquo;s SecLang configuration language. There are several options outside of ModSecurity itself, namely cloud offerings and content delivery network (CDN) services. There is also an open-source alternative to ModSecurity in the form of the new Coraza WAF engine.</p></blockquote><h2 id=compatible-free-and-open-source-waf-engines>Compatible Free and Open-Source WAF Engines</h2><h3 id=modsecurity-v2>ModSecurity v2</h3><p>ModSecurity v2, originally a security module for the Apache web server, is <strong>the reference implementation for CRS</strong>.</p><p>ModSecurity 2.9.x passes 100% of the CRS unit tests on the Apache platform.</p><p>When running ModSecurity, this is the option that is <em>practically guaranteed</em> to work with most documentation and know-how all around.</p><p>ModSecurity is released under the Apache License 2.0. It is primarily developed by Spiderlabs, an entity within the company Trustwave. In summer 2021, Trustwave announced their plans to end development of ModSecurity in 2024. Attempts to convince Trustwave to hand over the project in the meantime, in the interests of guaranteeing the project&rsquo;s continuation, have failed. Trustwave have stated that they will not relinquish control of the project before 2024.</p><p>As of this writing, there is no imminent need to leave the ModSecurity v2 platform, but such a step may become necessary in the future as the project&rsquo;s development stalls or new security problems can no longer be fixed. Despite these difficulties, the CRS community is confident it has the power and knowledge to provide ModSecurity patches if really needed.</p><p>To learn more about the situation around ModSecurity, read <a href=https://coreruleset.org/20211222/talking-about-modsecurity-and-the-new-coraza-waf/>this CRS blog post</a> discussing the matter.</p><p>There is a <a href=https://github.com/coreruleset/modsecurity-crs-docker>ModSecurity v2 / Apache Docker container</a> which is maintained by the CRS project.</p><h3 id=modsecurity-v3>ModSecurity v3</h3><p>ModSecurity v3, also known as <em>libModSecurity</em>, is a re-implementation of ModSecurity v3 with an architecture that is less dependent on the web server. The connection between the standalone ModSecurity and the web server is made using a lean connector module.</p><p>As of spring 2021, <em>only the Nginx connector module is really usable in production</em>.</p><p>ModSecurity v3 fails with 2-4% of the CRS unit tests due to bugs and implementation gaps. Nginx + ModSecurity v3 also suffers from performance problems when compared to the Apache + ModSecurity v2 platform. This may be surprising for people familiar with the high performance of Nginx.</p><p>ModSecurity v3 is used in production together with Nginx, but the CRS project recommends to use the ModSecurity v2 release line with Apache.</p><p>ModSecurity is released under the Apache License 2.0. It is primarily developed by Spiderlabs, an entity within the company Trustwave. In summer 2021, Trustwave announced their plans to end development of ModSecurity in 2024. Attempts to convince Trustwave to hand over the project in the meantime, in the interests of guaranteeing the project&rsquo;s continuation, have failed. Trustwave have stated that they will not relinquish control of the project before 2024.</p><p>To learn more about the situation around ModSecurity, read <a href=https://coreruleset.org/20211222/talking-about-modsecurity-and-the-new-coraza-waf/>this CRS blog post</a> discussing the matter.</p><p>There is a <a href=https://github.com/coreruleset/modsecurity-crs-docker>ModSecurity v3 / Nginx Docker container</a> which is maintained by the CRS project.</p><h3 id=coraza>Coraza</h3><p>The new <a href=https://coraza.io/>OWASP Coraza WAF</a> is meant to provide an open-source alternative to the two ModSecurity release lines.</p><p>Coraza passes 100% of the CRS v4 test suite and is thus <em>fully compatible with CRS</em>.</p><p>Coraza has been developed in Go and currently runs on the Caddy and Traefik platforms. Additional ports are being developed and the developers also seek to bring Coraza to Nginx and, eventually, Apache. In parallel to this expansion, Coraza will be developed further with its own feature set.</p><p>To learn more about CRS and Coraza, read <a href=https://coreruleset.org/20211222/talking-about-modsecurity-and-the-new-coraza-waf/>this CRS blog post</a> which introduces Coraza.</p><h2 id=commercial-waf-appliances>Commercial WAF Appliances</h2><p>Dozens of commercial WAFs, both virtual and hardware-based, offer CRS as part of their service. Many of them use ModSecurity underneath, or some alternative implementation (although this is rare on the WAF appliance approach). Most of these commercial WAFs either don&rsquo;t offer the full feature set of CRS or they don&rsquo;t make it easily accessible. With some of these companies, there is often also a lack of CRS experience and knowledge.</p><p>The CRS project recommends evaluating these commercial appliance-based offerings in a holistic way before buying a license.</p><p>In light of the many, many appliance offerings on the market and the CRS project&rsquo;s relatively limited exposure, only a few offerings are listed here.</p><h3 id=kempprogressive-loadmaster>Kemp/Progressive LoadMaster</h3><p>The Kemp LoadMaster is a popular load balancer that integrates ModSecurity v2 and CRS in a typical way. It goes further than the competition with the support of most CRS features.</p><p>To learn more, read <a href=https://kemptechnologies.com/blog/how-to-run-owasp-open-web-application-security-project-i-kemp-load-master/>this blog post about CRS on LoadMaster</a>.</p><p>Kemp/Progressive is a sponsor of CRS.</p><h3 id=loadbalancerorg>Loadbalancer.org</h3><p>The load balancer appliance from Loadbalancer.org features WAF functionality based on Apache + ModSecurity v2 + CRS, sandwiched by HAProxy for load balancing. It&rsquo;s available as a hardware, virtual, and cloud appliance.</p><p>To learn more, read <a href=https://www.loadbalancer.org/blog/simplifying-web-application-security-with-the-core-rule-set-v3/>this blog post about CRS at Loadbalancer.org</a>.</p><h3 id=avi-networks-vantage>Avi Networks &ldquo;Vantage&rdquo;</h3><p>Avi Vantage from Avi Networks is a modern virtual load balancer and proxy with strong WAF capabilities. It&rsquo;s based on a fork of ModSecurity v3.</p><p>To learn more, read <a href=https://avinetworks.com/docs/21.1/waf-configuring/>Avi&rsquo;s WAF documentation</a>.</p><h2 id=existing-crs-integrations-cloud-and-cdn-offerings>Existing CRS Integrations: Cloud and CDN Offerings</h2><p>Most big cloud providers and CDNs provide a CRS offering. While originally these were mostly based on ModSecurity, over time they have all moved to alternative (usually proprietary) implementations of ModSecurity&rsquo;s SecLang configuration language, or they transpose the CRS rules written in SecLang into their own domain specific language (DSL).</p><p>The CRS project has some insight into some of these platforms and is in touch with most of these providers. The <em>exact specifics</em> are not really known, however, but what <em>is</em> known is that almost all of these integrators compromised and provide a <em>subset</em> of CRS rules and a <em>subset</em> of features, in the interests of ease of integration and operation.</p><div class="notices info"><div class=label>Info</div><p>The <a href=https://github.com/coreruleset/coreruleset/wiki/DevRetreat21StatusPage>CRS Status page project</a> will be testing cloud and CDN offerings. As part of this effort, the CRS project will be documenting the results and even publishing code on how to quickly get started using CRS in CDN/cloud providers. This status page project is in development as of spring 2022.</p></div><p>A selection of these platforms are listed below, along with links to get more info.</p><h3 id=aws-waf>AWS WAF</h3><p>AWS provides an <a href=https://docs.aws.amazon.com/waf/latest/developerguide/aws-managed-rule-groups-baseline.html>abridged version of the Core Rule set</a>. It&rsquo;s confusing initially because, as a managed rule set, it&rsquo;s called <code>AWSManagedRulesCommonRuleSet</code>, but technically it&rsquo;s their partial implementation of / resembles the CRS.</p><h3 id=cloudflare-waf>Cloudflare WAF</h3><p>Cloudflare WAF supports CRS as one of its WAF rule sets. Documentation on how to use it can be found in <a href=https://developers.cloudflare.com/waf/managed-rulesets/owasp-core-ruleset/>Cloudflare&rsquo;s documentation</a>.</p><h3 id=edgecast>Edgecast</h3><p>Edgecast offers CRS as a managed rule set as part of their WAF service that runs on a ModSecurity re-implementation called WAFLZ.</p><p>To learn more about Edgecast, read <a href=https://docs.edgecast.com/cdn/Content/Web-Security/Managed-Rules.htm#RuleSet>their WAF documentation</a>.</p><h3 id=fastly>Fastly</h3><p>Fastly has offered CRS as part of their Fastly WAF for several years, but they have started to migrate their existing customers to the recently acquired Signal Sciences WAF. Interestingly, Fastly is transposing CRS rules into their own Varnish-based WAF engine.</p><p>For more information about the Fastly CRS offering, read <a href=https://docs.fastly.com/en/guides/fastly-waf-rule-set-updates-maintenance-legacy>their WAF documentation</a>.</p><h3 id=google-cloud-armor>Google Cloud Armor</h3><p>Google integrates CRS into its Cloud Armor WAF offering. Google runs the CRS rules on their own WAF engine. As of fall 2022, Google offers version 3.3.2 of CRS.</p><p>To learn more about CRS on Google&rsquo;s Cloud Armor, read <a href=https://cloud.google.com/armor/docs/rule-tuning>this document from Google</a>.</p><p>Google Cloud Armor is a sponsor of CRS.</p><h3 id=microsoft-azure-waf>Microsoft Azure WAF</h3><p>Azure Application Gateways can be configured to use the WAFv2 and <a href=https://docs.microsoft.com/en-us/azure/web-application-firewall/ag/application-gateway-crs-rulegroups-rules>managed rules with different versions of CRS</a>. Azure provides the 3.2, 3.1, 3.0, and 2.2.9 CRS versions. <strong>We recommend using version 3.2</strong> (see our <a href=https://github.com/coreruleset/coreruleset/blob/v3.4/dev/SECURITY.md>security policy</a> for details on supported CRS versions).</p><h3 id=oracle-waf>Oracle WAF</h3><p>The Oracle WAF is a cloud-based offering that includes CRS. To learn more, read <a href=https://docs.oracle.com/en-us/iaas/Content/WAF/Concepts/waftuning.htm>Oracle&rsquo;s WAF documentation</a>.</p><h2 id=alternative-use-cases>Alternative Use Cases</h2><p>Outside of the narrower implementation of a WAF, CRS can also be found in different security-related setups.</p><h3 id=sqreendatadog>Sqreen/Datadog</h3><p>Sqreen uses a subset of CRS as an innovative part of their RASP offering. A few pieces of information about this offering can be found in <a href=https://blog.sqreen.com/sqreen-october-release/>this Sqreen blog post</a>.</p><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/documentation/deployment/ title="Getting CRS"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/documentation/deployment/quick_start/ title="Quick Start Guide"><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/documentation/js/clipboard.min.js?1664801399></script>
<script src=/documentation/js/perfect-scrollbar.min.js?1664801399></script>
<script src=/documentation/js/perfect-scrollbar.jquery.min.js?1664801399></script>
<script src=/documentation/js/jquery.svg.pan.zoom.js?1664801399></script>
<script src=/documentation/js/featherlight.min.js?1664801399></script>
<script src=/documentation/js/modernizr.custom-3.6.0.js?1664801399></script>
<script src=/documentation/js/mermaid.min.js?1664801399></script>
<script>typeof mermaid!="undefined"&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script><script src=/documentation/js/relearn.js?1664801399></script>
<script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="https://piwik.netnea.com/matomo/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","4"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><img referrerpolicy=no-referrer-when-downgrade src="https://piwik.netnea.com/matomo/matomo.php?idsite=4&rec=1" style=border:0 alt></body></html>