<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.97.3"><meta name=description content="CoreRuleSet Documentation"><meta name=author content="CoreRuleSet"><link rel=icon href=/documentation/images/favicon.png type=image/png><title>Known Issues :: Core Rule Set Documentation</title><link href=/documentation/css/nucleus.css?1694520495 rel=stylesheet><link href=/documentation/css/fontawesome-all.min.css?1694520495 rel=stylesheet><link href=/documentation/css/featherlight.min.css?1694520495 rel=stylesheet><link href=/documentation/css/perfect-scrollbar.min.css?1694520495 rel=stylesheet><link href=/documentation/css/auto-complete.css?1694520495 rel=stylesheet><link href=/documentation/css/theme.css?1694520495 rel=stylesheet><link href=/documentation/css/theme-blue.css?1694520495 rel=stylesheet><link href=/documentation/css/variant.css?1694520495 rel=stylesheet><link href=/documentation/css/print.css?1694520495 rel=stylesheet media=print><script src=/documentation/js/jquery.min.js?1694520495></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/documentation/operation/known_issues/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://coreruleset.github.io/documentation/><img src=https://coreruleset.github.io/documentation//images/logo.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/documentation/js/lunr.min.js?1694520495></script>
<script src=/documentation/js/auto-complete.js?1694520495></script>
<script>var index_url="/documentation/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script><script src=/documentation/js/search.js?1694520495></script></div><div id=homelinks><ul><li><a class=padding href=/documentation/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/documentation/deployment/ title="Getting CRS" class=dd-item><a href=/documentation/deployment/><b>1. </b>Getting CRS<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/deployment/engine_integration_options/ title="Engine and Integration Options" class=dd-item><a href=/documentation/deployment/engine_integration_options/>Engine and Integration Options<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/quick_start/ title="Quick Start Guide" class=dd-item><a href=/documentation/deployment/quick_start/>Quick Start Guide<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/install/ title="Extended Install" class=dd-item><a href=/documentation/deployment/install/>Extended Install<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/concepts/ title="How CRS Works" class=dd-item><a href=/documentation/concepts/><b>2. </b>How CRS Works<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/concepts/anomaly_scoring/ title="Anomaly Scoring" class=dd-item><a href=/documentation/concepts/anomaly_scoring/>Anomaly Scoring<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/paranoia_levels/ title="Paranoia Levels" class=dd-item><a href=/documentation/concepts/paranoia_levels/>Paranoia Levels<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/false_positives_tuning/ title="False Positives and Tuning" class=dd-item><a href=/documentation/concepts/false_positives_tuning/>False Positives and Tuning<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/plugins/ title="Plugin Mechanism" class=dd-item><a href=/documentation/concepts/plugins/>Plugin Mechanism<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/sampling_mode/ title="Sampling Mode" class=dd-item><a href=/documentation/concepts/sampling_mode/>Sampling Mode<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/operation/ title=Operation class="dd-item parent"><a href=/documentation/operation/><b>3. </b>Operation<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/operation/known_issues/ title="Known Issues" class="dd-item active"><a href=/documentation/operation/known_issues/>Known Issues<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/containers/ title="Using Containers" class=dd-item><a href=/documentation/operation/containers/>Using Containers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/kubernetes_ingress/ title="Kubernetes Ingress Controllers" class=dd-item><a href=/documentation/operation/kubernetes_ingress/>Kubernetes Ingress Controllers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/log_handling/ title="Log Handling" class=dd-item><a href=/documentation/operation/log_handling/>Log Handling<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/rules/ title=Rules class=dd-item><a href=/documentation/rules/><b>4. </b>Rules<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/rules/ruleid/ title="Rule IDs" class=dd-item><a href=/documentation/rules/ruleid/>Rule IDs<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/rules/ title=Rules class=dd-item><a href=/documentation/rules/rules/>Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/creating/ title=Making class=dd-item><a href=/documentation/rules/creating/>Making<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/metadata/ title=Metadata class=dd-item><a href=/documentation/rules/metadata/>Metadata<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/development/ title=Development class=dd-item><a href=/documentation/development/><b>5. </b>Development<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/development/contribution_guidelines/ title="Contribution Guidelines" class=dd-item><a href=/documentation/development/contribution_guidelines/>Contribution Guidelines<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/crs_toolchain/ title=crs-toolchain class=dd-item><a href=/documentation/development/crs_toolchain/>crs-toolchain<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/regex_assembly/ title="Assembling Regular Expressions" class=dd-item><a href=/documentation/development/regex_assembly/>Assembling Regular Expressions<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/rule_writing/ title="Writing Rules" class=dd-item><a href=/documentation/development/rule_writing/>Writing Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/useful_tools/ title="Useful Tools" class=dd-item><a href=/documentation/development/useful_tools/>Useful Tools<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/testing/ title="Testing the Rule Set" class=dd-item><a href=/documentation/development/testing/>Testing the Rule Set<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/plugin_writing/ title="Writing Plugins" class=dd-item><a href=/documentation/development/plugin_writing/>Writing Plugins<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/sandbox/ title="Using the CRS Sandbox" class=dd-item><a href=/documentation/development/sandbox/>Using the CRS Sandbox<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/resources/ title="Additional Resources" class=dd-item><a href=/documentation/resources/><b>6. </b>Additional Resources<i class="fas fa-check read-icon"></i></a><ul></ul></li><li data-nav-id=/documentation/miscellaneous/ title=Miscellaneous class=dd-item><a href=/documentation/miscellaneous/><b>7. </b>Miscellaneous<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/miscellaneous/self_contained_mode/ title="Self-Contained Mode" class=dd-item><a href=/documentation/miscellaneous/self_contained_mode/>Self-Contained Mode<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://coreruleset.org/><i class="fas fa-bookmark"></i> Core Rule Set Home</a></li><li><a class=padding href=https://github.com/coreruleset/coreruleset><i class="fab fa-github"></i> Core Rule Set GitHub</a></li></ul></div><div id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/coreruleset/documentation/blob/main/content/operation/known_issues.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Known Issues</span></div><div class=progress><div class=wrapper><nav id=TableOfContents></nav></div></div></div><div id=head-tags></div><main id=body-inner><h1>Known Issues</h1><blockquote><p>There are some <em>known issues</em> with CRS and some of its compatible WAF engines. This page describes these issues. Get in touch if you think something is missing.</p></blockquote><ul><li><p>There are still <strong>false positives</strong> for standard web applications in the default install (paranoia level 1). Please <a href=https://github.com/coreruleset/coreruleset/issues/new/choose>report these on GitHub</a> if and when encountered.</p><p>False positives from paranoia level 2 and higher are considered to be less interesting, as it is expected that users will write exclusion rules for their alerts in the higher paranoia levels. Nevertheless, false positives from higher paranoia levels can still be reported and the CRS project will try to find a generic solution for them.</p></li><li><p><strong>Apache</strong> may give an error on startup when the CRS is loaded:</p><pre tabindex=0><code>AH00111: Config variable ${[^} is not defined
</code></pre><p>It appears that Apache tries to be smart by trying to evaluate a config variable. This notice should be a warning and can be safely ignored. The problem has been investigated and a solution has not been found yet.</p></li><li><p><strong>ModSecurity 3.0.0-3.0.2</strong> will give an error:</p><pre tabindex=0><code>Expecting an action, got: ctl:requestBodyProcessor=URLENCODED&#34;`
</code></pre><p>Support for the URLENCODED body processor was only added in ModSecurity 3.0.3. To resolve this, upgrade to ModSecurity 3.0.3 or higher.</p></li><li><p><strong>Debian</strong> releases up to and including Jessie lack YAJL/JSON support in ModSecurity. This causes the following error in the Apache ErrorLog or SecAuditLog:</p><pre tabindex=0><code>ModSecurity: JSON support was not enabled.
</code></pre><p>JSON support was enabled in Debian&rsquo;s package version 2.8.0-4 (Nov 2014). To resolve this, it is possible to either use <code>backports.debian.org</code> to install the latest ModSecurity
release or to disable the rule with ID 200001.</p></li><li><p><strong>Apache 2.4 prior to 2.4.11</strong> is affected by a bug in parsing multi-line configuration directives, which causes Apache to fail during startup with an error such as:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-plaintext data-lang=plaintext><span style=display:flex><span>Error parsing actions: Unknown action: \\
</span></span><span style=display:flex><span>Action &#39;configtest&#39; failed.`
</span></span></code></pre></div><p>This bug is known to plague RHEL/Centos 7 below v7.4 or httpd v2.4.6 release 67 and Ubuntu 14.04 LTS users. (The original bug report can be found at <a href="https://bz.apache.org/bugzilla/show_bug.cgi?id=55910">https://bz.apache.org/bugzilla/show_bug.cgi?id=55910</a>).</p><p>It is advisable to upgrade an affected Apache version. If upgrading is not possible, the CRS project provides a script in the <code>util/join-multiline-rules</code> directory which converts the rules into a format that works around the bug. This script must be re-run whenever the CRS rules are modified or updated.</p></li><li><p>As of CRS version 3.0.1, support has been added for the <code>application/soap+xml</code> MIME type by default, as specified in RFC 3902. <strong>OF IMPORTANCE:</strong> application/soap+xml is indicative that XML will be provided. In accordance with this, ModSecurity&rsquo;s XML request body processor should also be configured to support this MIME type. Within the ModSecurity project, <a href=https://github.com/SpiderLabs/ModSecurity/commit/5e4e2af7a6f07854fee6ed36ef4a381d4e03960e>commit 5e4e2af</a> has been merged to support this endeavor. However, if running a modified or preexisting version of the modsecurity.conf file provided by this repository, it is a good idea to upgrade rule &lsquo;200000&rsquo; accordingly. The rule now appears as follows:</p><pre tabindex=0><code>SecRule REQUEST_HEADERS:Content-Type &#34;(?:application(?:/soap\+|/)|text/)xml&#34; \
  &#34;id:&#39;200000&#39;,phase:1,t:none,t:lowercase,pass,nolog,ctl:requestBodyProcessor=XML&#34;
</code></pre></li><li><p><strong>All versions of libmodsecurity3</strong> <a href=https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-(v3.x)#secdisablebackendcompression>do not support</a> the <code>SecDisableBackendCompression</code> directive at all.
If Nginx is acting as a proxy and the backend supports any type of compression, if the client sends an <code>Accept-Encoding: gzip,deflate,...</code> or <code>TE</code> header, the backend will return the response in a compressed format. Because of this, the engine cannot verify the response. As a workaround, you need to override the <code>Accept-Encoding</code> and <code>TE</code> headers in the proxy:</p><pre tabindex=0><code> server {
     server_name     foo.com;
     ...
     location / {
         proxy_pass         http://backend;
         ...
         proxy_set_header   Accept-Encoding &#34;&#34;;
         proxy_set_header   TE &#34;&#34;;
     }
 }
</code></pre></li></ul><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/documentation/operation/ title=Operation><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/documentation/operation/containers/ title="Using Containers"><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/documentation/js/clipboard.min.js?1694520495></script>
<script src=/documentation/js/perfect-scrollbar.min.js?1694520495></script>
<script src=/documentation/js/perfect-scrollbar.jquery.min.js?1694520495></script>
<script src=/documentation/js/jquery.svg.pan.zoom.js?1694520495></script>
<script src=/documentation/js/featherlight.min.js?1694520495></script>
<script src=/documentation/js/modernizr.custom-3.6.0.js?1694520495></script>
<script src=/documentation/js/mermaid.min.js?1694520495></script>
<script>typeof mermaid!="undefined"&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script><script src=/documentation/js/relearn.js?1694520495></script>
<script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="https://piwik.netnea.com/matomo/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","4"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><img referrerpolicy=no-referrer-when-downgrade src="https://piwik.netnea.com/matomo/matomo.php?idsite=4&rec=1" style=border:0 alt></body></html>