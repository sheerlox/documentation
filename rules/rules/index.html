<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.97.3"><meta name=generator content="Relearn 3.4.1+tip"><meta name=description content="CoreRuleSet Documentation"><meta name=author content="CoreRuleSet"><title>Rules :: Core Rule Set Documentation</title><link rel=icon href=/documentation/images/favicon.png?1651506424 type=image/png><link href=/documentation/css/nucleus.css?1651506424 rel=stylesheet><link href=/documentation/css/fontawesome-all.min.css?1651506424 rel=stylesheet><link href=/documentation/css/featherlight.min.css?1651506424 rel=stylesheet><link href=/documentation/css/perfect-scrollbar.min.css?1651506424 rel=stylesheet><link href=/documentation/css/auto-complete.css?1651506424 rel=stylesheet><link href=/documentation/css/theme.css?1651506424 rel=stylesheet><link href=/documentation/css/theme-blue.css?1651506424 rel=stylesheet id=variant-style><link href=/documentation/css/variant.css?1651506424 rel=stylesheet><link href=/documentation/css/print.css?1651506424 rel=stylesheet media=print><script src=/documentation/js/variant.js?1651506424></script>
<script>var index_url="/documentation/index.json",baseUriFull,root_url="/",baseUri=root_url.replace(/\/$/,'');window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",baseUriFull="https://coreruleset.github.io/documentation/",variants.init(["blue"])</script><script src=/documentation/js/jquery.min.js?1651506424></script></head><body class=mobile-support data-url=/documentation/rules/rules/><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable><div><div class=navigation><a class="nav nav-next" href=/documentation/rules/creating/ title=Making><i class="fas fa-chevron-right fa-fw"></i></a></div><div class=navigation><a class="nav nav-prev" href=/documentation/rules/ruleid/ title="Rule IDs"><i class="fas fa-chevron-left fa-fw"></i></a></div><div id=top-github-link><a class=github-link title=Edit href=https://github.com/coreruleset/documentation/blob/main/content/rules/rules.md target=blank><i class="fas fa-pen fa-fw"></i></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle title=Menu><i class="fas fa-bars fa-fw"></i></a></span>
<span class=links>Rules</span></div></div></nav><main id=body-inner class=highlightable><div class=flex-block-wrapper><div id=head-tags></div><article><h1>Rules</h1><div class="box notices note"><div class=box-label><i class="fas fa-exclamation-circle fa-fw"></i> Note</div><div class=box-content><p><strong>The content on this page may be outdated.</strong> We are currently in the process of rewriting all of our documentation: please bear with us while we update our older content.</p></div></div><h1 id=whats-in-the-rules>What&rsquo;s In The Rules</h1><p>| <strong>REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example</strong>
| Â Configuration Path:
<code>rules/REQUEST-900-EXCLUSION-RULES-BEFORE-CRS.conf.example</code>
| This file is used to add LOCAL exceptions for your site. Often in this
file we would see rules that short-circuit inspection and allow
certain transactions to skip through inspection.
<code>Example: SecRule REMOTE_ADDR "@ipMatch 192.168.1.100" "phase:1,id:'981033',t:none,nolog,pass,ctl:ruleEngine=Off"</code>|
| <strong>REQUEST-901-INITIALIZATION.conf</strong> | TODO |
| <strong>REQUEST-903.9001-DRUPAL-EXCLUSION-RULES.conf
REQUEST-903.9002-WORDPRESS-EXCLUSION-RULES.conf
REQUEST-903.9003-NEXTCLOUD-EXCLUSION-RULES.conf
REQUEST-903.9004-DOKUWIKI-EXCLUSION-RULES.conf
REQUEST-903.9005-CPANEL-EXCLUSION-RULES.conf
REQUEST-903.9006-XENFORO-EXCLUSION-RULES.conf</strong> | TODO |</p><p><strong>REQUEST-901-INITIALIZATION.conf</strong>
TODO</p><p><strong>REQUEST-903.9001-DRUPAL-EXCLUSION-RULES.conf
REQUEST-903.9002-WORDPRESS-EXCLUSION-RULES.conf
REQUEST-903.9003-NEXTCLOUD-EXCLUSION-RULES.conf
REQUEST-903.9004-DOKUWIKI-EXCLUSION-RULES.conf
REQUEST-903.9005-CPANEL-EXCLUSION-RULES.conf
REQUEST-903.9006-XENFORO-EXCLUSION-RULES.conf</strong>
TODO</p><p>| <strong>REQUEST-905-COMMON-EXCEPTIONS</strong>
| Configuration Path:
<code>rules/REQUEST-905-COMMON-EXCEPTIONS.conf</code>
|
| Some rules are quite prone to causing false positives in well
established software, such as Apache callbacks or Google Analytics
tracking cookie. This file offers rules that will allow the
transactions to avoid triggering these false positives.</p><p>| <strong>REQUEST-910-IP-REPUTATION</strong>
| Configuration Path:
<code>rules/REQUEST-910-IP-REPUTATION.conf</code>
|
| These rules deal with detecting traffic from IPs that have previously
been involved with malicious activity, either on our local site or
globally.</p><p><strong>REQUEST-911-METHOD-ENFORCEMENT</strong>
TODO</p><p>| <strong>REQUEST-912-DOS-PROTECTION</strong>
| Configuration Path:
<code>rules/REQUEST-912-DOS-PROTECTION.conf</code>
|
| The rules in this file will attempt to detect some level 7 DoS (Denial
of Service) attacks against your server.</p><p>| <strong>REQUEST-913-SCANNER-DETECTION</strong>
| Configuration Path:
<code>rules/REQUEST-913-SCANNER-DETECTION.conf</code>
|
| These rules are concentrated around detecting security tools and
scanners.</p><p>| <strong>REQUEST-920-PROTOCOL-ENFORCEMENT</strong>
| Configuration Path:
<code>rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf</code>
|
| The rules in this file center around detecting requests that either
violate HTTP or represent a request that no modern browser would
generate, for instance missing a user-agent.</p><p>| <strong>REQUEST-921-PROTOCOL-ATTACK</strong>
|
| Configuration Path: <code>rules/REQUEST-21-PROTOCOL-ATTACK.conf</code>
| The rules in this file focus on specific attacks against the HTTP
protocol itself such as HTTP Request Smuggling and Response Splitting.</p><p>| <strong>REQUEST-930-APPLICATION-ATTACK-LFI</strong>
|
| Configuration Path: <code>rules/REQUEST-930-APPLICATION-ATTACK-LFI.conf</code></p><p>| These rules attempt to detect when a user is trying to include a file
that would be local to the webserver that they should not have access
to. Exploiting this type of attack can lead to the web application or
server being compromised.</p><p>| <strong>REQUEST-931-APPLICATION-ATTACK-RFI</strong>
| Configuration Path: <code>rules/REQUEST-31-APPLICATION-ATTACK-RFI.conf</code>
|
| These rules attempt to detect when a user is trying to include a
remote resource into the web application that will be executed.
Exploiting this type of attack can lead to the web application or
server being compromised.</p><p><strong>REQUEST-932-APPLICATION-ATTACK-RCE.conf
REQUEST-933-APPLICATION-ATTACK-PHP.conf
REQUEST-934-APPLICATION-ATTACK-GENERIC.conf</strong></p><p>TODO</p><p><strong>REQUEST-941-APPLICATION-ATTACK-XSS.conf</strong>
TODO</p><p>| <strong>REQUEST-942-APPLICATION-ATTACK-SQLI</strong>
| Configuration Path: <code>rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf</code>
|
| Within this configuration file we provide rules that protect against
SQL injection attacks. SQLi attackers occur when an attacker passes
crafted control characters to parameters to an area of the application
that is expecting only data. The application will then pass the
control characters to the database. This will end up changing the
meaning of the expected SQL query.</p><p>| <strong>REQUEST-943-APPLICATION-ATTACK-SESSION-FIXATION</strong>
| Configuration Path: <code>rules/REQUEST-43-APPLICATION-ATTACK-SESSION-FIXATION.conf</code>
|
| These rules focus around providing protection against Session Fixation
attacks.</p><p><strong>REQUEST-944-APPLICATION-ATTACK-JAVA</strong>
TODO</p><p>| <strong>REQUEST-949-BLOCKING-EVALUATION</strong>
| Configuration Path: <code>rules/REQUEST-49-BLOCKING-EVALUATION.conf</code>
|
| These rules provide the anomaly based blocking for a given request. If
you are in anomaly detection mode this file must not be deleted.</p><p>| <strong>RESPONSE-954-DATA-LEAKAGES-IIS</strong>
| Configuration Path:
<code>rules/RESPONSE-954-DATA-LEAKAGES-IIS.conf</code>
|
| These rules provide protection against data leakages that may occur
because of Microsoft IIS</p><p>| <strong>RESPONSE-952-DATA-LEAKAGES-JAVA</strong>
| Configuration Path: <code>rules/RESPONSE-952-DATA-LEAKAGES-JAVA.conf</code>
|
| These rules provide protection against data leakages that may occur
because of Java</p><p>| <strong>RESPONSE-953-DATA-LEAKAGES-PHP</strong>
| Configuration Path:
<code>rules/RESPONSE-953-DATA-LEAKAGES-PHP.conf</code>
|
| These rules provide protection against data leakages that may occur
because of PHP</p><p>| <strong>RESPONSE-950-DATA-LEAKAGES</strong>
| Configuration Path:
<code>rules/RESPONSE-950-DATA-LEAKAGES.conf</code>
|
| These rules provide protection against data leakages that may occur
genericly</p><p>| <strong>RESPONSE-951-DATA-LEAKAGES-SQL</strong>
| Configuration Path:
<code>rules/RESPONSE-951-DATA-LEAKAGES-SQL.conf</code>
|
| These rules provide protection against data leakages that may occur
from backend SQL servers. Often these are indicative of SQL injection
issues being present.</p><p>| <strong>RESPONSE-959-BLOCKING-EVALUATION</strong>
| Configuration Path: <code>rules/RESPONSE-959-BLOCKING-EVALUATION.conf</code>
|
| These rules provide the anomaly based blocking for a given response.
If you are in anomaly detection mode this file must not be deleted.</p><p>| <strong>RESPONSE-980-CORRELATION</strong>
| Configuration Path: <code>rules/RESPONSE-980-CORRELATION.conf</code>
|
| The rules in this configuration file facilitate the gathering of data
about successful and unsuccessful attacks on the server.</p><p><strong>RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example</strong>
Configuration Path: <code>rules/RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.example</code></p><p>This file is used to add LOCAL exceptions for your site. Often in this
file we would see rules that short-circuit inspection and allow
certain transactions to skip through inspection.</p><footer class=footline></footer></article></div></main></div><aside id=sidebar class="default-animation showVisitedLinks"><div id=header-wrapper class=default-animation><div id=header class=default-animation><a id=logo href=https://coreruleset.github.io/documentation/><img src=https://coreruleset.github.io/documentation//images/logo.png></a></div><div class="searchbox default-animation"><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/documentation/js/lunr.min.js?1651506424></script>
<script src=/documentation/js/auto-complete.js?1651506424></script>
<script src=/documentation/js/search.js?1651506424></script></div><div id=homelinks class=default-animation><ul><li><a class=padding href=/documentation/><i class="fas fa-home"></i> Home</a></li></ul></div><div id=content-wrapper class=highlightable><ul class=topics><li data-nav-id=/documentation/deployment/ title="Getting CRS" class=dd-item><input type=checkbox id=section-9196179b4df48fe4f393bf8626001e89 class=toggle><label for=section-9196179b4df48fe4f393bf8626001e89></label><a href=/documentation/deployment/><b>1. </b>Getting CRS<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/deployment/engine_integration_options/ title="Engine and Integration Options" class=dd-item><a href=/documentation/deployment/engine_integration_options/>Engine and Integration Options<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/quick_start/ title="Quick Start Guide" class=dd-item><a href=/documentation/deployment/quick_start/>Quick Start Guide<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/install/ title="Extended Install" class=dd-item><a href=/documentation/deployment/install/>Extended Install<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/configuring/ title="How it Works" class=dd-item><input type=checkbox id=section-e64e361515172711b81c70daddef15db class=toggle><label for=section-e64e361515172711b81c70daddef15db></label><a href=/documentation/configuring/><b>2. </b>How it Works<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/configuring/anomaly_scoring/ title="Anomaly Scoring" class=dd-item><a href=/documentation/configuring/anomaly_scoring/>Anomaly Scoring<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/paranoia_levels/ title="Paranoia Levels" class=dd-item><a href=/documentation/configuring/paranoia_levels/>Paranoia Levels<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/false_positives_tuning/ title="False Positives and Tuning" class=dd-item><a href=/documentation/configuring/false_positives_tuning/>False Positives and Tuning<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/plugins/ title="Plugin Mechanism" class=dd-item><a href=/documentation/configuring/plugins/>Plugin Mechanism<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/sampling_mode/ title="Sampling Mode" class=dd-item><a href=/documentation/configuring/sampling_mode/>Sampling Mode<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/crs/ title=Configuration class=dd-item><a href=/documentation/configuring/crs/>Configuration<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/operation/ title=Operation class=dd-item><input type=checkbox id=section-1e77c265d0f1eb19f76aa47f8d696754 class=toggle><label for=section-1e77c265d0f1eb19f76aa47f8d696754></label><a href=/documentation/operation/><b>3. </b>Operation<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/operation/containers/ title="Using Containers" class=dd-item><a href=/documentation/operation/containers/>Using Containers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/log_handling/ title="Log Handling" class=dd-item><a href=/documentation/operation/log_handling/>Log Handling<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/known_issues/ title="Known Issues" class=dd-item><a href=/documentation/operation/known_issues/>Known Issues<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/rules/ title="Creating Rules" class="dd-item parent"><input type=checkbox id=section-f67a6dce8cc0d0f579129273e1cdbb1f class=toggle checked><label for=section-f67a6dce8cc0d0f579129273e1cdbb1f></label><a href=/documentation/rules/><b>4. </b>Rules<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/rules/ruleid/ title="Rule IDs" class=dd-item><a href=/documentation/rules/ruleid/><b>1. </b>Rule IDs<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/rules/ title=Rules class="dd-item active"><a href=/documentation/rules/rules/><b>4. </b>Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/creating/ title=Making class=dd-item><a href=/documentation/rules/creating/><b>9. </b>Making<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/metadata/ title=Metadata class=dd-item><a href=/documentation/rules/metadata/><b>10. </b>Metadata<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/development/ title=Development class=dd-item><input type=checkbox id=section-fbb3e40f0f1b6648c2ac6280ed066d74 class=toggle><label for=section-fbb3e40f0f1b6648c2ac6280ed066d74></label><a href=/documentation/development/><b>5. </b>Development<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/development/contribution_guidelines/ title="Contribution Guidelines" class=dd-item><a href=/documentation/development/contribution_guidelines/>Contribution Guidelines<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/useful_tools/ title="Useful Tools" class=dd-item><a href=/documentation/development/useful_tools/>Useful Tools<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/testing/ title="Testing the Rule Set" class=dd-item><a href=/documentation/development/testing/>Testing the Rule Set<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/plugin_writing/ title="Writing Plugins" class=dd-item><a href=/documentation/development/plugin_writing/>Writing Plugins<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/sandbox/ title="Using the CRS Sandbox" class=dd-item><a href=/documentation/development/sandbox/>Using the CRS Sandbox<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/resources/ title="Additional Resources" class=dd-item><a href=/documentation/resources/><b>6. </b>Additional Resources<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/miscellaneous/ title=Miscellaneous class=dd-item><input type=checkbox id=section-78bdcd2250f681f81a1dbc45c9a15123 class=toggle><label for=section-78bdcd2250f681f81a1dbc45c9a15123></label><a href=/documentation/miscellaneous/><b>7. </b>Miscellaneous<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/miscellaneous/self_contained_mode/ title="Self-Contained Mode" class=dd-item><a href=/documentation/miscellaneous/self_contained_mode/>Self-Contained Mode<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://coreruleset.org/><i class="fas fa-bookmark"></i> Core Rule Set Home</a></li><li><a class=padding href=https://github.com/coreruleset/coreruleset><i class="fab fa-github"></i> Core Rule Set GitHub</a></li></ul></div><div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"></div><hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showVisitedLinks showFooter"><div id=prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks showVisitedLinks"><ul><li id=select-language-container class=footerLangSwitch><a class="padding select-container"><i class="fas fa-language fa-fw"></i>
<span>&nbsp;</span><div class=select-style><select id=select-language onchange="location=baseUri+this.value"></select></div><div class=select-clear></div></a></li><li id=select-variant-container class=footerVariantSwitch><a class="padding select-container"><i class="fas fa-paint-brush fa-fw"></i>
<span>&nbsp;</span><div class=select-style><select id=select-variant onchange=variants.changeVariant(this.value)><option id=blue value=blue selected>Blue</option></select></div><div class=select-clear></div></a><script>variants.markSelectedVariant()</script></li><li class="footerVisitedLinks showVisitedLinks"><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer class="footerFooter showFooter"><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=/documentation/js/clipboard.min.js?1651506424></script>
<script src=/documentation/js/perfect-scrollbar.min.js?1651506424></script>
<script src=/documentation/js/featherlight.min.js?1651506424></script>
<script src=/documentation/js/theme.js?1651506424></script>
<script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="https://piwik.netnea.com/matomo/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","4"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><img referrerpolicy=no-referrer-when-downgrade src="https://piwik.netnea.com/matomo/matomo.php?idsite=4&rec=1" style=border:0 alt></body></html>