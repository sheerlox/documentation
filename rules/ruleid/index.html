<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.85.0"><meta name=description content="CoreRuleSet Documentation"><meta name=author content="CoreRuleSet"><link rel=icon href=/documentation/images/favicon.png type=image/png><title>Rule IDs :: Core Rule Set Documentation</title><link href=/documentation/css/nucleus.css?1650296571 rel=stylesheet><link href=/documentation/css/fontawesome-all.min.css?1650296571 rel=stylesheet><link href=/documentation/css/featherlight.min.css?1650296571 rel=stylesheet><link href=/documentation/css/perfect-scrollbar.min.css?1650296571 rel=stylesheet><link href=/documentation/css/auto-complete.css?1650296571 rel=stylesheet><link href=/documentation/css/theme.css?1650296571 rel=stylesheet><link href=/documentation/css/theme-blue.css?1650296571 rel=stylesheet><link href=/documentation/css/variant.css?1650296571 rel=stylesheet><link href=/documentation/css/print.css?1650296571 rel=stylesheet media=print><script src=/documentation/js/jquery.min.js?1650296571></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/documentation/rules/ruleid/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://coreruleset.github.io/documentation/><img src=https://coreruleset.github.io/documentation//images/logo.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/documentation/js/lunr.min.js?1650296571></script><script src=/documentation/js/auto-complete.js?1650296571></script><script>var index_url="/documentation/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script><script src=/documentation/js/search.js?1650296571></script></div><div id=homelinks><ul><li><a class=padding href=/documentation/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/documentation/deployment/ title="Getting CRS" class=dd-item><a href=/documentation/deployment/><b>1. </b>Getting CRS<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/deployment/engine_integration_options/ title="Engine and Integration Options" class=dd-item><a href=/documentation/deployment/engine_integration_options/>Engine and Integration Options<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/quickstart/ title="OWASP CRS Quickstart" class=dd-item><a href=/documentation/deployment/quickstart/>Quickstart<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/install/ title="Installing CoreRuleSet" class=dd-item><a href=/documentation/deployment/install/>Extended Install<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/configuring/ title="How it Works" class=dd-item><a href=/documentation/configuring/><b>2. </b>How it Works<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/configuring/anomaly_scoring/ title="Anomaly Scoring" class=dd-item><a href=/documentation/configuring/anomaly_scoring/>Anomaly Scoring<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/paranoia_levels/ title="Paranoia Levels" class=dd-item><a href=/documentation/configuring/paranoia_levels/>Paranoia Levels<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/false_positives_tuning/ title="False Positives and Tuning" class=dd-item><a href=/documentation/configuring/false_positives_tuning/>False Positives and Tuning<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/plugins/ title="Plugin Mechanism" class=dd-item><a href=/documentation/configuring/plugins/>Plugin Mechanism<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/sampling_mode/ title="Sampling Mode" class=dd-item><a href=/documentation/configuring/sampling_mode/>Sampling Mode<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/configuring/crs/ title=Configuration class=dd-item><a href=/documentation/configuring/crs/>Configuration<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/operation/ title=Operation class=dd-item><a href=/documentation/operation/>Operation<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/operation/containers/ title="Using Containers" class=dd-item><a href=/documentation/operation/containers/>Using Containers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/log_handling/ title="Log Handling" class=dd-item><a href=/documentation/operation/log_handling/>Log Handling<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/rules/ title="Creating Rules" class="dd-item parent"><a href=/documentation/rules/><b>3. </b>Rules<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/rules/ruleid/ title="Rule IDs" class="dd-item active"><a href=/documentation/rules/ruleid/><b>1. </b>Rule IDs<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/testing/ title="Testing the Rule Set" class=dd-item><a href=/documentation/rules/testing/><b>2. </b>Testing<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/rules/ title=Rules class=dd-item><a href=/documentation/rules/rules/><b>3. </b>Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/creating/ title=Making class=dd-item><a href=/documentation/rules/creating/><b>9. </b>Making<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/metadata/ title=Metadata class=dd-item><a href=/documentation/rules/metadata/><b>10. </b>Metadata<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/development/ title=Development class=dd-item><a href=/documentation/development/><b>4. </b>Development<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/development/contribution_guidelines/ title="Contribution Guidelines" class=dd-item><a href=/documentation/development/contribution_guidelines/>Contribution Guidelines<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/useful_tools/ title="Useful Tools" class=dd-item><a href=/documentation/development/useful_tools/>Useful Tools<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/testing/ title="Testing the Rule Set" class=dd-item><a href=/documentation/development/testing/>Testing the Rule Set<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/plugin_writing/ title="Writing Plugins" class=dd-item><a href=/documentation/development/plugin_writing/>Writing Plugins<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/sandbox/ title="Using the CRS Sandbox" class=dd-item><a href=/documentation/development/sandbox/>Using the CRS Sandbox<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/resources/ title="Additional Resources" class=dd-item><a href=/documentation/resources/>Additional Resources<i class="fas fa-check read-icon"></i></a><ul></ul></li><li data-nav-id=/documentation/miscellaneous/ title=Miscellaneous class=dd-item><a href=/documentation/miscellaneous/>Miscellaneous<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/miscellaneous/self_contained_mode/ title="Self-Contained Mode" class=dd-item><a href=/documentation/miscellaneous/self_contained_mode/>Self-Contained Mode<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://coreruleset.org/><i class="fas fa-bookmark"></i> Core Rule Set Home</a></li><li><a class=padding href=https://github.com/coreruleset/coreruleset><i class="fab fa-github"></i> Core Rule Set GitHub</a></li></ul></div><div id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/coreruleset/documentation/blob/main/content/rules/ruleid.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Rule IDs</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#why-do-rule-ids-matter>Why do rule IDs matter?</a><ul><li><a href=#id-reservations>ID Reservations</a></li><li><a href=#ids-in-the-owasp-crs>IDs in the OWASP CRS</a></li><li><a href=#mapping-300-dev2x-ids-to-300-rc1-ids>Mapping 3.0.0-dev(2.x) IDs to 3.0.0-rc1 IDs</a></li></ul></li></ul></nav></div></div></div><div id=head-tags></div><main id=body-inner><h1>Rule IDs</h1><div class="notices note"><div class=label>Note</div><p><strong>The content on this page may be outdated.</strong> We are currently in the process of rewriting all of our documentation: please bear with us while we update our older content.</p></div><h2 id=why-do-rule-ids-matter>Why do rule IDs matter?</h2><p>Each rule added to a ModSecurity instance must have a unique ID (in
recent versions of modsec). As a result of this it is important that IDs
be generated in a preplanned way such that they don't overlap with
other rules. This becomes particularly important when it comes to
rulesets, like OWASP CRS. Because CRS can be used with other rule sets
(in fact it is designed to be used with the Trustwave commercial rules,
for instance) it is important that no two rulesets have overlapping ID
ranges. To aid in this process the project maintains a list of reserved
ID spaces. If you are planning on publishing rules or a ruleset please
reach out to security[ at ]modsecurity.org and we can reserve a range
of IDs for you thank you.</p><h3 id=id-reservations>ID Reservations</h3><ul><li>1-99,999; reserved for local (internal) use. Use as you see fit but
do not use this range for rules that are distributed to others.</li><li>100,000&ndash;199,999; reserved for rules published by Oracle.</li><li>200,000&ndash;299,999; reserved for rules published Comodo.</li><li>300,000-399,999; reserved for rules published at gotroot.com.</li><li>400,000&ndash;419,999; unused (available for reservation).</li><li>420,000-429,999; reserved for ScallyWhack .</li><li>430,000&ndash;439,999: reserved for rules published by Flameeyes</li><li>440,000-599,999; unused (available for reservation).</li><li>600,000-699,999; reserved for use by Akamai
<a href=https://www.akamai.com/products/web-application-protector>https://www.akamai.com/products/web-application-protector</a></li><li>700,000-799,999; reserved for Ivan Ristic.</li><li>900,000-999,999; reserved for the OWASP ModSecurity Core Rule Set
project.</li><li>1,000,000-1,009,999; reserved for rules published by Redhat Security
Team</li><li>1,010,000-1,999,999; unused (available for reservation)</li><li>2,000,000-2,999,999; reserved for rules from Trustwave's SpiderLabs
Research team</li><li>3,000,000-3,999,999; reserved for use by Akamai</li><li>4,000,000-4,099,999; reserved in use by AviNetworks</li><li>4,100,000-4,199,999; reserved in use by Fastly</li><li>4,200,000 and above; unused (available for reservation)</li></ul><h3 id=ids-in-the-owasp-crs>IDs in the OWASP CRS</h3><p>ID&rsquo;s within the OWASP Core Rule Set (CRS) have special meaning. Rules
are assigned an ID based on their location within the ruleset. As the
list above notes, the OWASP Core Rule Set is assigned ID&rsquo;s from 900,000
to 999,999. This means that each rule file in CRS 3.x has 1000 IDs
reserved for it. Currently, this is more than enough space, however, if
at some point this becomes a problem we&rsquo;ll cross that bridge when we
come to it. By design rules will always be separated by 10 IDs from the
ID before it. The first 10 ID&rsquo;s (000
010,020,030,040,050,060,070,080,090) are designated for control flow
related rules, that is typically rules that will trigger a skip action
(these will be at the beginning of a file or rules that pass). As a
result of this structure most rule files will start with ID
9[File_ID]100. As new rules are developed they should be added at the
end. If it becomes necessary to add a rule in-between existing rules
this must be noted in the comments.</p><h3 id=mapping-300-dev2x-ids-to-300-rc1-ids>Mapping 3.0.0-dev(2.x) IDs to 3.0.0-rc1 IDs</h3><p>When we started developing CRS 3 we started with our old ModSecurity 2.x
rules and used our experience to redesign the layout of the ruleset,
refine rules that were failing, and add new controls that were needed.
As a result of this in pre-release version of 3.x we ran into problems
where rule IDs were all of the place. Not only was this confusing but it
restricted the ability to do range based ID exclusions easily. As a
result we re-structured the rule ID's to what we see above.</p><p>However, this is problematic for people who have made exceptions based
on these existing rules. For these people we provide the following
table:</p><p>See <a href=data/IdNumbering.csv>2.x to 3.x Rule ID Transition Table</a>.</p><p>You can use the above file along with a script similar to the one below
to update exclusions or rule changes:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#75715e>#!/usr/bin/env python</span>
<span style=color:#75715e># -*- coding: utf-8 -*-</span>

<span style=color:#f92672>import</span> csv
<span style=color:#f92672>import</span> argparse
<span style=color:#f92672>import</span> os
<span style=color:#f92672>import</span> sys

idTranslationFile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;IdNumbering.csv&#34;</span>

<span style=color:#66d9ef>if</span>(<span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>isfile(idTranslationFile)):
    sys<span style=color:#f92672>.</span>stderr<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;We were unable to locate the ID translation CSV (idNumbering.csv) please place this is the same directory as this script</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
    sys<span style=color:#f92672>.</span>exit(<span style=color:#ae81ff>1</span>)
parser <span style=color:#f92672>=</span> argparse<span style=color:#f92672>.</span>ArgumentParser(description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;A program that takes in an exceptions file and renumbers all the ID to match OWASP CRS 3.0-rc1 numbers. Output will be directed to STDOUT and can be used to overwrite the file using &#39;&gt;&#39;&#34;</span>)
parser<span style=color:#f92672>.</span>add_argument(<span style=color:#e6db74>&#34;-f&#34;</span>, <span style=color:#e6db74>&#34;--file&#34;</span>, required<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>, action<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;store&#34;</span>, dest<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;fname&#34;</span>, help<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;the file to be renumbered&#34;</span>)
args <span style=color:#f92672>=</span> parser<span style=color:#f92672>.</span>parse_args()
<span style=color:#66d9ef>if</span>(<span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>isfile((args<span style=color:#f92672>.</span>fname)<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;utf8&#39;</span>))):
    sys<span style=color:#f92672>.</span>stderr<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;We were unable to find the file you were trying to upate the ID numbers in, please check your path</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
    sys<span style=color:#f92672>.</span>exit(<span style=color:#ae81ff>1</span>)
fcontent <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
<span style=color:#66d9ef>try</span>:
    f <span style=color:#f92672>=</span> open((args<span style=color:#f92672>.</span>fname)<span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;utf-8&#39;</span>), <span style=color:#e6db74>&#34;r&#34;</span>)
    <span style=color:#66d9ef>try</span>:
        fcontent <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
    <span style=color:#66d9ef>finally</span>:
        f<span style=color:#f92672>.</span>close()
<span style=color:#66d9ef>except</span> <span style=color:#a6e22e>IOError</span>:
    sys<span style=color:#f92672>.</span>stderr<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;There was an error opening the file you were trying to update&#34;</span>)

<span style=color:#66d9ef>if</span>(fcontent <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span>):
    <span style=color:#75715e># CSV File</span>
    f <span style=color:#f92672>=</span> open(idTranslationFile, <span style=color:#e6db74>&#39;rt&#39;</span>)
    <span style=color:#66d9ef>try</span>:
        reader <span style=color:#f92672>=</span> csv<span style=color:#f92672>.</span>reader(f)
        <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> reader:
            fcontent<span style=color:#f92672>.</span>replace(row[<span style=color:#ae81ff>0</span>], row[<span style=color:#ae81ff>1</span>])
    <span style=color:#66d9ef>finally</span>:
        f<span style=color:#f92672>.</span>close()

print fcontent
</code></pre></div><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/documentation/rules/ title="Creating Rules"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/documentation/rules/testing/ title="Testing the Rule Set"><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/documentation/js/clipboard.min.js?1650296571></script><script src=/documentation/js/perfect-scrollbar.min.js?1650296571></script><script src=/documentation/js/perfect-scrollbar.jquery.min.js?1650296571></script><script src=/documentation/js/jquery.svg.pan.zoom.js?1650296571></script><script src=/documentation/js/featherlight.min.js?1650296571></script><script src=/documentation/js/modernizr.custom-3.6.0.js?1650296571></script><script src=/documentation/js/mermaid.min.js?1650296571></script><script>typeof mermaid!='undefined'&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script><script src=/documentation/js/relearn.js?1650296571></script><script>var _paq=window._paq=window._paq||[];_paq.push(['trackPageView']),_paq.push(['enableLinkTracking']),function(){var b="https://piwik.netnea.com/matomo/",c,a,d;_paq.push(['setTrackerUrl',b+'matomo.php']),_paq.push(['setSiteId','4']),c=document,a=c.createElement('script'),d=c.getElementsByTagName('script')[0],a.async=!0,a.src=b+'matomo.js',d.parentNode.insertBefore(a,d)}()</script><img referrerpolicy=no-referrer-when-downgrade src="https://piwik.netnea.com/matomo/matomo.php?idsite=4&rec=1" style=border:0 alt></body></html>