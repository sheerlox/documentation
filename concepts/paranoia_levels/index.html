<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.97.3"><meta name=description content="CoreRuleSet Documentation"><meta name=author content="CoreRuleSet"><link rel=icon href=/documentation/images/favicon.png type=image/png><title>Paranoia Levels :: Core Rule Set Documentation</title><link href=/documentation/css/nucleus.css?1686841650 rel=stylesheet><link href=/documentation/css/fontawesome-all.min.css?1686841650 rel=stylesheet><link href=/documentation/css/featherlight.min.css?1686841650 rel=stylesheet><link href=/documentation/css/perfect-scrollbar.min.css?1686841650 rel=stylesheet><link href=/documentation/css/auto-complete.css?1686841650 rel=stylesheet><link href=/documentation/css/theme.css?1686841650 rel=stylesheet><link href=/documentation/css/theme-blue.css?1686841650 rel=stylesheet><link href=/documentation/css/variant.css?1686841650 rel=stylesheet><link href=/documentation/css/print.css?1686841650 rel=stylesheet media=print><script src=/documentation/js/jquery.min.js?1686841650></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/documentation/concepts/paranoia_levels/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://coreruleset.github.io/documentation/><img src=https://coreruleset.github.io/documentation//images/logo.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/documentation/js/lunr.min.js?1686841650></script>
<script src=/documentation/js/auto-complete.js?1686841650></script>
<script>var index_url="/documentation/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script><script src=/documentation/js/search.js?1686841650></script></div><div id=homelinks><ul><li><a class=padding href=/documentation/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/documentation/deployment/ title="Getting CRS" class=dd-item><a href=/documentation/deployment/><b>1. </b>Getting CRS<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/deployment/engine_integration_options/ title="Engine and Integration Options" class=dd-item><a href=/documentation/deployment/engine_integration_options/>Engine and Integration Options<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/quick_start/ title="Quick Start Guide" class=dd-item><a href=/documentation/deployment/quick_start/>Quick Start Guide<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/install/ title="Extended Install" class=dd-item><a href=/documentation/deployment/install/>Extended Install<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/concepts/ title="How CRS Works" class="dd-item parent"><a href=/documentation/concepts/><b>2. </b>How CRS Works<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/concepts/anomaly_scoring/ title="Anomaly Scoring" class=dd-item><a href=/documentation/concepts/anomaly_scoring/>Anomaly Scoring<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/paranoia_levels/ title="Paranoia Levels" class="dd-item active"><a href=/documentation/concepts/paranoia_levels/>Paranoia Levels<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/false_positives_tuning/ title="False Positives and Tuning" class=dd-item><a href=/documentation/concepts/false_positives_tuning/>False Positives and Tuning<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/plugins/ title="Plugin Mechanism" class=dd-item><a href=/documentation/concepts/plugins/>Plugin Mechanism<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/sampling_mode/ title="Sampling Mode" class=dd-item><a href=/documentation/concepts/sampling_mode/>Sampling Mode<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/operation/ title=Operation class=dd-item><a href=/documentation/operation/><b>3. </b>Operation<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/operation/known_issues/ title="Known Issues" class=dd-item><a href=/documentation/operation/known_issues/>Known Issues<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/containers/ title="Using Containers" class=dd-item><a href=/documentation/operation/containers/>Using Containers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/kubernetes_ingress/ title="Kubernetes Ingress Controllers" class=dd-item><a href=/documentation/operation/kubernetes_ingress/>Kubernetes Ingress Controllers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/log_handling/ title="Log Handling" class=dd-item><a href=/documentation/operation/log_handling/>Log Handling<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/rules/ title=Rules class=dd-item><a href=/documentation/rules/><b>4. </b>Rules<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/rules/ruleid/ title="Rule IDs" class=dd-item><a href=/documentation/rules/ruleid/>Rule IDs<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/rules/ title=Rules class=dd-item><a href=/documentation/rules/rules/>Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/creating/ title=Making class=dd-item><a href=/documentation/rules/creating/>Making<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/metadata/ title=Metadata class=dd-item><a href=/documentation/rules/metadata/>Metadata<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/development/ title=Development class=dd-item><a href=/documentation/development/><b>5. </b>Development<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/development/contribution_guidelines/ title="Contribution Guidelines" class=dd-item><a href=/documentation/development/contribution_guidelines/>Contribution Guidelines<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/crs_toolchain/ title=crs-toolchain class=dd-item><a href=/documentation/development/crs_toolchain/>crs-toolchain<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/regex_assembly/ title="Assembling Regular Expressions" class=dd-item><a href=/documentation/development/regex_assembly/>Assembling Regular Expressions<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/rule_writing/ title="Writing Rules" class=dd-item><a href=/documentation/development/rule_writing/>Writing Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/useful_tools/ title="Useful Tools" class=dd-item><a href=/documentation/development/useful_tools/>Useful Tools<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/testing/ title="Testing the Rule Set" class=dd-item><a href=/documentation/development/testing/>Testing the Rule Set<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/plugin_writing/ title="Writing Plugins" class=dd-item><a href=/documentation/development/plugin_writing/>Writing Plugins<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/sandbox/ title="Using the CRS Sandbox" class=dd-item><a href=/documentation/development/sandbox/>Using the CRS Sandbox<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/resources/ title="Additional Resources" class=dd-item><a href=/documentation/resources/><b>6. </b>Additional Resources<i class="fas fa-check read-icon"></i></a><ul></ul></li><li data-nav-id=/documentation/miscellaneous/ title=Miscellaneous class=dd-item><a href=/documentation/miscellaneous/><b>7. </b>Miscellaneous<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/miscellaneous/self_contained_mode/ title="Self-Contained Mode" class=dd-item><a href=/documentation/miscellaneous/self_contained_mode/>Self-Contained Mode<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://coreruleset.org/><i class="fas fa-bookmark"></i> Core Rule Set Home</a></li><li><a class=padding href=https://github.com/coreruleset/coreruleset><i class="fab fa-github"></i> Core Rule Set GitHub</a></li></ul></div><div id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/coreruleset/documentation/blob/main/content/concepts/paranoia_levels.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Paranoia Levels</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#introduction-to-paranoia-levels>Introduction to Paranoia Levels</a></li><li><a href=#description-of-the-four-paranoia-levels>Description of the Four Paranoia Levels</a></li><li><a href=#choosing-an-appropriate-paranoia-level>Choosing an Appropriate Paranoia Level</a></li><li><a href=#setting-the-paranoia-level>Setting the Paranoia Level</a></li><li><a href=#how-paranoia-levels-relate-to-anomaly-scoring>How Paranoia Levels Relate to Anomaly Scoring</a></li><li><a href=#moving-to-a-higher-paranoia-level>Moving to a Higher Paranoia Level</a><ul><li><a href=#introducing-the-executing-paranoia-level>Introducing the <em>Executing Paranoia Level</em></a></li></ul></li><li><a href=#moving-to-a-lower-paranoia-level>Moving to a Lower Paranoia Level</a></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></div></div></div><div id=head-tags></div><main id=body-inner><h1>Paranoia Levels</h1><blockquote><p>Paranoia levels are an essential concept when working with the Core Rule Set. This page explains the concept behind paranoia levels and how to work with them on a practical level.</p></blockquote><h2 id=introduction-to-paranoia-levels>Introduction to Paranoia Levels</h2><p><strong>The paranoia level (PL) makes it possible to define how aggressive the Core Rule Set is.</strong> Paranoia level 1 (PL 1) provides a set of rules that hardly ever trigger a false alarm (ideally never, but it can happen, depending on the local setup). PL 2 provides additional rules that detect more attacks (these rules operate <em>in addition</em> to the PL 1 rules), but there&rsquo;s a chance that the additional rules will also trigger new false alarms over perfectly legitimate HTTP requests.</p><p>This continues at PL 3, where more rules are added, namely for certain specialized attacks. This leads to even more false alarms. Then at PL 4, the rules are so aggressive that they detect almost every possible attack, yet they also flag a lot of legitimate traffic as malicious.</p><p><img src="https://coreruleset.org/docs/images/pl_onion_no_fonts.svg?width=25em" alt="Onion model diagram showing the four paranoia levels as ellipses. Each successive paranoia level is a superset of the previous one."></p><p>A higher paranoia level makes it harder for an attacker to go undetected. Yet this comes at the cost of more false positives: more false alarms. That&rsquo;s the downside to running a rule set that detects almost everything: your business / service / web application is also disrupted.</p><p>When false positives occur they need to be tuned away. In ModSecurity parlance: rule exclusions need to be written. A rule exclusion is a rule that disables another rule, either disabled completely or disabled partially only for certain parameters or for certain URIs. This means <strong>the rule set remains intact</strong> yet the CRS installation is no longer affected by the false positives.</p><div class="notices note"><div class=label>Note</div><p>Depending on the complexity of the service (web application) in question and on the paranoia level, the process of writing rule exclusions can be a <em>substantial</em> amount of work.</p><p>This page won&rsquo;t explore the problem of handling false positives further: for more information on this topic, see the appropriate chapter or refer to the <a href=https://www.netnea.com/cms/apache-tutorials/>tutorials at netnea.com</a>.</p></div><h2 id=description-of-the-four-paranoia-levels>Description of the Four Paranoia Levels</h2><p>The CRS project views the four paranoia levels as follows:</p><table><thead><tr><th>Paranoia Level</th><th>Description</th></tr></thead><tbody><tr><td><strong>1</strong></td><td>Baseline security with a minimal need to tune away false positives. This is CRS for everybody running an HTTP server on the internet. Please report any false positives encountered with a PL 1 system <a href=https://github.com/coreruleset/coreruleset/issues/new/choose>via GitHub</a>.</td></tr><tr><td><strong>2</strong></td><td>Rules that are adequate when real user data is involved. Perhaps an off-the-shelf online shop. Expect to encounter false positives and learn how to tune them away.</td></tr><tr><td><strong>3</strong></td><td>Online banking level security with lots of false positives. From a project perspective, false positives are accepted and expected here, so it&rsquo;s important to learn how to write rule exclusions.</td></tr><tr><td><strong>4</strong></td><td>Rules that are so strong (or paranoid) they&rsquo;re adequate to protect the &ldquo;crown jewels&rdquo;. To be used at one&rsquo;s own risk: be prepared to face a large number of false positives.</td></tr></tbody></table><h2 id=choosing-an-appropriate-paranoia-level>Choosing an Appropriate Paranoia Level</h2><p>It&rsquo;s important to think about a service&rsquo;s security requirements. The difference between protecting a personal website and the admin gateway controlling access to an enterprise’s Active Directory are very different. The paranoia level needs to be chosen accordingly, while also considering the resources (time) required to tune away false positives at higher paranoia levels.</p><p>Running at the highest paranoia level, PL 4, may seem appealing from a security standpoint, but <em>it could take many weeks to tune away the false positives encountered</em>. It is crucial to have enough time to fully deal with all false positives.</p><div class="notices warning"><div class=label>Warning</div><p>Failure to properly tune an installation runs the risk of exposing users to a vast number of false positives. This can lead to a poor user experience, and might ultimately lead to a decision to completely disable the Core Rule Set. As such, <strong>setting a high PL in blocking mode <em>without</em> adequate tuning to deal with false positives is very risky</strong>.</p></div><p>If working in an enterprise environment, consider developing an internal policy to map the risk levels and security needs of different assets to the minimum acceptable paranoia level to be used for them, for example:</p><ul><li><strong>Risk Class 0</strong>: No personal data involved → PL 1</li><li><strong>Risk Class 1</strong>: Personal data involved, e.g. names and addresses → PL 2</li><li><strong>Risk Class 2</strong>: Sensitive data involved, e.g. financial/banking data; highest risk class → PL 3</li></ul><h2 id=setting-the-paranoia-level>Setting the Paranoia Level</h2><p>If using a native Core Rule Set installation on a web application firewall, the paranoia level is defined by setting the variable <code>tx.paranoia_level</code> in the file <code>crs-setup.conf</code>. This is done in rule 900000, but technically the variable can be set in the Apache or Nginx configuration instead.</p><p>If running CRS where it has been integrated into a commercial product or CDN then support varies. Some vendors expose the PL setting in the GUI while other vendors require a custom rule to be written that sets <code>tx.paranoia_level</code>. Unfortunately, there are also vendors that don&rsquo;t allow the PL to be set at all. (The CRS project considers this to be an incomplete Core Rule Set integration, since paranoia levels are a defining feature of the Core Rule Set.)</p><h2 id=how-paranoia-levels-relate-to-anomaly-scoring>How Paranoia Levels Relate to Anomaly Scoring</h2><p>It&rsquo;s important to understand that paranoia levels and CRS anomaly scoring (the CRS anomaly threshold/limit) are <strong>two entirely different things with no direct connection</strong>. The paranoia level controls the number of rules that are enabled while the anomaly threshold defines how many rules can be triggered before a request is blocked.</p><p>At the conceptual level, these two ideas <em>could</em> be mixed if the goal was to create a particularly granular security concept. For example, saying &ldquo;we define the anomaly threshold to be 10, but we compensate for this by running at paranoia level 3, which we acknowledge brings more rule alerts and higher anomaly scores.&rdquo;</p><p>This is <em>technically</em> correct but it overlooks the fact that there are attack categories where CRS scores very low. For example, there is a plan to introduce a new rule to detect POP3 and IMAP injections: this will be a single rule, so, under normal circumstances, an IMAP injection would never score more than 5. Therefore, an installation running at an anomaly threshold of 10 could never block an IMAP injection, even if running at PL 3. In light of this, it&rsquo;s generally advised to <strong>keep things simple and separate</strong>: a CRS installation should aim for an anomaly threshold of 5 and a paranoia level as deemed appropriate.</p><h2 id=moving-to-a-higher-paranoia-level>Moving to a Higher Paranoia Level</h2><h3 id=introducing-the-executing-paranoia-level>Introducing the <em>Executing Paranoia Level</em></h3><p>Consider an example successful CRS installation: it operates at paranoia level 1, a handful of rule exclusions are in place to deal with false positives, and the inbound anomaly score threshold is set to 5 which blocks would-be attackers immediately. Things are running smoothly at paranoia level 1, but imagine that there&rsquo;s now a requirement to increase the level of security by raising the paranoia level to 2. Moving to PL 2 will <em>almost certainly</em> cause new false positives: given the strict anomaly score threshold of 5, these will likely cause legitimate users to be blocked.</p><p>There&rsquo;s a simple, but <strong>risky</strong>, way to raise the paranoia level of a working and tuned CRS installation: raise the anomaly score threshold for a period of time, in order to account for the additional false positives that are anticipated. Raising the anomaly score threshold will allow through attacks that would have been blocked previously. The idea of <em>decreasing</em> security in order to <em>improve</em> it is counter-intuitive, as well as being bad practice.</p><p>There is a better solution. First, think of the paranoia level as being the &ldquo;blocking paranoia level&rdquo;. The rules enabled in the blocking paranoia level count towards the anomaly score threshold, which is used to determine whether or not to block a given request. Now introduce an <em>additional</em> paranoia level: the &ldquo;executing paranoia level&rdquo;. By default, the executing paranoia level is automatically set to be equal to the blocking paranoia level. If, however, the executing paranoia level is set to be <em>higher</em> than the blocking paranoia level then the additional rules from the higher paranoia level are <em>executed</em> but will never count towards the anomaly score threshold used to make the blocking decision.</p><p><em>Example: Blocking paranoia level of 1 and executing paranoia level of 2</em></p><p><img src="https://coreruleset.org/assets/uploads/2021/10/executing-paranoia-level-1.png?width=25em" alt="Diagram showing a scenario where the blocking paranoia level and the executing paranoia level are different. The active and inactive paranoia levels are emphasized to explain the concept."></p><p><strong>The executing paranoia level allows rules from a higher paranoia level to be run, and potentially to trigger false positives, without increasing the probability of blocking legitimate users.</strong> Any new false positives can then be tuned away using rule exclusions. Once ready and with all the new rule exclusions in place, the blocking paranoia level can then be raised to match the executing paranoia level. This approach is a flexible and secure way to raise the paranoia level on a working production system <em>without</em> the risk of new false positives blocking users in error.</p><h2 id=moving-to-a-lower-paranoia-level>Moving to a Lower Paranoia Level</h2><p>It is always possible to lower the paranoia level in order to experience fewer false positives, or none at all. The way that the rule set is constructed, lowering the paranoia level <em>always</em> means fewer or no false positives; raising the paranoia level is <em>very likely</em> to introduce more false positives.</p><h2 id=further-reading>Further Reading</h2><p>For a slightly longer explanation of paranoia levels, please refer to <a href=https://coreruleset.org/20211028/working-with-paranoia-levels/>our blog post on the subject</a>. The blog post also discusses the pros and cons of dynamically setting the paranoia level on a per-request basis, firstly by geolocation (i.e. a lower PL for domestic traffic and a higher PL for non-domestic traffic) and secondly based on previous behavior (i.e. a user is dealt with at PL 1, but if they ever trigger a rule then they&rsquo;re handled at PL 2 for all future requests).</p><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/documentation/concepts/anomaly_scoring/ title="Anomaly Scoring"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/documentation/concepts/false_positives_tuning/ title="False Positives and Tuning"><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/documentation/js/clipboard.min.js?1686841650></script>
<script src=/documentation/js/perfect-scrollbar.min.js?1686841650></script>
<script src=/documentation/js/perfect-scrollbar.jquery.min.js?1686841650></script>
<script src=/documentation/js/jquery.svg.pan.zoom.js?1686841650></script>
<script src=/documentation/js/featherlight.min.js?1686841650></script>
<script src=/documentation/js/modernizr.custom-3.6.0.js?1686841650></script>
<script src=/documentation/js/mermaid.min.js?1686841650></script>
<script>typeof mermaid!="undefined"&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script><script src=/documentation/js/relearn.js?1686841650></script>
<script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="https://piwik.netnea.com/matomo/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","4"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><img referrerpolicy=no-referrer-when-downgrade src="https://piwik.netnea.com/matomo/matomo.php?idsite=4&rec=1" style=border:0 alt></body></html>