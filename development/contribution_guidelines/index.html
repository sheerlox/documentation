<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.97.3"><meta name=description content="CoreRuleSet Documentation"><meta name=author content="CoreRuleSet"><link rel=icon href=/documentation/images/favicon.png type=image/png><title>Contribution Guidelines :: Core Rule Set Documentation</title><link href=/documentation/css/nucleus.css?1685101457 rel=stylesheet><link href=/documentation/css/fontawesome-all.min.css?1685101457 rel=stylesheet><link href=/documentation/css/featherlight.min.css?1685101457 rel=stylesheet><link href=/documentation/css/perfect-scrollbar.min.css?1685101457 rel=stylesheet><link href=/documentation/css/auto-complete.css?1685101457 rel=stylesheet><link href=/documentation/css/theme.css?1685101457 rel=stylesheet><link href=/documentation/css/theme-blue.css?1685101457 rel=stylesheet><link href=/documentation/css/variant.css?1685101457 rel=stylesheet><link href=/documentation/css/print.css?1685101457 rel=stylesheet media=print><script src=/documentation/js/jquery.min.js?1685101457></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/documentation/development/contribution_guidelines/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://coreruleset.github.io/documentation/><img src=https://coreruleset.github.io/documentation//images/logo.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/documentation/js/lunr.min.js?1685101457></script>
<script src=/documentation/js/auto-complete.js?1685101457></script>
<script>var index_url="/documentation/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script><script src=/documentation/js/search.js?1685101457></script></div><div id=homelinks><ul><li><a class=padding href=/documentation/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/documentation/deployment/ title="Getting CRS" class=dd-item><a href=/documentation/deployment/><b>1. </b>Getting CRS<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/deployment/engine_integration_options/ title="Engine and Integration Options" class=dd-item><a href=/documentation/deployment/engine_integration_options/>Engine and Integration Options<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/quick_start/ title="Quick Start Guide" class=dd-item><a href=/documentation/deployment/quick_start/>Quick Start Guide<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/install/ title="Extended Install" class=dd-item><a href=/documentation/deployment/install/>Extended Install<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/concepts/ title="How CRS Works" class=dd-item><a href=/documentation/concepts/><b>2. </b>How CRS Works<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/concepts/anomaly_scoring/ title="Anomaly Scoring" class=dd-item><a href=/documentation/concepts/anomaly_scoring/>Anomaly Scoring<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/paranoia_levels/ title="Paranoia Levels" class=dd-item><a href=/documentation/concepts/paranoia_levels/>Paranoia Levels<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/false_positives_tuning/ title="False Positives and Tuning" class=dd-item><a href=/documentation/concepts/false_positives_tuning/>False Positives and Tuning<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/plugins/ title="Plugin Mechanism" class=dd-item><a href=/documentation/concepts/plugins/>Plugin Mechanism<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/sampling_mode/ title="Sampling Mode" class=dd-item><a href=/documentation/concepts/sampling_mode/>Sampling Mode<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/operation/ title=Operation class=dd-item><a href=/documentation/operation/><b>3. </b>Operation<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/operation/known_issues/ title="Known Issues" class=dd-item><a href=/documentation/operation/known_issues/>Known Issues<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/containers/ title="Using Containers" class=dd-item><a href=/documentation/operation/containers/>Using Containers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/kubernetes_ingress/ title="Kubernetes Ingress Controllers" class=dd-item><a href=/documentation/operation/kubernetes_ingress/>Kubernetes Ingress Controllers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/log_handling/ title="Log Handling" class=dd-item><a href=/documentation/operation/log_handling/>Log Handling<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/rules/ title=Rules class=dd-item><a href=/documentation/rules/><b>4. </b>Rules<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/rules/ruleid/ title="Rule IDs" class=dd-item><a href=/documentation/rules/ruleid/>Rule IDs<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/rules/ title=Rules class=dd-item><a href=/documentation/rules/rules/>Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/creating/ title=Making class=dd-item><a href=/documentation/rules/creating/>Making<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/metadata/ title=Metadata class=dd-item><a href=/documentation/rules/metadata/>Metadata<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/development/ title=Development class="dd-item parent"><a href=/documentation/development/><b>5. </b>Development<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/development/contribution_guidelines/ title="Contribution Guidelines" class="dd-item active"><a href=/documentation/development/contribution_guidelines/>Contribution Guidelines<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/crs_toolchain/ title=crs-toolchain class=dd-item><a href=/documentation/development/crs_toolchain/>crs-toolchain<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/regex_assembly/ title="Assembling Regular Expressions" class=dd-item><a href=/documentation/development/regex_assembly/>Assembling Regular Expressions<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/rule_writing/ title="Writing Rules" class=dd-item><a href=/documentation/development/rule_writing/>Writing Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/useful_tools/ title="Useful Tools" class=dd-item><a href=/documentation/development/useful_tools/>Useful Tools<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/testing/ title="Testing the Rule Set" class=dd-item><a href=/documentation/development/testing/>Testing the Rule Set<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/plugin_writing/ title="Writing Plugins" class=dd-item><a href=/documentation/development/plugin_writing/>Writing Plugins<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/sandbox/ title="Using the CRS Sandbox" class=dd-item><a href=/documentation/development/sandbox/>Using the CRS Sandbox<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/resources/ title="Additional Resources" class=dd-item><a href=/documentation/resources/><b>6. </b>Additional Resources<i class="fas fa-check read-icon"></i></a><ul></ul></li><li data-nav-id=/documentation/miscellaneous/ title=Miscellaneous class=dd-item><a href=/documentation/miscellaneous/><b>7. </b>Miscellaneous<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/miscellaneous/self_contained_mode/ title="Self-Contained Mode" class=dd-item><a href=/documentation/miscellaneous/self_contained_mode/>Self-Contained Mode<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://coreruleset.org/><i class="fas fa-bookmark"></i> Core Rule Set Home</a></li><li><a class=padding href=https://github.com/coreruleset/coreruleset><i class="fab fa-github"></i> Core Rule Set GitHub</a></li></ul></div><div id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/coreruleset/documentation/blob/main/content/development/contribution_guidelines.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Contribution Guidelines</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#getting-started-with-a-new-contribution>Getting Started with a New Contribution</a></li><li><a href=#making-changes>Making Changes</a></li><li><a href=#general-formatting-guidelines-for-rules-contributions>General Formatting Guidelines for Rules Contributions</a></li><li><a href=#variable-naming-conventions>Variable Naming Conventions</a></li><li><a href=#writing-regular-expressions>Writing Regular Expressions</a><ul><li><a href=#portable-backslash-representation>Portable Backslash Representation</a></li><li><a href=#forward-slash-representation>Forward Slash Representation</a></li><li><a href=#when-and-why-to-anchor-regular-expressions>When and Why to Anchor Regular Expressions</a></li><li><a href=#use-capture-groups-sparingly>Use Capture Groups Sparingly</a></li><li><a href=#lazy-matching>Lazy Matching</a></li><li><a href=#possessive-quantifiers-and-atomic-groups>Possessive Quantifiers and Atomic Groups</a></li><li><a href=#writing-regular-expressions-for-non-backtracking-compatibility>Writing Regular Expressions for Non-Backtracking Compatibility</a></li><li><a href=#when-and-how-to-optimize-regular-expressions>When and How to Optimize Regular Expressions</a></li></ul></li><li><a href=#rules-compliance-with-paranoia-levels>Rules Compliance with Paranoia Levels</a></li><li><a href=#id-numbering-scheme>ID Numbering Scheme</a><ul><li><a href=#stricter-siblings>Stricter Siblings</a></li></ul></li><li><a href=#writing-tests>Writing Tests</a><ul><li><a href=#positive-tests>Positive Tests</a></li><li><a href=#negative-tests>Negative Tests</a></li><li><a href=#encoded-and-raw-requests>Encoded and Raw Requests</a></li></ul></li><li><a href=#further-guidance-on-rule-writing>Further Guidance on Rule Writing</a><ul><li><a href=#leaving-audit-log-configuration-unchanged>Leaving Audit Log Configuration Unchanged</a></li></ul></li><li><a href=#non-rules-general-guidelines>Non-Rules General Guidelines</a></li></ul></nav></div></div></div><div id=head-tags></div><main id=body-inner><h1>Contribution Guidelines</h1><blockquote><p>The CRS project values third party contributions. To make the contribution process as easy as possible, a helpful set of contribution guidelines are in place which all contributors and developers are asked to adhere to.</p></blockquote><h2 id=getting-started-with-a-new-contribution>Getting Started with a New Contribution</h2><ol><li>Sign in to <a href=https://github.com/join>GitHub</a>.</li><li>Open a <a href=https://github.com/coreruleset/coreruleset/issues>new issue</a> for the contribution, <em>assuming a similar issue doesn&rsquo;t already exist</em>.<ul><li><strong>Clearly describe the issue</strong>, including steps to reproduce if reporting a bug.</li><li><strong>Specify the CRS version in question</strong> if reporting a bug.</li><li>Bonus points for submitting tests along with the issue.</li></ul></li><li>Fork the repository on GitHub and begin making changes there.</li><li>Signed commits are preferred. (For more information and help with this, refer to the <a href=https://docs.github.com/en/authentication/managing-commit-signature-verification/signing-commits>GitHub documentation</a>).</li></ol><h2 id=making-changes>Making Changes</h2><ul><li>Base any changes on the latest dev branch (e.g., <code>v4.0/dev</code>).</li><li>Create a topic branch for each new contribution.</li><li>Fix only one problem at a time. This helps to quickly test and merge submitted changes. If intending to fix <em>multiple unrelated problems</em> then use a separate branch for each problem.</li><li>Make commits of logical units.</li><li>Make sure commits adhere to the contribution guidelines presented in this document.</li><li>Make sure commit messages follow the <a href=http://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html>standard Git format</a>.</li><li>Make sure changes are submitted as a pull request (PR) on <a href=https://github.com/coreruleset/coreruleset/pulls>GitHub</a>.<ul><li>PR titles should follow the <a href=https://www.conventionalcommits.org/en/v1.0.0/>Conventional Commits format</a>, for example: <code>fix(rce): Fix a FP in rule 912345 with keyword 'time'</code>.</li><li>If a PR only affects a single rule then the rule ID should be included in the title.</li><li>If a PR title does not follow the correct format then a CRS developer will fix it.</li></ul></li></ul><h2 id=general-formatting-guidelines-for-rules-contributions>General Formatting Guidelines for Rules Contributions</h2><ul><li>American English should be used throughout.</li><li>4 spaces should be used for indentation (no tabs).</li><li>Files must end with a single newline character.</li><li>No trailing whitespace at EOL.</li><li>No trailing blank lines at EOF (only the required single EOF newline character is allowed).</li><li>Adhere to an 80 character line length limit where possible.</li><li>Add comments where possible and clearly explain any new rules.</li><li>Comments must not appear between chained rules and should instead be placed before the start of a rule chain.</li><li>All <a href=https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual(v2.x)#chain>chained rules</a> should be indented like so, for readability:</li></ul><pre tabindex=0><code>SecRule .. .. \
    &#34;...&#34;
    SecRule .. .. \
        &#34;...&#34;
        SecRule .. .. \
            &#34;...&#34;
</code></pre><ul><li>Action lists in rules must always be enclosed in double quotes for readability, even if there is only one action (e.g., use <code>"chain"</code> instead of <code>chain</code>, and <code>"ctl:requestBodyAccess=Off"</code> instead of <code>ctl:requestBodyAccess=Off</code>).</li><li>Always use numbers for phases instead of names.</li><li>Format all use of <code>SecMarker</code> using double quotes, using UPPERCASE, and separating words with hyphens. For example:</li></ul><pre tabindex=0><code>SecMarker &#34;END-RESPONSE-959-BLOCKING-EVALUATION&#34;
SecMarker &#34;END-REQUEST-910-IP-REPUTATION&#34;
</code></pre><ul><li>Rule actions should appear in the following order, for consistency:</li></ul><pre tabindex=0><code>id
phase
allow | block | deny | drop | pass | proxy | redirect
status
capture
t:xxx
log
nolog
auditlog
noauditlog
msg
logdata
tag
sanitiseArg
sanitiseRequestHeader
sanitiseMatched
sanitiseMatchedBytes
ctl
ver
severity
multiMatch
initcol
setenv
setvar
expirevar
chain
skip
skipAfter
</code></pre><ul><li>Rule operators must always be explicitly specified. Although ModSecurity defaults to using the <code>@rx</code> operator, for clarity <code>@rx</code> should always be explicitly specified when used. For example, write:</li></ul><pre tabindex=0><code>SecRule ARGS &#34;@rx foo&#34; &#34;id:1,phase:1,pass,t:none&#34;
</code></pre><p>instead of</p><pre tabindex=0><code>SecRule ARGS &#34;foo&#34; &#34;id:1,phase:1,pass,t:none&#34;
</code></pre><h2 id=variable-naming-conventions>Variable Naming Conventions</h2><ul><li>Variable names should be lowercase and should use the characters a-z, 0-9, and underscores only.</li><li>To reflect the different syntax between <em>defining</em> a variable (using <code>setvar</code>) and <em>using</em> a variable, the following visual distinction should be applied:<ul><li><strong>Variable definition:</strong> Lowercase letters for collection name, dot as the separator, variable name. E.g.: <code>setvar:tx.foo_bar_variable</code></li><li><strong>Variable use:</strong> Capital letters for collection name, colon as the separator, variable name. E.g.: <code>SecRule TX:foo_bar_variable</code></li></ul></li></ul><h2 id=writing-regular-expressions>Writing Regular Expressions</h2><ul><li>Use the following character class, in the stated order, to cover alphanumeric characters plus underscores and hyphens: <code>[a-zA-Z0-9_-]</code></li></ul><h3 id=portable-backslash-representation>Portable Backslash Representation</h3><p>CRS uses <code>\x5c</code> to represent the backslash <code>\</code> character in regular expressions. Some of the reasons for this are:</p><ul><li>It&rsquo;s portable across web servers and WAF engines: it works with Apache, Nginx, and Coraza.</li><li>It works with the <a href=/documentation/development/crs_toolchain/>crs-toolchain</a> for building optimized regular expressions.</li></ul><p>The older style of representing a backslash using the character class <code>[\\\\]</code> must <em>not</em> be used. This was previously used in CRS to get consistent results between Apache and Nginx, owing to a quirk with how Apache would &ldquo;double un-escape&rdquo; character escapes. For future reference, the decision was made to stop using this older method because:</p><ul><li>It can be confusing and difficult to understand how it works.</li><li>It doesn&rsquo;t work with <a href=/documentation/development/crs_toolchain/>crs-toolchain</a>.</li><li>It doesn&rsquo;t work with Coraza.</li><li>It isn&rsquo;t obvious how to use it in a character class, e.g., <code>[a-zA-Z&lt;portable-backslash>]</code>.</li></ul><h3 id=forward-slash-representation>Forward Slash Representation</h3><p>CRS uses literal, <em>unescaped</em> forward slash <code>/</code> characters in regular expressions.</p><p>Regular expression engines and libraries based on PCRE use the forward slash <code>/</code> character as the default delimiter. As such, forward slashes are often escaped in regular expression patterns. In the interests of readability, CRS does <em>not</em> escape forward slashes in regular expression patterns, which may seem unusual at first to new contributors.</p><p>If testing a CRS regular expression using a third party tool, it may be useful to change the delimiter to something other than <code>/</code> if a testing tool raises errors because a CRS pattern features unescaped forward slashes.</p><h3 id=when-and-why-to-anchor-regular-expressions>When and Why to Anchor Regular Expressions</h3><p>Engines running the OWASP Core Rule Set will use regular expressions to <em>search</em> the input string, i.e., the regular expression engine is asked to find the first match in the input string. If an expression needs to match the entire input then the expression must be anchored appropriately.</p><h4 id=beginning-of-string-anchor->Beginning of String Anchor (^)</h4><p>It is often necessary to match something at the start of the input to prevent false positives that match the same string in the middle of another argument, for example. Consider a scenario where the goal is to match the value of <code>REQUEST_HEADERS:Content-Type</code> to <code>multipart/form-data</code>. The following regular expression could be used:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;@rx multipart/form-data&#34;</span>
</span></span></code></pre></div><p>HTTP headers can contain multiple values, and it may be necessary to guarantee that the value being searched for is the <em>first</em> value of the header. There are different ways to do this but the simplest one is to use the <code>^</code> caret anchor to match the beginning of the string:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;@rx ^multipart/form-data&#34;</span>
</span></span></code></pre></div><p>It will also be useful to ignore case sensitivity in this scenario:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;@rx (?i)^multipart/form-data&#34;</span>
</span></span></code></pre></div><h4 id=end-of-string-anchor->End of String Anchor ($)</h4><p>Consider, for example, needing to find the string <code>/admin/content/assets/add/evil</code> in the <code>REQUEST_FILENAME</code>. This could be achieved with the following regular expression:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;@rx /admin/content/assets/add/evil&#34;</span>
</span></span></code></pre></div><p>If the input is changed, it can be seen that this expression can easily produce a false positive: <code>/admin/content/assets/add/evilbutactuallynot/nonevilfile</code>. If it is known that the file being searched for can&rsquo;t be in a subdirectory of <code>add</code> then the <code>$</code> anchor can be used to match the end of the input:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;@rx /admin/content/assets/add/evil$&#34;</span>
</span></span></code></pre></div><p>This could be made a bit more general:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;@rx /admin/content/assets/add/[a-z]+$&#34;</span>
</span></span></code></pre></div><h4 id=matching-the-entire-input-string>Matching the Entire Input String</h4><p>It is sometimes necessary to match the entire input string to ensure that it <em>exactly</em> matches what is expected. It might be necessary to find the &ldquo;edit&rdquo; action transmitted by WordPress, for example. To avoid false positives on variations (e.g., &ldquo;myedit&rdquo;, &ldquo;the edit&rdquo;, &ldquo;editable&rdquo;, etc.), the <code>^</code> caret and <code>$</code> dollar anchors can be used to indicate that an exact string is expected. For example, to only match the <em>exact</em> strings <code>edit</code> or <code>editpost</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;@rx ^(?:edit|editpost)$&#34;</span>
</span></span></code></pre></div><h4 id=other-anchors>Other Anchors</h4><p>Other anchors apart from <code>^</code> caret and <code>$</code> dollar exist, such as <code>\A</code>, <code>\G</code>, and <code>\Z</code> in PCRE. CRS <strong>strongly discourages</strong> the use of other anchors for the following reasons:</p><ul><li>Not all regular expression engines support all anchors and the OWASP Core Rule Set should be compatible with as many regular expression engines as possible.</li><li>Their function is sometimes not trivial.</li><li>They aren&rsquo;t well known and would require additional documentation.</li><li>In most cases that would justify their use the regular expression can be transformed into a form that doesn&rsquo;t require them, or the rule can be transformed (e.g., with an additional chain rule).</li></ul><h3 id=use-capture-groups-sparingly>Use Capture Groups Sparingly</h3><p>Capture groups, i.e., parts of the regular expression surrounded by parentheses (<code>(</code> and <code>)</code>), are used to store the matched information from a string in memory for later use. Capturing input uses both additional CPU cycles and additional memory. In many cases, parentheses are <em>mistakenly</em> used for grouping and ensuring precedence.</p><p>To group parts of a regular expression, or to ensure that the expression uses the precedence required, surround the concerning parts with <code>(?:</code> and <code>)</code>. Such a group is referred to as being &ldquo;non-capturing&rdquo;. The following will create a capture group:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;@rx a|(b|c)d&#34;</span>
</span></span></code></pre></div><p>On the other hand, this will create a <em>non-capturing</em> group, guaranteeing the precedence of the alternative <em>without</em> capturing the input:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;@rx a|(?:b|c)d&#34;</span>
</span></span></code></pre></div><h3 id=lazy-matching>Lazy Matching</h3><p>The question mark <code>?</code> can be used to turn &ldquo;greedy&rdquo; quantifiers into &ldquo;lazy&rdquo; quantifiers, i.e., <code>.+</code> and <code>.*</code> are greedy while <code>.+?</code> and <code>.*?</code> are lazy. Using lazy quantifiers can help with writing certain expressions that wouldn&rsquo;t otherwise be possible. However, in backtracking regular expression engines, like PCRE, lazy quantifiers can also be a source of performance issues. The following is an example of an expression that uses a lazy quantifier:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;@rx (?i)\.cookie</span><span style=color:#ae81ff>\b</span><span style=color:#e6db74>.*?;\W*?(?:expires|domain)\W*?=&#34;</span>
</span></span></code></pre></div><p>This expression matches cookie values in HTML to detect session fixation attacks. The input string could be <code>document.cookie = "name=evil; domain=https://example.com";</code>.</p><p>The lazy quantifiers in this expression are used to reduce the amount of backtracking that engines such as PCRE have to perform (others, such as RE2, are not affected by this). Since the asterisk <code>*</code> is greedy, <code>.*</code> would match every character in the input up to the end, at which point the regular expression engine would realize that the next character, <code>;</code>, can&rsquo;t be matched and it will backtrack to the previous position (<code>;</code>). A few iterations later, the engine will realize that the character <code>d</code> from <code>domain</code> can&rsquo;t be matched and it will backtrack again. This will happen again and again, until the <code>;</code> at <code>evil;</code> is found. Only then can the engine proceed with the next part of the expression.</p><p>Using lazy quantifiers, the regular expression engine will instead match <em>as few characters as possible</em>. The engine will match <code> </code> (a space), then look for <code>;</code> and will not find it. The match will then be expanded to <code> =</code> and, again, a match of <code>;</code> is attempted. This continues until the match is <code> = "name=evil</code> and the engine finds <code>;</code>. While lazy matching still includes some work, in this case, backtracking would require many more steps.</p><p>Lazy matching can have the inverse effect, though. Consider the following expression:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#e6db74>&#34;@rx (?i)</span><span style=color:#ae81ff>\b</span><span style=color:#e6db74>(?:s(?:tyle|rc)|href)</span><span style=color:#ae81ff>\b</span><span style=color:#e6db74>[\s\S]*?=&#34;</span>
</span></span></code></pre></div><p>It matches some HTML attributes and then expects to see <code>=</code>. Using a somewhat contrived input, the lazy quantifier will require more steps to match then the greedy version would: <code>style                     =</code>. With the lazy quantifier, the regular expression engine will expand the match by one character for each of the space characters in the input, which means 21 steps in this case. With the greedy quantifier, the engine would match up to the end in a single step, backtrack one character and then match <code>=</code> (note that <code>=</code> is included in <code>[\s\S]</code>), which makes 3 steps.</p><p>To summarize: <strong>be very mindful about when and why you use lazy quantifiers in your regular expressions</strong>.</p><h3 id=possessive-quantifiers-and-atomic-groups>Possessive Quantifiers and Atomic Groups</h3><p>Lazy and greedy matching change the order in which a regular expression engine processes a regular expression. However, the order of execution does not influence the backtracking behavior of backtracking engines.</p><p>Possessive quantifiers (e.g., <code>x++</code>) and atomic groups (e.g., <code>(?>x)</code>) are tools that can be used to prevent a backtracking engine from backtracking. They <em>can</em> be used for performance optimization but are only supported by backtracking engines and, therefore, are not permitted in CRS rules.</p><h3 id=writing-regular-expressions-for-non-backtracking-compatibility>Writing Regular Expressions for Non-Backtracking Compatibility</h3><p>Traditional regular expression engines use backtracking to solve some additional problems, such as finding a string that is preceded or followed by another string. While this functionality can certainly come in handy and has its place in certain applications, it can also lead to performance issues and, in uncontrolled environments, open up possibilities for attacks (the term &ldquo;<a href=https://en.wikipedia.org/wiki/ReDoS>ReDoS</a>&rdquo; is often used to describe an attack that exhausts process or system resources due to excessive backtracking).</p><p>The OWASP Core Rule Set tries to be compatible with non-backtracking regular expression engines, such as RE2, because:</p><ul><li>Non-backtracking engines are less vulnerable to ReDoS attacks.</li><li>Non-backtracking engines can often outperform backtracking engines.</li><li>CRS aims to leave the choice of the engine to the user/system.</li></ul><p>To ensure compatibility with non-backtracking regular expression engines, the following operations are <strong>not</strong> permitted in regular expressions:</p><ul><li>positive lookahead (e.g., <code>(?=regex)</code>)</li><li>negative lookahead (e.g., <code>(?!regex)</code>)</li><li>positive lookbehind (e.g., <code>(?&lt;=regex)</code>)</li><li>negative lookbehind (e.g., <code>(?&lt;!regex)</code>)</li><li>named capture groups (e.g., <code>(?P&lt;name>regex)</code>)</li><li>backreferences (e.g., <code>\1</code>)</li><li>named backreferences (e.g., <code>(?P=name)</code>)</li><li>conditionals (e.g., <code>(?(regex)then|else)</code>)</li><li>recursive calls to capture groups (e.g., <code>(?1)</code>)</li><li>possessive quantifiers (e.g., <code>(?:regex)++</code>)</li><li>atomic (or possessive) groups (e.g., <code>(?>regex</code>))</li></ul><p>This list is not exhaustive but covers the most important points. The <a href=https://github.com/google/re2/wiki/Syntax>RE2 documentation</a> includes a complete list of supported and unsupported features that various engines offer.</p><h3 id=when-and-how-to-optimize-regular-expressions>When and How to Optimize Regular Expressions</h3><p>Optimizing regular expressions is hard. Often, a change intended to improve the performance of a regular expression will change the original semantics by accident. In addition, optimizations usually make expressions harder to read. Consider the following example of URL schemes:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>mailto<span style=color:#f92672>|</span>mms<span style=color:#f92672>|</span>mumble<span style=color:#f92672>|</span>maven
</span></span></code></pre></div><p>An optimized version (produced by the <a href=/documentation/development/crs_toolchain/>crs-toolchain</a>) could look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>m(<span style=color:#960050;background-color:#1e0010>?</span>:a(<span style=color:#960050;background-color:#1e0010>?</span>:ilto<span style=color:#f92672>|</span>ven)<span style=color:#f92672>|</span>umble<span style=color:#f92672>|</span>ms)
</span></span></code></pre></div><p>The above expression is an optimization because it reduces the number of backtracking steps when a branch fails. The regular expressions in the CRS are often comprised of lists of tens or even hundreds of words. Reading such an expression in an optimized form is difficult: even the <em>simple</em> optimized example above is difficult to read.</p><p>In general, contributors should not try to optimize contributed regular expressions and should instead strive for clarity. New regular expressions will usually be required to be submitted as a <code>.data</code> file for the <a href=/documentation/development/crs_toolchain/>crs-toolchain</a> to process. In such a file, the regular expression is decomposed into individual parts, making manual optimizations much harder or even impossible (and unnecessary with the <code>crs-toolchain</code>). The <code>crs-toolchain</code> performs some common optimizations automatically, such as the one shown above.</p><p>Whether optimizations make sense in a contribution is assessed for each case individually.</p><h2 id=rules-compliance-with-paranoia-levels>Rules Compliance with Paranoia Levels</h2><p>The rules in CRS are organized into <strong>paranoia levels</strong> (PLs) which makes it possible to define how aggressive CRS is. See the documentation on <a href=https://coreruleset.org/docs/concepts/paranoia_levels/>paranoia levels</a> for an introduction and more detailed explanation.</p><p>Each rule that is placed into a paranoia level must contain the tag <code>paranoia-level/N</code>, where <em>N</em> is the PL value, however this tag can only be added if the rule does <strong>not</strong> use the nolog action.</p><p>The types of rules that are allowed at each paranoia level are as follows:</p><p><strong>PL 0:</strong></p><ul><li>ModSecurity / WAF engine installed, but almost no rules</li></ul><p><strong>PL 1:</strong></p><ul><li>Default level: keep in mind that most installations will normally use this level</li><li>Any complex, memory consuming evaluation rules will surely belong to a higher level, not this one</li><li>CRS will normally use atomic checks in single rules at this level</li><li>Confirmed matches only; all scores are allowed</li><li>No false positives / low false positives: try to avoid adding rules with potential false positives!</li><li>False negatives could happen</li></ul><p><strong>PL 2:</strong></p><ul><li><a href=https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#chain>Chain</a> usage is allowed</li><li>Confirmed matches use score critical</li><li>Matches that cause false positives are limited to using scores notice or warning</li><li>Low false positive rates</li><li>False negatives are not desirable</li></ul><p><strong>PL 3:</strong></p><ul><li>Chain usage with complex regular expression look arounds and macro expansions are allowed</li><li>Confirmed matches use scores warning or critical</li><li>Matches that cause false positives are limited to using score notice</li><li>False positive rates are higher but limited to multiple matches (not single strings)</li><li>False negatives should be a very unlikely accident</li></ul><p><strong>PL 4:</strong></p><ul><li>Every item is inspected</li><li>Variable creations are allowed to avoid engine limitations</li><li>Confirmed matches use scores notice, warning, or critical</li><li>Matches that cause false positives are limited to using scores notice or warning</li><li>False positive rates are higher (even on single strings)</li><li>False negatives should not happen at this level</li><li>Check everything against RFCs and allow listed values for the most popular elements</li></ul><h2 id=id-numbering-scheme>ID Numbering Scheme</h2><p>The CRS project uses the numerical ID rule namespace from 900,000 to 999,999 for CRS rules, as well as 9,000,000 to 9,999,999 for default CRS rule exclusion packages and plugins.</p><ul><li>Rules applying to the <strong>incoming request</strong> use the ID range 900,000 to 949,999.</li><li>Rules applying to the <strong>outgoing response</strong> use the ID range 950,000 to 999,999.</li></ul><p>The rules are grouped by the vulnerability class they address (SQLi, RCE, etc.) or the functionality they provide (e.g., initialization). These groups occupy blocks of thousands (e.g., SQLi: 942,000 - 942,999). These grouped rules are defined in files dedicated to a single group or functionality. The filename takes up the first three digits of the rule IDs defined within the file (e.g., SQLi: <code>REQUEST-942-APPLICATION-ATTACK-SQLI.conf</code>).</p><p>The individual rules within each file for a vulnerability class are organized by the paranoia level of the rules. PL 1 is first, then PL 2, etc.</p><p>The ID block 9xx000 - 9xx099 is reserved for use by CRS helper functionality. There are no blocking or filtering rules in this block.</p><p>Among the rules providing CRS helper functionality are rules that skip other rules depending on the paranoia level. These rules always use the following reserved rule IDs: 9xx011 - 9xx018, with very few exceptions.</p><p>The blocking and filter rules start at 9xx100 with a step width of 10, e.g., 9xx100, 9xx110, 9xx120, etc.</p><p>The ID of a rule does not correspond directly with its paranoia level. Given the size of rule groups and how they&rsquo;re organized by paranoia level (starting with the lower PL rules first), PL 2 and above tend to be composed of rules with higher ID numbers.</p><h3 id=stricter-siblings>Stricter Siblings</h3><p>Within a rule file / block, there are sometimes smaller groups of rules that belong together. They&rsquo;re closely linked and very often represent copies of the original rules with a stricter limit (alternatively, they can represent the same rule addressing a different <em>target</em> in a second rule, where this is necessary). These are <strong>stricter siblings</strong> of the base rule. Stricter siblings usually share the first five digits of the rule ID and raise the rule ID by one, e.g., a base rule at 9xx160 and a stricter sibling at 9xx161.</p><p>Stricter siblings often have different paranoia levels. This means that the base rule and the stricter siblings don&rsquo;t usually reside next to each another in the rule file. Instead, they&rsquo;re ordered by paranoia level and are linked by the first digits of their rule IDs. It&rsquo;s good practice to introduce all stricter siblings together as part of the definition of the base rule: this can be done in the comments of the base rule. It&rsquo;s also good practice to refer back to the base rule with the keywords &ldquo;stricter sibling&rdquo; in the comments of the stricter siblings themselves. For example: &ldquo;&mldr;This is performed in two separate stricter siblings of this rule: 9xxxx1 and 9xxxx2&rdquo;, and &ldquo;This is a stricter sibling of rule 9xxxx0.&rdquo;</p><h2 id=writing-tests>Writing Tests</h2><p>Each rule should be accompanied by tests. Rule tests are an invaluable way to check that a rule behaves as expected:</p><ul><li>Does the rule correctly match against the payloads and behaviors that the rule is designed to detect? (<strong>Positive tests</strong>)</li><li>Does the rule correctly <strong>not</strong> match against legitimate requests, i.e., the rule doesn&rsquo;t cause obvious false positives? (<strong>Negative tests</strong>)</li></ul><p>Rule tests also provide an excellent way to test WAF engines and implementations to ensure they behave and execute CRS rules as expected.</p><p>The rule tests are located under <code>tests/regression/tests</code>. Each CRS rule <em>file</em> has a corresponding <em>directory</em> and each individual <em>rule</em> has a corresponding <em>YAML file</em> containing all the tests for that rule. For example, the tests for rule 911100 <em>(Method is not allowed by policy)</em> are in the file <code>REQUEST-911-METHOD-ENFORCEMENT/911100.yaml</code>.</p><p>Full documentation of the required formatting and available options of the YAML tests can be found at <a href=https://github.com/coreruleset/ftw/blob/main/docs/YAMLFormat.md>https://github.com/coreruleset/ftw/blob/main/docs/YAMLFormat.md</a>.</p><h3 id=positive-tests>Positive Tests</h3><p>Example of a simple <em>positive test</em>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>test_title</span>: <span style=color:#ae81ff>932230-26</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>desc</span>: <span style=color:#e6db74>&#34;Unix command injection&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>stages</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>stage</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>input</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>dest_addr</span>: <span style=color:#ae81ff>127.0.0.1</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>headers</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>Host</span>: <span style=color:#ae81ff>localhost</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>User-Agent</span>: <span style=color:#e6db74>&#34;OWASP CRS test agent&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>Accept</span>: <span style=color:#ae81ff>text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>method</span>: <span style=color:#ae81ff>POST</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>port</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>uri</span>: <span style=color:#e6db74>&#34;/post&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>data</span>: <span style=color:#e6db74>&#34;var=` /bin/cat /etc/passwd`&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>version</span>: <span style=color:#ae81ff>HTTP/1.1</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>output</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>log_contains</span>: <span style=color:#ae81ff>id &#34;932230&#34;</span>
</span></span></code></pre></div><p>This test will succeed if the log output contains <code>id "932230"</code>, which would indicate that the rule in question matched and generated an alert.</p><p>It&rsquo;s important that tests consistently include the HTTP header fields <code>Host</code>, <code>User-Agent</code>, and <code>Accept</code>. CRS includes rules that detect if these headers are missing or empty, so these headers should be included in each test to avoid unnecessarily causing those rules to match. Ideally, <em>each positive test should cause</em> <strong>only</strong> <em>the rule in question to match</em>.</p><p>The rule&rsquo;s description field, <code>desc</code>, is important. It should describe what is being tested: what <em>should</em> match, what should <em>not</em> match, etc.</p><h3 id=negative-tests>Negative Tests</h3><p>Example of a simple <em>negative test</em>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>test_title</span>: <span style=color:#ae81ff>932260-4</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>stages</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>stage</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>input</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>dest_addr</span>: <span style=color:#e6db74>&#34;127.0.0.1&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>method</span>: <span style=color:#e6db74>&#34;POST&#34;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>port</span>: <span style=color:#ae81ff>80</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>headers</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>User-Agent</span>: <span style=color:#e6db74>&#34;OWASP CRS test agent&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>Host</span>: <span style=color:#e6db74>&#34;localhost&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>Accept</span>: <span style=color:#ae81ff>text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>data</span>: <span style=color:#e6db74>&#39;foo=ping pong tables&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>uri</span>: <span style=color:#e6db74>&#39;/post&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>output</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>no_log_contains</span>: <span style=color:#ae81ff>id &#34;932260&#34;</span>
</span></span></code></pre></div><p>This test will succeed if the log output does <strong>not</strong> contain <code>id "932260"</code>, which would indicate that the rule in question did <strong>not</strong> match and so did <strong>not</strong> generate an alert.</p><h3 id=encoded-and-raw-requests>Encoded and Raw Requests</h3><p>It is possible to <em>encode</em> an entire test request. This encapsulates the request and means that the request headers and payload don&rsquo;t need to be explicitly declared. This is useful when a test request needs to use unusual bytes which might break YAML parsers, or when a test request must be intentionally malformed in a way that is impossible to describe otherwise. An encoded request is sent exactly as intended.</p><p>The <code>encoded_request</code> field works like so:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>encoded_request</span>: <span style=color:#ae81ff>&lt;Base64 string&gt;</span>
</span></span></code></pre></div><p>For example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>encoded_request</span>: <span style=color:#e6db74>&#34;R0VUIFwgSFRUUA0KDQoK&#34;</span>
</span></span></code></pre></div><p>where <code>R0VUIFwgSFRUUA0KDQoK</code> is the base64-encoded equivalent of <code>GET \ HTTP\r\n\r\n</code>.</p><p>The older method of using <code>raw_request</code> is deprecated as it&rsquo;s difficult to maintain and less portable than <code>encoded_request</code>.</p><h2 id=further-guidance-on-rule-writing>Further Guidance on Rule Writing</h2><h3 id=leaving-audit-log-configuration-unchanged>Leaving Audit Log Configuration Unchanged</h3><p>Former versions of CRS dynamically included the HTTP response body in the audit log via special <code>ctl</code> statements on certain individual response rules. This was never applied in a systematic way and, regardless, CRS should not change the format of the audit log by itself, namely because this can lead to information leakages. Therefore, the use of <code>ctl:auditLogParts=+E</code> or any other form of <code>ctl:auditLogParts</code> is not allowed in CRS rules.</p><h2 id=non-rules-general-guidelines>Non-Rules General Guidelines</h2><ul><li>Remove trailing spaces from files (if they&rsquo;re not needed). This will make linters happy.</li><li>EOF should have an EOL.</li></ul><p>The <code>pre-commit</code> framework can be used to check for and fix these issues automatically. First, go to the <a href=https://pre-commit.com/>pre-commit</a> website and download the framework. Then, after installing, use the command <code>pre-commit install</code> so that the tools are installed and run each time a commit is made. CRS provides a config file that will keep the repository clean.</p><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/documentation/development/ title=Development><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/documentation/development/crs_toolchain/ title=crs-toolchain><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/documentation/js/clipboard.min.js?1685101457></script>
<script src=/documentation/js/perfect-scrollbar.min.js?1685101457></script>
<script src=/documentation/js/perfect-scrollbar.jquery.min.js?1685101457></script>
<script src=/documentation/js/jquery.svg.pan.zoom.js?1685101457></script>
<script src=/documentation/js/featherlight.min.js?1685101457></script>
<script src=/documentation/js/modernizr.custom-3.6.0.js?1685101457></script>
<script src=/documentation/js/mermaid.min.js?1685101457></script>
<script>typeof mermaid!="undefined"&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script><script src=/documentation/js/relearn.js?1685101457></script>
<script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="https://piwik.netnea.com/matomo/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","4"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><img referrerpolicy=no-referrer-when-downgrade src="https://piwik.netnea.com/matomo/matomo.php?idsite=4&rec=1" style=border:0 alt></body></html>