<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.97.3"><meta name=description content="CoreRuleSet Documentation"><meta name=author content="CoreRuleSet"><link rel=icon href=/documentation/images/favicon.png type=image/png><title>Testing the Rule Set :: Core Rule Set Documentation</title><link href=/documentation/css/nucleus.css?1703090007 rel=stylesheet><link href=/documentation/css/fontawesome-all.min.css?1703090007 rel=stylesheet><link href=/documentation/css/featherlight.min.css?1703090007 rel=stylesheet><link href=/documentation/css/perfect-scrollbar.min.css?1703090007 rel=stylesheet><link href=/documentation/css/auto-complete.css?1703090007 rel=stylesheet><link href=/documentation/css/theme.css?1703090007 rel=stylesheet><link href=/documentation/css/theme-blue.css?1703090007 rel=stylesheet><link href=/documentation/css/variant.css?1703090007 rel=stylesheet><link href=/documentation/css/print.css?1703090007 rel=stylesheet media=print><script src=/documentation/js/jquery.min.js?1703090007></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/documentation/development/testing/><nav id=sidebar class=showVisitedLinks><div id=header-wrapper><div id=header><a id=logo href=https://coreruleset.github.io/documentation/><img src=https://coreruleset.github.io/documentation//images/logo.png></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script src=/documentation/js/lunr.min.js?1703090007></script>
<script src=/documentation/js/auto-complete.js?1703090007></script>
<script>var index_url="/documentation/index.json",root_url="/",baseUri=root_url.replace(/\/$/,'')</script><script src=/documentation/js/search.js?1703090007></script></div><div id=homelinks><ul><li><a class=padding href=/documentation/><i class="fas fa-home"></i> Home</a></li></ul></div><div class=highlightable><ul class=topics><li data-nav-id=/documentation/deployment/ title="Getting CRS" class=dd-item><a href=/documentation/deployment/><b>1. </b>Getting CRS<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/deployment/engine_integration_options/ title="Engine and Integration Options" class=dd-item><a href=/documentation/deployment/engine_integration_options/>Engine and Integration Options<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/quick_start/ title="Quick Start Guide" class=dd-item><a href=/documentation/deployment/quick_start/>Quick Start Guide<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/deployment/install/ title="Extended Install" class=dd-item><a href=/documentation/deployment/install/>Extended Install<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/concepts/ title="How CRS Works" class=dd-item><a href=/documentation/concepts/><b>2. </b>How CRS Works<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/concepts/anomaly_scoring/ title="Anomaly Scoring" class=dd-item><a href=/documentation/concepts/anomaly_scoring/>Anomaly Scoring<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/paranoia_levels/ title="Paranoia Levels" class=dd-item><a href=/documentation/concepts/paranoia_levels/>Paranoia Levels<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/false_positives_tuning/ title="False Positives and Tuning" class=dd-item><a href=/documentation/concepts/false_positives_tuning/>False Positives and Tuning<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/plugins/ title="Plugin Mechanism" class=dd-item><a href=/documentation/concepts/plugins/>Plugin Mechanism<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/concepts/sampling_mode/ title="Sampling Mode" class=dd-item><a href=/documentation/concepts/sampling_mode/>Sampling Mode<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/operation/ title=Operation class=dd-item><a href=/documentation/operation/><b>3. </b>Operation<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/operation/known_issues/ title="Known Issues" class=dd-item><a href=/documentation/operation/known_issues/>Known Issues<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/containers/ title="Using Containers" class=dd-item><a href=/documentation/operation/containers/>Using Containers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/kubernetes_ingress/ title="Kubernetes Ingress Controllers" class=dd-item><a href=/documentation/operation/kubernetes_ingress/>Kubernetes Ingress Controllers<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/operation/log_handling/ title="Log Handling" class=dd-item><a href=/documentation/operation/log_handling/>Log Handling<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/rules/ title=Rules class=dd-item><a href=/documentation/rules/><b>4. </b>Rules<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/rules/ruleid/ title="Rule IDs" class=dd-item><a href=/documentation/rules/ruleid/>Rule IDs<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/rules/ title=Rules class=dd-item><a href=/documentation/rules/rules/>Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/creating/ title=Making class=dd-item><a href=/documentation/rules/creating/>Making<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/rules/metadata/ title=Metadata class=dd-item><a href=/documentation/rules/metadata/>Metadata<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/development/ title=Development class="dd-item parent"><a href=/documentation/development/><b>5. </b>Development<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/development/contribution_guidelines/ title="Contribution Guidelines" class=dd-item><a href=/documentation/development/contribution_guidelines/>Contribution Guidelines<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/crs_toolchain/ title=crs-toolchain class=dd-item><a href=/documentation/development/crs_toolchain/>crs-toolchain<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/regex_assembly/ title="Assembling Regular Expressions" class=dd-item><a href=/documentation/development/regex_assembly/>Assembling Regular Expressions<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/rule_writing/ title="Writing Rules" class=dd-item><a href=/documentation/development/rule_writing/>Writing Rules<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/useful_tools/ title="Useful Tools" class=dd-item><a href=/documentation/development/useful_tools/>Useful Tools<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/testing/ title="Testing the Rule Set" class="dd-item active"><a href=/documentation/development/testing/>Testing the Rule Set<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/plugin_writing/ title="Writing Plugins" class=dd-item><a href=/documentation/development/plugin_writing/>Writing Plugins<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/documentation/development/sandbox/ title="Using the CRS Sandbox" class=dd-item><a href=/documentation/development/sandbox/>Using the CRS Sandbox<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/documentation/resources/ title="Additional Resources" class=dd-item><a href=/documentation/resources/><b>6. </b>Additional Resources<i class="fas fa-check read-icon"></i></a><ul></ul></li><li data-nav-id=/documentation/miscellaneous/ title=Miscellaneous class=dd-item><a href=/documentation/miscellaneous/><b>7. </b>Miscellaneous<i class="fas fa-check read-icon"></i></a><ul><li data-nav-id=/documentation/miscellaneous/self_contained_mode/ title="Self-Contained Mode" class=dd-item><a href=/documentation/miscellaneous/self_contained_mode/>Self-Contained Mode<i class="fas fa-check read-icon"></i></a></li></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://coreruleset.org/><i class="fas fa-bookmark"></i> Core Rule Set Home</a></li><li><a class=padding href=https://github.com/coreruleset/coreruleset><i class="fab fa-github"></i> Core Rule Set GitHub</a></li></ul></div><div id=prefooter><hr><ul><li><a class=padding href=# data-clear-history-toggle><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></nav><div id=body><div id=overlay></div><div class="padding highlightable"><div id=top-bar><div id=top-github-link><a class=github-link title="Edit this page" href=https://github.com/coreruleset/documentation/blob/main/content/development/testing.md target=blank><i class="fas fa-code-branch"></i>
<span id=top-github-link-text>Edit this page</span></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Testing the Rule Set</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#environments>Environments</a><ul><li><a href=#setting-up-docker-containers>Setting up Docker containers</a></li><li><a href=#use-own-env>Using your own environment for testing</a></li><li><a href=#modify-webservers-config>Modify webserver&rsquo;s config</a></li></ul></li><li><a href=#go-ftw>Go-ftw</a><ul><li><a href=#running-the-test-suite>Running the test suite</a></li></ul></li><li><a href=#ftw-deprecated>FTW (deprecated)</a><ul><li><a href=#setting-up-the-basic-environment>Setting up the basic environment</a></li><li><a href=#running-the-test-suite-1>Running the test suite</a></li></ul></li><li><a href=#additional-tips>Additional tips</a></li><li><a href=#summary>Summary</a></li></ul></nav></div></div></div><div id=head-tags></div><main id=body-inner><h1>Testing the Rule Set</h1><h1 id=testing-for-rule-developers>Testing for rule developers</h1><p>Well, you managed to write your rule, but now want to see if if can be added to the CRS? This document should help you to test it using the same tooling the project uses for its tests.</p><p>CRS uses <a href=https://github.com/coreruleset/go-ftw>go-ftw</a> to run test cases. <strong>go-ftw</strong> is the successor to the previously used test runner <a href=https://github.com/coreruleset/ftw>ftw</a>. The CRS project no longer uses <strong>ftw</strong> but it us still useful for running tests of older CRS versions.</p><h2 id=environments>Environments</h2><p>Before you start to run tests, you should set up your environment. You can use Docker to run a web server with CRS integration or use your existing environment.</p><h3 id=setting-up-docker-containers>Setting up Docker containers</h3><p>For testing, we use the <a href=https://github.com/coreruleset/modsecurity-crs-docker>container images from our project</a>. We &ldquo;bind mount&rdquo; the rules in the CRS Git repository to the web server container and then instruct <strong>go-ftw</strong> to send requests to it.</p><p>To test we need two containers: the WAF itself, and a backend, provided in this case by the <a href=http://httpbin.org>http://httpbin.org</a> project. The <code>docker-compose.yml</code> in the CRS Git repository is a ready-to-run configuration for testing, to be used with the <code>docker compose</code> command.</p><p>-> The supported platform is ModSecurity 2 with Apache httpd</p><p>Let&rsquo;s start the containers by executing the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ docker compose -f tests/docker-compose.yml up -d modsec2-apache
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Creating network <span style=color:#e6db74>&#34;tests_default&#34;</span> with the default driver
</span></span><span style=display:flex><span>Creating tests_backend_1 ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>Creating modsec2-apache  ... <span style=color:#66d9ef>done</span>
</span></span><span style=display:flex><span>‚ùØ docker ps
</span></span><span style=display:flex><span>CONTAINER ID   IMAGE                              COMMAND                  CREATED          STATUS         PORTS                               NAMES
</span></span><span style=display:flex><span>785a6f6a3cb6   owasp/modsecurity-crs:3.3-apache   <span style=color:#e6db74>&#34;/docker-entrypoint.‚Ä¶&#34;</span>   <span style=color:#ae81ff>7</span> seconds ago    Up <span style=color:#ae81ff>3</span> seconds   0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   modsec2-apache
</span></span><span style=display:flex><span>bb8d5a7f256d   kennethreitz/httpbin               <span style=color:#e6db74>&#34;gunicorn -b 0.0.0.0‚Ä¶&#34;</span>   <span style=color:#ae81ff>10</span> seconds ago   Up <span style=color:#ae81ff>7</span> seconds   80/tcp                              tests_backend_1
</span></span></code></pre></div><p>Excellent, our containers are running, now we can start our tests.</p><h3 id=use-own-env>Using your own environment for testing</h3><p>If you have your own environment set up, you can configure that for testing. Please <a href=/documentation/deployment/install/>follow these instructions</a> to install the WAF server locally.</p><p>-> The supported platform is ModSecurity 2 with Apache httpd. If you want to run the tests against nginx, you can do that too, but nginx uses libmodsecurity3, which is not fully compatible with Apache httpd + ModSecurity 2.</p><p>If you want to run the complete test suite of CRS 4.0 with <strong>go-ftw</strong>, you need to make some modifications to your setup. This is because the test cases for 4.0 contain some extra data for responses, letting us test the <code>RESPONSE-*</code> rules too. Without the following steps these tests will fail.</p><p>To enable response handling for tests you will need the following additional packages: <code>python3-gunicorn</code>, <code>gunicorn</code> and <code>python3-httpbin</code>.</p><h4 id=start-httpbin>Start <code>httpbin</code></h4><p><a href=https://httpbin.org/><code>httpbin</code></a> is a simple HTTP request & response service. You send a request, and it sends it back in the response.</p><p>You can start <code>httpbin</code> with this command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/usr/bin/python3 /usr/bin/gunicorn --error-logfile - --access-logfile - --access-logformat <span style=color:#e6db74>&#34;%(h)s %(t)s %(r)s %(s)s Content-Type: %({Content-Type}i)s&#34;</span> httpbin:app
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-12-14 15:59:53 +0100<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>4012<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Starting gunicorn 20.1.0
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-12-14 15:59:53 +0100<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>4012<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Listening at: http://127.0.0.1:8000 <span style=color:#f92672>(</span>4012<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-12-14 15:59:53 +0100<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>4012<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Using worker: sync
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>2023-12-14 15:59:53 +0100<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>4013<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>INFO<span style=color:#f92672>]</span> Booting worker with pid: <span style=color:#ae81ff>4013</span>
</span></span></code></pre></div><p>As you can see the HTTP server listens on 127.0.0.1:8000, you can check it:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;foo&#34;:&#34;bar&#34;}&#39;</span> <span style=color:#e6db74>&#34;http://localhost:8000/anything&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;args&#34;</span>: <span style=color:#f92672>{}</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;data&#34;</span>: <span style=color:#e6db74>&#34;{\&#34;foo\&#34;:\&#34;bar\&#34;}&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;files&#34;</span>: <span style=color:#f92672>{}</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;form&#34;</span>: <span style=color:#f92672>{}</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;headers&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Accept&#34;</span>: <span style=color:#e6db74>&#34;*/*&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Content-Length&#34;</span>: <span style=color:#e6db74>&#34;13&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Content-Type&#34;</span>: <span style=color:#e6db74>&#34;application/json&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;Host&#34;</span>: <span style=color:#e6db74>&#34;localhost:8000&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;User-Agent&#34;</span>: <span style=color:#e6db74>&#34;curl/8.4.0&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;json&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;foo&#34;</span>: <span style=color:#e6db74>&#34;bar&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;method&#34;</span>: <span style=color:#e6db74>&#34;POST&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;origin&#34;</span>: <span style=color:#e6db74>&#34;127.0.0.1&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;url&#34;</span>: <span style=color:#e6db74>&#34;http://localhost:8000/anything&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>As you can see, the response&rsquo;s <code>data</code> field contains your request data. This feature is mandatory for testing response rules.</p><h3 id=modify-webservers-config>Modify webserver&rsquo;s config</h3><p>For the response tests you need to set up your web server as a proxy, forwarding the requests to <code>httpbin</code>. The following is an example of such a proxy setup.</p><p><strong>Before you start to change your configurations, please make a backup!</strong></p><h4 id=apache-httpd>Apache httpd</h4><p>Put this snippet into your httpd&rsquo;s default config (eg. <code>/etc/apache2/sites-enabled/000-default.conf</code>):</p><pre tabindex=0><code>        ProxyPreserveHost On
        ProxyPass / http://127.0.0.1:8000/
        ProxyPassReverse / http://127.0.0.1:8000/
        ServerName localhost
</code></pre><h4 id=nginx>nginx</h4><p>Put this snippet into the nginx default config (e.g., <code>/etc/nginx/conf.d/default.conf</code>) or replace the existing one:</p><pre tabindex=0><code>        location / {

                proxy_pass http://127.0.0.1:8000/;
                proxy_set_header Host $host;
                proxy_set_header Proxy &#34;&#34;;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header X-Forwarded-Port $server_port;
                proxy_set_header X-Forwarded-Proto $scheme;

                proxy_http_version 1.1;
                proxy_buffering off;
                proxy_connect_timeout 60s;
                proxy_read_timeout 36000s;
                proxy_redirect off;

                proxy_pass_header Authorization;
        }
</code></pre><p>In both cases (Apache httpd, nginx) you have to change your <code>modsecurity.conf</code> settings. Open that file and find the directive <code>SecResponseBodyMimeType</code>. Modify the arguments:</p><pre tabindex=0><code>SecResponseBodyMimeType text/plain text/html text/xml application/json
</code></pre><p>Note, that the default value does not have the MIME type <code>application/json</code>.</p><p>In your <code>crs-setup.conf</code> you need to add these extra rules (after the rule <code>900990</code>):</p><pre tabindex=0><code>SecAction
    &#34;id:900005,\
    phase:1,\
    nolog,\
    pass,\
    ctl:ruleEngine=DetectionOnly,\
    ctl:ruleRemoveById=910000,\
    setvar:tx.blocking_paranoia_level=4,\
    setvar:tx.crs_validate_utf8_encoding=1,\
    setvar:tx.arg_name_length=100,\
    setvar:tx.arg_length=400,\
    setvar:tx.max_file_size=64100,\
    setvar:tx.combined_file_sizes=65535&#34;

SecRule REQUEST_HEADERS:X-CRS-Test &#34;@rx ^.*$&#34; \
    &#34;id:999999,\
    phase:1,\
    pass,\
    t:none,\
    log,\
    msg:&#39;%{MATCHED_VAR}&#39;&#34;
</code></pre><p>Now, after restarting the web server all request will be sent to <code>httpbin</code>. Let&rsquo;s start testing.</p><h2 id=go-ftw>Go-ftw</h2><p>Tests are performed using <a href=https://github.com/coreruleset/go-ftw>go-ftw</a>. We run our test suite automatically using <strong>go-ftw</strong> as part of a <a href=https://github.com/coreruleset/coreruleset/blob/v4.0/dev/.github/workflows/test.yml>GitHub workflow</a>. You can easily reproduce that locally, on your workstation.</p><p>For that you will need:</p><ul><li>the CRS Git repository</li><li>Docker (modern versions of docker already include the <code>compose</code> command, if you are running an older version you also need to have <code>docker-compose</code> installed)
OR
<a href=#use-own-env>your own environment</a></li><li>your rules and tests!</li></ul><p>You can download pre-compiled binaries of <strong>go-ftw</strong> or build from source (requires you to have a <strong>Go</strong> environment). The pre-compiled binaries are available <a href=https://github.com/coreruleset/go-ftw/releases>on GitHub</a>. The binaries are ready to run and do not require installation.</p><p>You can also install pre-compiled binaries by using <code>go install</code>, if you have a <strong>Go</strong> environment:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ go install github.com/coreruleset/go-ftw@latest
</span></span></code></pre></div><p>This will install the binary into your <code>$HOME/go/bin</code> directory. To compile <strong>go-ftw</strong> from source, run the following commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git clone https://github.com/coreruleset/go-ftw.git
</span></span><span style=display:flex><span>$ cd go-ftw
</span></span><span style=display:flex><span>$ go build
</span></span></code></pre></div><p>This will build the binary in the <strong>go-ftw</strong> repository.</p><p>Now create a configuration file. Because Apache httpd and nginx use different log file paths, and, perhaps, different ports, you may want to create two different configuration files for <strong>go-ftw</strong>. For details please read <a href=https://github.com/coreruleset/go-ftw#yaml-config-file>go-ftw&rsquo;s documentation</a>.</p><p>Example for nginx:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat .ftw.nginx.yaml
</span></span><span style=display:flex><span>logfile: /var/log/nginx/error.log
</span></span><span style=display:flex><span>logmarkerheadername: X-CRS-TEST
</span></span><span style=display:flex><span>testoverride:
</span></span><span style=display:flex><span>  input:
</span></span><span style=display:flex><span>    dest_addr: <span style=color:#e6db74>&#34;127.0.0.1&#34;</span>
</span></span><span style=display:flex><span>    port: <span style=color:#ae81ff>8080</span>
</span></span></code></pre></div><p>Example for Apache httpd:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat .ftw.apache.yaml
</span></span><span style=display:flex><span>logfile: /var/log/apache2/error.log
</span></span><span style=display:flex><span>logmarkerheadername: X-CRS-TEST
</span></span><span style=display:flex><span>testoverride:
</span></span><span style=display:flex><span>  input:
</span></span><span style=display:flex><span>    dest_addr: <span style=color:#e6db74>&#34;127.0.0.1&#34;</span>
</span></span><span style=display:flex><span>    port: <span style=color:#ae81ff>80</span>
</span></span></code></pre></div><p>Please verify that these settings are correct for your setup, especially the <code>port</code> values.</p><h3 id=running-the-test-suite>Running the test suite</h3><p>Execute the following command to run the CRS test suite with <strong>go-ftw</strong> against Apache httpd:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./go-ftw run --config .ftw.apache.yaml -d ../coreruleset/tests/regression/tests/
</span></span><span style=display:flex><span>üõ†Ô∏è  Starting tests!
</span></span><span style=display:flex><span>üöÄ Running go-ftw!
</span></span><span style=display:flex><span>üëâ executing tests in file 911100.yaml
</span></span><span style=display:flex><span>	running 911100-1: ‚úî passed in 239.699575ms <span style=color:#f92672>(</span>RTT 126.721984ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-2: ‚úî passed in 63.339213ms <span style=color:#f92672>(</span>RTT 69.998361ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-3: ‚úî passed in 64.87875ms <span style=color:#f92672>(</span>RTT 71.368241ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-4: ‚úî passed in 77.823772ms <span style=color:#f92672>(</span>RTT 81.059904ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-5: ‚úî passed in 64.451749ms <span style=color:#f92672>(</span>RTT 70.403898ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-6: ‚úî passed in 67.774327ms <span style=color:#f92672>(</span>RTT 73.803885ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-7: ‚úî passed in 65.528094ms <span style=color:#f92672>(</span>RTT 72.64316ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-8: ‚úî passed in 66.129563ms <span style=color:#f92672>(</span>RTT 73.198992ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>üëâ executing tests in file 913100.yaml
</span></span><span style=display:flex><span>	running 913100-1: ‚úî passed in 71.242549ms <span style=color:#f92672>(</span>RTT 76.803619ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 913100-2: ‚úî passed in 69.999667ms <span style=color:#f92672>(</span>RTT 76.617714ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 913100-3: ‚úî passed in 70.200211ms <span style=color:#f92672>(</span>RTT 76.92281ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 913100-4: ‚úî passed in 65.856005ms <span style=color:#f92672>(</span>RTT 73.328341ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 913100-5: ‚úî passed in 66.986859ms <span style=color:#f92672>(</span>RTT 73.494356ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  ...
</span></span></code></pre></div><p>To run the test suite against nginx, execute the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./go-ftw run --config .ftw.nginx.yaml -d ../coreruleset/tests/regression/tests/
</span></span><span style=display:flex><span>üõ†Ô∏è  Starting tests!
</span></span><span style=display:flex><span>üöÄ Running go-ftw!
</span></span><span style=display:flex><span>üëâ executing tests in file 911100.yaml
</span></span><span style=display:flex><span>	running 911100-1: ‚úî passed in 851.460335ms <span style=color:#f92672>(</span>RTT 292.802335ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-2: ‚úî passed in 53.748811ms <span style=color:#f92672>(</span>RTT 66.798867ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-3: ‚úî passed in 49.237535ms <span style=color:#f92672>(</span>RTT 67.964411ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-4: ‚úî passed in 194.935023ms <span style=color:#f92672>(</span>RTT 202.414171ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-5: ‚úî passed in 52.905305ms <span style=color:#f92672>(</span>RTT 66.254034ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-6: ‚úî passed in 52.597784ms <span style=color:#f92672>(</span>RTT 68.58854ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-7: ‚úî passed in 51.996881ms <span style=color:#f92672>(</span>RTT 67.496534ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 911100-8: ‚úî passed in 50.804143ms <span style=color:#f92672>(</span>RTT 67.589557ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>üëâ executing tests in file 913100.yaml
</span></span><span style=display:flex><span>	running 913100-1: ‚úî passed in 276.383507ms <span style=color:#f92672>(</span>RTT 85.436758ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>	running 913100-2: ‚úî passed in 86.682684ms <span style=color:#f92672>(</span>RTT 69.89541ms<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  ...
</span></span></code></pre></div><p>If you want to run only one test, or a group of tests, you can specify that using the &ldquo;include&rdquo; option <code>-i</code> (or <code>--include</code>). This option takes a regular expression:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./go-ftw run --config .ftw.apache.yaml -d ../coreruleset/tests/regression/tests/ -i <span style=color:#e6db74>&#34;955100-1</span>$<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>In the above case only the test case <code>955100-1</code> will be run.</p><p>If you need to see more verbose output (e.g., to look at the requests and responses sent and received by <strong>go-ftw</strong>) you can use the <code>--debug</code> or <code>--trace</code> options:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./go-ftw run --config .ftw.apache.yaml -d ../coreruleset/tests/regression/tests/ -i <span style=color:#e6db74>&#34;955100-1</span>$<span style=color:#e6db74>&#34;</span> --trace
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./go-ftw run --config .ftw.apache.yaml -d ../coreruleset/tests/regression/tests/ -i <span style=color:#e6db74>&#34;955100-1</span>$<span style=color:#e6db74>&#34;</span> --debug
</span></span></code></pre></div><p>Please note again that <code>libmodsecurity3</code> is <strong>not fully compatible</strong> with ModSecurity 2, some tests can fail. If you want to ignore them, you can put the tests into a list in your config:</p><pre tabindex=0><code>testoverride:
  input:
    dest_addr: &#34;127.0.0.1&#34;
    port: 8080
  ignore:
    # text comes from our friends at https://github.com/digitalwave/ftwrunner
    &#39;941190-3$&#39;: &#39;known MSC bug - PR #2023 (Cookie without value)&#39;
    &#39;941330-1$&#39;: &#39;know MSC bug - #2148 (double escape)&#39;
    ...
</code></pre><p>For more information and examples, please check the <a href=https://github.com/coreruleset/go-ftw#example-usage>go-ftw documentation</a>.</p><p><strong>Also please don&rsquo;t forget to roll back the modifications from this guide to your WAF configuration after you&rsquo;re done testing!</strong></p><h2 id=ftw-deprecated>FTW (deprecated)</h2><p><a href=https://github.com/coreruleset/ftw>ftw</a> is our legacy test runner, and is <strong>deprecated</strong> and no longer used for tests after CRS v3.2. Refer to this <a href=https://github.com/coreruleset/coreruleset/blob/v3.2/dev/.travis.yml#L52>GitHub workflow</a> if you need to use the old <strong>ftw</strong> Python version. You can easily reproduce that locally, on your workstation.</p><p>For that you will need:</p><ul><li>the coreruleset git repository</li><li>docker and docker-compose (modern versions of docker already include compose functionality)</li><li>python3</li><li>your rules and tests!</li></ul><h3 id=setting-up-the-basic-environment>Setting up the basic environment</h3><p>I normally use <a href=https://docs.pipenv.org/>pipenv</a> whenever Python is involved. It will give you both isolation and dependencies at once. But you can use basic pip and virtualenv and the result will be the same.</p><p>For installing the python tooling, just use:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ pipenv install -r tests/regression/requirements.txt
</span></span><span style=display:flex><span>Creating a virtualenv <span style=color:#66d9ef>for</span> this project...
</span></span><span style=display:flex><span>Pipfile: /private/tmp/coreruleset/Pipfile
</span></span><span style=display:flex><span>Using /usr/local/bin/python3 <span style=color:#f92672>(</span>3.9.5<span style=color:#f92672>)</span> to create virtualenv...
</span></span><span style=display:flex><span>‚†ß Creating virtual environment...created virtual environment CPython3.9.5.final.0-64 in 392ms
</span></span><span style=display:flex><span>  creator CPython3Posix<span style=color:#f92672>(</span>dest<span style=color:#f92672>=</span>/Users/fzipitria/.local/share/virtualenvs/coreruleset-UNJnkEXP, clear<span style=color:#f92672>=</span>False, global<span style=color:#f92672>=</span>False<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  seeder FromAppData<span style=color:#f92672>(</span>download<span style=color:#f92672>=</span>False, pip<span style=color:#f92672>=</span>bundle, setuptools<span style=color:#f92672>=</span>bundle, wheel<span style=color:#f92672>=</span>bundle, via<span style=color:#f92672>=</span>copy, app_data_dir<span style=color:#f92672>=</span>/Users/fzipitria/Library/Application Support/virtualenv<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    added seed packages: pip<span style=color:#f92672>==</span>21.0.1, setuptools<span style=color:#f92672>==</span>56.0.0, wheel<span style=color:#f92672>==</span>0.36.2
</span></span><span style=display:flex><span>  activators BashActivator,CShellActivator,FishActivator,PowerShellActivator,PythonActivator,XonshActivator
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>‚úî Successfully created virtual environment!
</span></span><span style=display:flex><span>Virtualenv location: /Users/fzipitria/.local/share/virtualenvs/coreruleset-UNJnkEXP
</span></span><span style=display:flex><span>Creating a Pipfile <span style=color:#66d9ef>for</span> this project...
</span></span><span style=display:flex><span>Requirements file provided! Importing into Pipfile...
</span></span><span style=display:flex><span>Pipfile.lock not found, creating...
</span></span><span style=display:flex><span>Locking <span style=color:#f92672>[</span>dev-packages<span style=color:#f92672>]</span> dependencies...
</span></span><span style=display:flex><span>Locking <span style=color:#f92672>[</span>packages<span style=color:#f92672>]</span> dependencies...
</span></span><span style=display:flex><span>Building requirements...
</span></span><span style=display:flex><span>Resolving dependencies...
</span></span><span style=display:flex><span>‚úî Success!
</span></span><span style=display:flex><span>Updated Pipfile.lock <span style=color:#f92672>(</span>02e6ae<span style=color:#f92672>)</span>!
</span></span><span style=display:flex><span>Installing dependencies from Pipfile.lock <span style=color:#f92672>(</span>02e6ae<span style=color:#f92672>)</span>...
</span></span><span style=display:flex><span>  üêç   ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ‚ñâ 17/17 ‚Äî 00:00:28
</span></span><span style=display:flex><span>To activate this project<span style=color:#960050;background-color:#1e0010>&#39;</span>s virtualenv, run pipenv shell.
</span></span><span style=display:flex><span>Alternatively, run a command inside the virtualenv with pipenv run.
</span></span></code></pre></div><p>Now we are ready to start running tests.</p><h3 id=running-the-test-suite-1>Running the test suite</h3><p>The test suite will be run by the tool <code>ftw</code>, now that we started our containers.</p><p>If you used the <code>pipenv</code> tool for installing the module, now is time to enter the shell:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ py.test -vs --tb<span style=color:#f92672>=</span>short tests/regression/CRS_Tests.py --config<span style=color:#f92672>=</span>modsec2-apache --ruledir_recurse<span style=color:#f92672>=</span>./tests/regression/tests
</span></span><span style=display:flex><span><span style=color:#f92672>==============================================================================</span> test session starts <span style=color:#f92672>===============================================================================</span>
</span></span><span style=display:flex><span>platform darwin -- Python 3.9.5, pytest-4.6.0, py-1.10.0, pluggy-0.13.1 -- /Users/fzipitria/.local/share/virtualenvs/coreruleset-bLfwOI0B/bin/python
</span></span><span style=display:flex><span>cachedir: .pytest_cache
</span></span><span style=display:flex><span>rootdir: /Users/fzipitria/Workspace/OWASP/coreruleset
</span></span><span style=display:flex><span>plugins: ftw-1.2.4
</span></span><span style=display:flex><span>collected <span style=color:#ae81ff>2468</span> items
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset0-933210.yaml -- 933210-1<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset1-933210.yaml -- 933210-2<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset2-933210.yaml -- 933210-3<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset3-933210.yaml -- 933210-4<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset4-933210.yaml -- 933210-5<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset5-933210.yaml -- 933210-6<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset6-933210.yaml -- 933210-7<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset7-933210.yaml -- 933210-8<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset8-933210.yaml -- 933210-9<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset9-933210.yaml -- 933210-10<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset10-933210.yaml -- 933210-11<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset11-933210.yaml -- 933210-12<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset12-933210.yaml -- 933210-13<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>Couple notes here:</p><ul><li>using <code>--ruledir_recurse=./tests/regression/tests</code> will walk over all the tests defined below that directory</li><li>you can test your specific file using <code>--rule=./mytest.yaml</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>‚ùØ py.test -vs --tb<span style=color:#f92672>=</span>short tests/regression/CRS_Tests.py --config<span style=color:#f92672>=</span>modsec2-apache --rule<span style=color:#f92672>=</span>./mytest.yaml
</span></span><span style=display:flex><span><span style=color:#f92672>==============================================================================</span> test session starts <span style=color:#f92672>===============================================================================</span>
</span></span><span style=display:flex><span>platform darwin -- Python 3.9.5, pytest-4.6.0, py-1.10.0, pluggy-0.13.1 -- /Users/fzipitria/.local/share/virtualenvs/coreruleset-bLfwOI0B/bin/python
</span></span><span style=display:flex><span>cachedir: .pytest_cache
</span></span><span style=display:flex><span>rootdir: /Users/fzipitria/Workspace/OWASP/coreruleset
</span></span><span style=display:flex><span>plugins: ftw-1.2.4
</span></span><span style=display:flex><span>collected <span style=color:#ae81ff>1</span> item
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>tests/regression/CRS_Tests.py::test_crs<span style=color:#f92672>[</span>ruleset0-mytest.yaml -- mytest-1<span style=color:#f92672>]</span> PASSED
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>================================================================================</span> warnings summary <span style=color:#f92672>================================================================================</span>
</span></span><span style=display:flex><span>/Users/fzipitria/.local/share/virtualenvs/coreruleset-bLfwOI0B/lib/python3.9/site-packages/yaml/constructor.py:126
</span></span><span style=display:flex><span>  /Users/fzipitria/.local/share/virtualenvs/coreruleset-bLfwOI0B/lib/python3.9/site-packages/yaml/constructor.py:126: DeprecationWarning: Using or importing the ABCs from <span style=color:#e6db74>&#39;collections&#39;</span> instead of from <span style=color:#e6db74>&#39;collections.abc&#39;</span> is deprecated since Python 3.3, and in 3.10 it will stop working
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> not isinstance<span style=color:#f92672>(</span>key, collections.Hashable<span style=color:#f92672>)</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-- Docs: https://docs.pytest.org/en/latest/warnings.html
</span></span><span style=display:flex><span><span style=color:#f92672>======================================================================</span> <span style=color:#ae81ff>1</span> passed, <span style=color:#ae81ff>1</span> warnings in 0.36 seconds <span style=color:#f92672>======================================================================</span>
</span></span></code></pre></div><p>That&rsquo;s it!</p><h2 id=additional-tips>Additional tips</h2><p>‚ö†Ô∏è If your test is not matching, you can take a peek at the <code>modsec_audit.log</code> file, using: <code>sudo tail -200 tests/logs/modsec2-apache/modsec_audit.log</code></p><p>üîß If you need to write a test that cannot be written using text (e.g. binary content), we prefer using <code>encoded_request</code> in the test, using base64 encoding</p><h2 id=summary>Summary</h2><p>Tests are a core functionality in our ruleset. So whenever you write a rule, try to add some positive and negative tests so we won&rsquo;t have surprises in the future.</p><p>Happy testing! üéâ</p><footer class=footline></footer></main></div><div id=navigation><a class="nav nav-prev" href=/documentation/development/useful_tools/ title="Useful Tools"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/documentation/development/plugin_writing/ title="Writing Plugins"><i class="fa fa-chevron-right"></i></a></div></div><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/documentation/js/clipboard.min.js?1703090007></script>
<script src=/documentation/js/perfect-scrollbar.min.js?1703090007></script>
<script src=/documentation/js/perfect-scrollbar.jquery.min.js?1703090007></script>
<script src=/documentation/js/jquery.svg.pan.zoom.js?1703090007></script>
<script src=/documentation/js/featherlight.min.js?1703090007></script>
<script src=/documentation/js/modernizr.custom-3.6.0.js?1703090007></script>
<script src=/documentation/js/mermaid.min.js?1703090007></script>
<script>typeof mermaid!="undefined"&&mermaid.mermaidAPI.initialize(Object.assign({securityLevel:"antiscript"},JSON.parse('{ "startOnLoad": true }'),{startOnLoad:!1}))</script><script src=/documentation/js/relearn.js?1703090007></script>
<script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="https://piwik.netnea.com/matomo/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","4"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><img referrerpolicy=no-referrer-when-downgrade src="https://piwik.netnea.com/matomo/matomo.php?idsite=4&rec=1" style=border:0 alt></body></html>